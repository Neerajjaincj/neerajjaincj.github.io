"use strict";(self.webpackChunkcellular_empire=self.webpackChunkcellular_empire||[]).push([[682],{8682:(Cu,$n,ge)=>{ge.r($n),ge.d($n,{HomeModule:()=>yu});var j=ge(6814),Ne=ge(95),o=ge(9468);let Is=(()=>{var n;class t{}return(n=t).\u0275fac=function(i){return new(i||n)},n.\u0275mod=o.oAB({type:n}),n.\u0275inj=o.cJS({imports:[j.ez,Ne.u5,Ne.UX]}),t})();var Ye=ge(7182);let Jn=(()=>{var n;class t{constructor(){this.players={player1:{name:"User"},player2:{name:"Computer"}},this.gameConfig={mode:1,duration:5,difficulty:1}}resetPlayers(){this.players={player1:{name:""},player2:{name:""}}}resetGameConfig(){this.gameConfig={mode:1,duration:1,difficulty:1}}}return(n=t).\u0275fac=function(i){return new(i||n)},n.\u0275prov=o.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),t})();function ws(n,t){if(1&n&&o._UZ(0,"div",12),2&n){const e=t.index,i=o.oxw().index,r=o.oxw();o.Gre("cell cell-",r.gameGrid[i][e],""),o.hYB("id","game_",i,"_",e,"")}}function bs(n,t){if(1&n&&(o.TgZ(0,"div")(1,"div",10),o.YNc(2,ws,1,5,"div",11),o.qZA()()),2&n){const e=t.$implicit;o.xp6(2),o.Q6J("ngForOf",e)}}function Ss(n,t){if(1&n){const e=o.EpF();o.TgZ(0,"div",13)(1,"div",14),o.NdJ("click",function(){o.CHM(e);const r=o.oxw();return o.KtG(r.setMenu(2))}),o._uU(2,"Quick Game"),o.qZA(),o.TgZ(3,"div",14),o.NdJ("click",function(){o.CHM(e);const r=o.oxw();return o.KtG(r.setMenu(3))}),o._uU(4,"Multi Player Game"),o.qZA(),o.TgZ(5,"div",14),o.NdJ("click",function(){o.CHM(e);const r=o.oxw();return o.KtG(r.setMenu(4))}),o._uU(6,"About"),o.qZA(),o.TgZ(7,"div",14),o.NdJ("click",function(){o.CHM(e);const r=o.oxw();return o.KtG(r.navToPage())}),o._uU(8,"Leader Board"),o.qZA()()}}function xs(n,t){if(1&n){const e=o.EpF();o.TgZ(0,"div",15)(1,"div",16),o._uU(2,"- Quick Game -"),o.qZA(),o.TgZ(3,"div",17),o._uU(4,"Player Name: "),o.TgZ(5,"input",18),o.NdJ("ngModelChange",function(r){o.CHM(e);const s=o.oxw();return o.KtG(s.player1Name=r)}),o.qZA()(),o.TgZ(6,"div",19),o._uU(7),o.qZA(),o.TgZ(8,"div",20),o._uU(9,"Generations: "),o.TgZ(10,"span",21),o.NdJ("click",function(){o.CHM(e);const r=o.oxw();return o.KtG(r.duration=5)}),o._uU(11,"500"),o.qZA(),o.TgZ(12,"span",21),o.NdJ("click",function(){o.CHM(e);const r=o.oxw();return o.KtG(r.duration=10)}),o._uU(13,"1,000"),o.qZA(),o.TgZ(14,"span",21),o.NdJ("click",function(){o.CHM(e);const r=o.oxw();return o.KtG(r.duration=20)}),o._uU(15,"2,000"),o.qZA()(),o.TgZ(16,"div",22)(17,"div",14),o.NdJ("click",function(){o.CHM(e);const r=o.oxw();return r.difficulty=1,o.KtG(r.navToGame(1))}),o._uU(18,"Easy"),o.qZA(),o.TgZ(19,"div",14),o.NdJ("click",function(){o.CHM(e);const r=o.oxw();return r.difficulty=2,o.KtG(r.navToGame(1))}),o._uU(20,"Medium"),o.qZA(),o.TgZ(21,"div",14),o.NdJ("click",function(){o.CHM(e);const r=o.oxw();return r.difficulty=3,o.KtG(r.navToGame(1))}),o._uU(22,"Hard"),o.qZA()(),o.TgZ(23,"div",23),o.NdJ("click",function(){o.CHM(e);const r=o.oxw();return o.KtG(r.menu=1)}),o._uU(24,"Back"),o.qZA()()}if(2&n){const e=o.oxw();o.xp6(5),o.Q6J("ngModel",e.player1Name),o.xp6(2),o.Oqu(e.errorMessage),o.xp6(3),o.Gre("menu-button-small-",5==e.duration," p-3"),o.xp6(2),o.Gre("menu-button-small-",10==e.duration," p-3"),o.xp6(2),o.Gre("menu-button-small-",20==e.duration," p-3")}}function As(n,t){if(1&n){const e=o.EpF();o.TgZ(0,"div",24)(1,"div",16),o._uU(2,"- Multi Player -"),o.qZA(),o.TgZ(3,"div",17),o._uU(4,"Player 1: "),o.TgZ(5,"input",25),o.NdJ("ngModelChange",function(r){o.CHM(e);const s=o.oxw();return o.KtG(s.player1Name=r)}),o.qZA()(),o.TgZ(6,"div",26),o._uU(7,"Player 2: "),o.TgZ(8,"input",27),o.NdJ("ngModelChange",function(r){o.CHM(e);const s=o.oxw();return o.KtG(s.player2Name=r)}),o.qZA()(),o.TgZ(9,"div",17),o._uU(10,"Generations: "),o.TgZ(11,"span",21),o.NdJ("click",function(){o.CHM(e);const r=o.oxw();return o.KtG(r.duration=5)}),o._uU(12,"500"),o.qZA(),o.TgZ(13,"span",21),o.NdJ("click",function(){o.CHM(e);const r=o.oxw();return o.KtG(r.duration=10)}),o._uU(14,"1000"),o.qZA(),o.TgZ(15,"span",21),o.NdJ("click",function(){o.CHM(e);const r=o.oxw();return o.KtG(r.duration=20)}),o._uU(16,"2000"),o.qZA()(),o.TgZ(17,"div",28),o._uU(18),o.qZA(),o.TgZ(19,"div",29),o.NdJ("click",function(){o.CHM(e);const r=o.oxw();return o.KtG(r.navToGame(2))}),o._uU(20,"Start"),o.qZA(),o.TgZ(21,"div",14),o.NdJ("click",function(){o.CHM(e);const r=o.oxw();return o.KtG(r.menu=1)}),o._uU(22,"Back"),o.qZA()()}if(2&n){const e=o.oxw();o.xp6(5),o.Q6J("ngModel",e.player1Name),o.xp6(3),o.Q6J("ngModel",e.player2Name),o.xp6(3),o.Gre("menu-button-small-",5==e.duration," p-3"),o.xp6(2),o.Gre("menu-button-small-",10==e.duration," p-3"),o.xp6(2),o.Gre("menu-button-small-",20==e.duration," p-3"),o.xp6(3),o.Oqu(e.errorMessage)}}function Os(n,t){if(1&n){const e=o.EpF();o.TgZ(0,"div",24)(1,"div",30),o._uU(2,"MSc.Project (COMP702) "),o.qZA(),o.TgZ(3,"div",20),o._uU(4,"Submitted By"),o.qZA(),o.TgZ(5,"div",31),o._uU(6,"Neeraj Jain Cherukunnu Jinachandran"),o.qZA(),o.TgZ(7,"div",31),o._uU(8,"201666803"),o.qZA(),o.TgZ(9,"div",32),o._uU(10,"Primary Supervisor"),o.qZA(),o.TgZ(11,"div",31),o._uU(12,"Louwe Kuijer"),o.qZA(),o.TgZ(13,"div",32),o._uU(14,"Secondary Supervisor"),o.qZA(),o.TgZ(15,"div",31),o._uU(16,"Qiyi Tang"),o.qZA(),o.TgZ(17,"div",14),o.NdJ("click",function(){o.CHM(e);const r=o.oxw();return o.KtG(r.menu=1)}),o._uU(18,"Back"),o.qZA()()}}let Xn=(()=>{var n;class t{constructor(i,r){this.router=i,this.gameService=r,this.rows=30,this.cols=60,this.menu=1,this.player1Name="",this.player2Name="",this.duration=5,this.difficulty=1,this.buildMaterial=[[[0,-1],[0,0],[0,1]],[[-1,0],[-1,1],[0,-1],[0,1],[1,1]],[[-1,1],[0,-1],[0,1],[1,0],[1,1]],[[0,0],[0,1],[1,0],[1,1]],[[-1,0],[0,-1],[0,1],[1,0]],[[-1,-2],[-1,1],[0,2],[1,-2],[1,2],[2,-1],[2,0],[2,1],[2,2]],[[-6,-4],[-6,-3],[-6,-2],[-6,2],[-6,3],[-6,4],[-4,-6],[-3,-6],[-2,-6],[-4,-1],[-3,-1],[-2,-1],[-4,1],[-3,1],[-2,1],[-4,6],[-3,6],[-2,6],[-1,-4],[-1,-3],[-1,-2],[-1,2],[-1,3],[-1,4],[1,-4],[1,-3],[1,-2],[1,2],[1,3],[1,4],[2,-6],[3,-6],[4,-6],[2,-1],[3,-1],[4,-1],[2,1],[3,1],[4,1],[2,6],[3,6],[4,6],[6,-4],[6,-3],[6,-2],[6,2],[6,3],[6,4]],[[0,0]]],this.errorMessage=""}ngOnInit(){this.gameGrid=this.createEmptyGrid(this.rows,this.cols),this.addRandomCells(),this.addRandomCells(),this.addRandomCells(),this.addRandomCells(),this.playGame()}createEmptyGrid(i,r){let s=new Array(i);for(let a=0;a<i;a++)s[a]=new Array(r).fill(0);return s}playGame(){clearInterval(this.intervalId),this.intervalId=setInterval(()=>{this.runNextGeneration()},800)}runNextGeneration(){Math.floor(12*Math.random())%4==0&&this.addRandomCells(),this.gameGrid=this.calculateNextGeneration(this.gameGrid)}calculateNextGeneration(i){const r=this.createEmptyGrid(this.rows,this.cols);for(let s=0;s<this.rows;s++)for(let a=0;a<this.cols;a++){const l=i[s][a],c=this.countNeighbors(i,s,a);r[s][a]=0===l&&3===c?1:1===l&&(c<2||c>3)?0:l}return r}countNeighbors(i,r,s){let a=0;const l=[[-1,-1],[-1,0],[-1,1],[0,-1],[0,1],[1,-1],[1,0],[1,1]];for(let c=0;c<l.length;c++){const[d,h]=l[c];a+=i[(r+d+this.rows)%this.rows][(s+h+this.cols)%this.cols]}return a}addRandomCells(){var i=Math.floor(Math.random()*(this.rows-16))+8,r=Math.floor(Math.random()*(this.cols-16))+8,s=Math.floor(8*Math.random()),l=1;r>this.cols/2&&(l=-1),this.buildMaterial[s].forEach(c=>{var d=i+c[0],h=r+c[1]*l;this.gameGrid[d][h]=0===this.gameGrid[d][h]?1:0})}setMenu(i){this.menu=i,this.errorMessage=""}navToGame(i){1==i?(this.gameService.players.player1.name=this.player1Name||"User",this.gameService.players.player2.name="Computer",this.gameService.gameConfig.duration=this.duration,this.gameService.gameConfig.difficulty=this.difficulty,this.gameService.gameConfig.mode=1,this.router.navigateByUrl("game")):""==this.player1Name?this.errorMessage="Enter player 1 name !":""==this.player2Name?this.errorMessage="Enter player 2 name !":this.player1Name==this.player2Name?this.errorMessage="Use different names":(this.errorMessage="",this.gameService.players.player1.name=this.player1Name,this.gameService.players.player2.name=this.player2Name,this.gameService.gameConfig.duration=this.duration,this.gameService.gameConfig.mode=2,this.router.navigateByUrl("game"))}navToPage(){this.router.navigateByUrl("leader-board")}}return(n=t).\u0275fac=function(i){return new(i||n)(o.Y36(Ye.F0),o.Y36(Jn))},n.\u0275cmp=o.Xpm({type:n,selectors:[["app-home"]],decls:15,vars:5,consts:[[1,"main-container","d-flex","flex-column","align-items-center","text-center"],["id","game",1,"game","p-4"],[4,"ngFor","ngForOf"],[1,"home","position-absolute"],[1,"title","my-5","text-uppercase"],[2,"color","#E1113B"],[1,"menu","d-flex","flex-column","align-items-center","text-center","mt-5"],["id","menu-1",4,"ngIf"],["id","menu-2",4,"ngIf"],["id","menu-3",4,"ngIf"],[1,"cell-container"],[3,"class","id",4,"ngFor","ngForOf"],[3,"id"],["id","menu-1"],[1,"menu-button",3,"click"],["id","menu-2"],[1,"menu-title"],[1,"menu-sub-title","pt-3"],["maxlength","10","placeholder","User",1,"menu-input",3,"ngModel","ngModelChange"],[1,"text-danger","menu-sub-title","pt2-3"],[1,"menu-sub-title","pt-4"],[3,"click"],[1,"d-flex","pt-4"],[1,"menu-button","mt-3",3,"click"],["id","menu-3"],["maxlength","10","placeholder","P1",1,"menu-input",3,"ngModel","ngModelChange"],[1,"menu-sub-title"],["maxlength","10","placeholder","P2",1,"menu-input",3,"ngModel","ngModelChange"],[1,"text-danger","menu-sub-title","pt-3"],[1,"menu-button","mt-4",3,"click"],[1,"pb-3"],[1,"menu-sub-title","text-light"],[1,"menu-sub-title","pt-5"]],template:function(i,r){1&i&&(o.TgZ(0,"div",0)(1,"div",1),o.YNc(2,bs,3,1,"div",2),o.qZA(),o.TgZ(3,"div",3)(4,"div")(5,"div",4)(6,"span",5),o._uU(7,"Cellular"),o.qZA(),o._uU(8,"Empire"),o.qZA()(),o.TgZ(9,"div",6),o.YNc(10,Ss,9,0,"div",7),o.YNc(11,xs,25,11,"div",8),o.YNc(12,As,23,12,"div",9),o.YNc(13,Os,19,0,"div",9),o._UZ(14,"div"),o.qZA()()()),2&i&&(o.xp6(2),o.Q6J("ngForOf",r.gameGrid),o.xp6(8),o.Q6J("ngIf",1==r.menu),o.xp6(1),o.Q6J("ngIf",2==r.menu),o.xp6(1),o.Q6J("ngIf",3==r.menu),o.xp6(1),o.Q6J("ngIf",4==r.menu))},dependencies:[j.sg,j.O5,Ne.Fj,Ne.JJ,Ne.nD,Ne.On],styles:[".main-container[_ngcontent-%COMP%]{color:#fff;overflow-x:hidden}.title[_ngcontent-%COMP%]{padding-top:25%;font-size:3rem}.game-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:center}.game[_ngcontent-%COMP%]{height:648px;width:1248px;z-index:-1}.cell-container[_ngcontent-%COMP%]{display:flex}.cell[_ngcontent-%COMP%]{width:18px;height:18px;border-radius:5px;margin:1px;transition:background-color 1s ease-in-out}.cell-1[_ngcontent-%COMP%]{background-color:#121b29}@keyframes _ngcontent-%COMP%_new-cell{}.menu[_ngcontent-%COMP%]{font-size:1.5rem}.menu-title[_ngcontent-%COMP%]{color:#8c99b6;font-size:2rem}.menu-sub-title[_ngcontent-%COMP%]{color:#525c6e;font-size:1rem}.menu-button[_ngcontent-%COMP%]{margin:20px;padding:10px 20px;transition:all .3s ease-in-out;border:1px solid white;border-radius:10px}.menu-button[_ngcontent-%COMP%]:hover{scale:1.1;cursor:pointer!important}.menu-button-small-true[_ngcontent-%COMP%]{color:#fff}.menu-button-small-false[_ngcontent-%COMP%]:hover{scale:1.1;cursor:pointer!important}.menu-button-small-false[_ngcontent-%COMP%]{color:#525c6e}.menu-input[_ngcontent-%COMP%]{margin:15px;background:transparent;border:0px;border-bottom:1px solid white;color:#fff}"]}),t})();const Ns=[[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,1,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]],Rs=[[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,0,0,0,1,1,1,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,1,0,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,1,0,1,0,0,0,0,1,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,1,0,1,0,0,0,0,1,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,1,0,1,0,0,0,0,1,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,0,0,0,1,1,1,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,0,0,0,1,1,1,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,1,0,1,0,0,0,0,1,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,1,0,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,1,0,1,0,0,0,0,1,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,1,0,1,0,0,0,0,1,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,0,0,0,1,1,1,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]],Ls=[[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,0,0,0,1,1,1,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,1,0,1,0,0,0,0,1,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,1,0,0,0,0,0,0,0,0,0,1,0,0,0,0,1,0,1,0,0,0,0,1,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,1,0,1,0,0,0,0,1,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,0,0,0,1,1,1,0,0,0,0,0,1,1,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,0,0,0,1,1,1,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,1,0,1,0,0,0,0,1,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,1,0,1,0,0,0,0,1,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,1,0,1,0,0,0,0,1,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,0,0,0,1,1,1,0,0,0,0,0,1,1,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,0,0,0,1,1,1,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,1,0,1,0,0,0,0,1,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,1,0,1,0,0,0,0,1,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,1,0,1,0,0,0,0,1,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,0,0,0,1,1,1,0,0,0,0,0,1,1,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,0,0,0,1,1,1,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,1,0,1,0,0,0,0,1,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,1,0,1,0,0,0,0,1,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,1,0,1,0,0,0,0,1,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,0,0,0,1,1,1,0,0,0,0,0,1,1,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]];function ei(n,t,e,i,r,s,a){try{var l=n[s](a),c=l.value}catch(d){return void e(d)}l.done?t(c):Promise.resolve(c).then(i,r)}function q(n){return function(){var t=this,e=arguments;return new Promise(function(i,r){var s=n.apply(t,e);function a(c){ei(s,i,r,a,l,"next",c)}function l(c){ei(s,i,r,a,l,"throw",c)}a(void 0)})}}const _=function(n,t){if(!n)throw Re(t)},Re=function(n){return new Error("Firebase Database (${JSCORE_VERSION}) INTERNAL ASSERT FAILED: "+n)},ti=function(n){const t=[];let e=0;for(let i=0;i<n.length;i++){let r=n.charCodeAt(i);r<128?t[e++]=r:r<2048?(t[e++]=r>>6|192,t[e++]=63&r|128):55296==(64512&r)&&i+1<n.length&&56320==(64512&n.charCodeAt(i+1))?(r=65536+((1023&r)<<10)+(1023&n.charCodeAt(++i)),t[e++]=r>>18|240,t[e++]=r>>12&63|128,t[e++]=r>>6&63|128,t[e++]=63&r|128):(t[e++]=r>>12|224,t[e++]=r>>6&63|128,t[e++]=63&r|128)}return t},Pt={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"==typeof atob,encodeByteArray(n,t){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();const e=t?this.byteToCharMapWebSafe_:this.byteToCharMap_,i=[];for(let r=0;r<n.length;r+=3){const s=n[r],a=r+1<n.length,l=a?n[r+1]:0,c=r+2<n.length,d=c?n[r+2]:0;let f=(15&l)<<2|d>>6,p=63&d;c||(p=64,a||(f=64)),i.push(e[s>>2],e[(3&s)<<4|l>>4],e[f],e[p])}return i.join("")},encodeString(n,t){return this.HAS_NATIVE_SUPPORT&&!t?btoa(n):this.encodeByteArray(ti(n),t)},decodeString(n,t){return this.HAS_NATIVE_SUPPORT&&!t?atob(n):function(n){const t=[];let e=0,i=0;for(;e<n.length;){const r=n[e++];if(r<128)t[i++]=String.fromCharCode(r);else if(r>191&&r<224){const s=n[e++];t[i++]=String.fromCharCode((31&r)<<6|63&s)}else if(r>239&&r<365){const c=((7&r)<<18|(63&n[e++])<<12|(63&n[e++])<<6|63&n[e++])-65536;t[i++]=String.fromCharCode(55296+(c>>10)),t[i++]=String.fromCharCode(56320+(1023&c))}else{const s=n[e++],a=n[e++];t[i++]=String.fromCharCode((15&r)<<12|(63&s)<<6|63&a)}}return t.join("")}(this.decodeStringToByteArray(n,t))},decodeStringToByteArray(n,t){this.init_();const e=t?this.charToByteMapWebSafe_:this.charToByteMap_,i=[];for(let r=0;r<n.length;){const s=e[n.charAt(r++)],l=r<n.length?e[n.charAt(r)]:0;++r;const d=r<n.length?e[n.charAt(r)]:64;++r;const u=r<n.length?e[n.charAt(r)]:64;if(++r,null==s||null==l||null==d||null==u)throw new Ds;i.push(s<<2|l>>4),64!==d&&(i.push(l<<4&240|d>>2),64!==u&&i.push(d<<6&192|u))}return i},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}};class Ds extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const ni=function(n){const t=ti(n);return Pt.encodeByteArray(t,!0)},A0=function(n){return ni(n).replace(/\./g,"")},Et=function(n){try{return Pt.decodeString(n,!0)}catch(t){console.error("base64Decode failed: ",t)}return null};function ks(n){return ii(void 0,n)}function ii(n,t){if(!(t instanceof Object))return t;switch(t.constructor){case Date:return new Date(t.getTime());case Object:void 0===n&&(n={});break;case Array:n=[];break;default:return t}for(const e in t)!t.hasOwnProperty(e)||!Fs(e)||(n[e]=ii(n[e],t[e]));return n}function Fs(n){return"__proto__"!==n}const O0=()=>{try{return function Bs(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}().__FIREBASE_DEFAULTS__||(()=>{if(typeof process>"u"||typeof process.env>"u")return;const n=process.env.__FIREBASE_DEFAULTS__;return n?JSON.parse(n):void 0})()||(()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const t=n&&Et(n[1]);return t&&JSON.parse(t)})()}catch(n){return void console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`)}},ri=()=>{var n;return null===(n=O0())||void 0===n?void 0:n.config};class Qe{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((t,e)=>{this.resolve=t,this.reject=e})}wrapCallback(t){return(e,i)=>{e?this.reject(e):this.resolve(i),"function"==typeof t&&(this.promise.catch(()=>{}),1===t.length?t(e):t(e,i))}}}function si(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(function N0(){return typeof navigator<"u"&&"string"==typeof navigator.userAgent?navigator.userAgent:""}())}class $e extends Error{constructor(t,e,i){super(e),this.code=t,this.customData=i,this.name="FirebaseError",Object.setPrototypeOf(this,$e.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,oi.prototype.create)}}class oi{constructor(t,e,i){this.service=t,this.serviceName=e,this.errors=i}create(t,...e){const i=e[0]||{},r=`${this.service}/${t}`,s=this.errors[t],a=s?function Qs(n,t){return n.replace($s,(e,i)=>{const r=t[i];return null!=r?String(r):`<${i}?>`})}(s,i):"Error";return new $e(r,`${this.serviceName}: ${a} (${r}).`,i)}}const $s=/\{\$([^}]+)}/g;function Je(n){return JSON.parse(n)}function L(n){return JSON.stringify(n)}const R0=function(n){let t={},e={},i={},r="";try{const s=n.split(".");t=Je(Et(s[0])||""),e=Je(Et(s[1])||""),r=s[2],i=e.d||{},delete e.d}catch{}return{header:t,claims:e,data:i,signature:r}};function te(n,t){return Object.prototype.hasOwnProperty.call(n,t)}function Le(n,t){if(Object.prototype.hasOwnProperty.call(n,t))return n[t]}function ai(n){for(const t in n)if(Object.prototype.hasOwnProperty.call(n,t))return!1;return!0}function L0(n,t,e){const i={};for(const r in n)Object.prototype.hasOwnProperty.call(n,r)&&(i[r]=t.call(e,n[r],r,n));return i}function Tt(n,t){if(n===t)return!0;const e=Object.keys(n),i=Object.keys(t);for(const r of e){if(!i.includes(r))return!1;const s=n[r],a=t[r];if(li(s)&&li(a)){if(!Tt(s,a))return!1}else if(s!==a)return!1}for(const r of i)if(!e.includes(r))return!1;return!0}function li(n){return null!==n&&"object"==typeof n}class to{constructor(){this.chain_=[],this.buf_=[],this.W_=[],this.pad_=[],this.inbuf_=0,this.total_=0,this.blockSize=64,this.pad_[0]=128;for(let t=1;t<this.blockSize;++t)this.pad_[t]=0;this.reset()}reset(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0}compress_(t,e){e||(e=0);const i=this.W_;if("string"==typeof t)for(let u=0;u<16;u++)i[u]=t.charCodeAt(e)<<24|t.charCodeAt(e+1)<<16|t.charCodeAt(e+2)<<8|t.charCodeAt(e+3),e+=4;else for(let u=0;u<16;u++)i[u]=t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3],e+=4;for(let u=16;u<80;u++){const f=i[u-3]^i[u-8]^i[u-14]^i[u-16];i[u]=4294967295&(f<<1|f>>>31)}let d,h,r=this.chain_[0],s=this.chain_[1],a=this.chain_[2],l=this.chain_[3],c=this.chain_[4];for(let u=0;u<80;u++){u<40?u<20?(d=l^s&(a^l),h=1518500249):(d=s^a^l,h=1859775393):u<60?(d=s&a|l&(s|a),h=2400959708):(d=s^a^l,h=3395469782);const f=(r<<5|r>>>27)+d+c+h+i[u]&4294967295;c=l,l=a,a=4294967295&(s<<30|s>>>2),s=r,r=f}this.chain_[0]=this.chain_[0]+r&4294967295,this.chain_[1]=this.chain_[1]+s&4294967295,this.chain_[2]=this.chain_[2]+a&4294967295,this.chain_[3]=this.chain_[3]+l&4294967295,this.chain_[4]=this.chain_[4]+c&4294967295}update(t,e){if(null==t)return;void 0===e&&(e=t.length);const i=e-this.blockSize;let r=0;const s=this.buf_;let a=this.inbuf_;for(;r<e;){if(0===a)for(;r<=i;)this.compress_(t,r),r+=this.blockSize;if("string"==typeof t){for(;r<e;)if(s[a]=t.charCodeAt(r),++a,++r,a===this.blockSize){this.compress_(s),a=0;break}}else for(;r<e;)if(s[a]=t[r],++a,++r,a===this.blockSize){this.compress_(s),a=0;break}}this.inbuf_=a,this.total_+=e}digest(){const t=[];let e=8*this.total_;this.update(this.pad_,this.inbuf_<56?56-this.inbuf_:this.blockSize-(this.inbuf_-56));for(let r=this.blockSize-1;r>=56;r--)this.buf_[r]=255&e,e/=256;this.compress_(this.buf_);let i=0;for(let r=0;r<5;r++)for(let s=24;s>=0;s-=8)t[i]=this.chain_[r]>>s&255,++i;return t}}function Me(n,t){return`${n} failed: ${t} argument `}const M0=function(n){let t=0;for(let e=0;e<n.length;e++){const i=n.charCodeAt(e);i<128?t++:i<2048?t+=2:i>=55296&&i<=56319?(t+=4,e++):t+=3}return t};function De(n){return n&&n._delegate?n._delegate:n}class Xe{constructor(t,e,i){this.name=t,this.instanceFactory=e,this.type=i,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(t){return this.instantiationMode=t,this}setMultipleInstances(t){return this.multipleInstances=t,this}setServiceProps(t){return this.serviceProps=t,this}setInstanceCreatedCallback(t){return this.onInstanceCreated=t,this}}const ye="[DEFAULT]";class uo{constructor(t,e){this.name=t,this.container=e,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(t){const e=this.normalizeInstanceIdentifier(t);if(!this.instancesDeferred.has(e)){const i=new Qe;if(this.instancesDeferred.set(e,i),this.isInitialized(e)||this.shouldAutoInitialize())try{const r=this.getOrInitializeService({instanceIdentifier:e});r&&i.resolve(r)}catch{}}return this.instancesDeferred.get(e).promise}getImmediate(t){var e;const i=this.normalizeInstanceIdentifier(t?.identifier),r=null!==(e=t?.optional)&&void 0!==e&&e;if(!this.isInitialized(i)&&!this.shouldAutoInitialize()){if(r)return null;throw Error(`Service ${this.name} is not available`)}try{return this.getOrInitializeService({instanceIdentifier:i})}catch(s){if(r)return null;throw s}}getComponent(){return this.component}setComponent(t){if(t.name!==this.name)throw Error(`Mismatching Component ${t.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=t,this.shouldAutoInitialize()){if(function fo(n){return"EAGER"===n.instantiationMode}(t))try{this.getOrInitializeService({instanceIdentifier:ye})}catch{}for(const[e,i]of this.instancesDeferred.entries()){const r=this.normalizeInstanceIdentifier(e);try{const s=this.getOrInitializeService({instanceIdentifier:r});i.resolve(s)}catch{}}}}clearInstance(t=ye){this.instancesDeferred.delete(t),this.instancesOptions.delete(t),this.instances.delete(t)}delete(){var t=this;return q(function*(){const e=Array.from(t.instances.values());yield Promise.all([...e.filter(i=>"INTERNAL"in i).map(i=>i.INTERNAL.delete()),...e.filter(i=>"_delete"in i).map(i=>i._delete())])})()}isComponentSet(){return null!=this.component}isInitialized(t=ye){return this.instances.has(t)}getOptions(t=ye){return this.instancesOptions.get(t)||{}}initialize(t={}){const{options:e={}}=t,i=this.normalizeInstanceIdentifier(t.instanceIdentifier);if(this.isInitialized(i))throw Error(`${this.name}(${i}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const r=this.getOrInitializeService({instanceIdentifier:i,options:e});for(const[s,a]of this.instancesDeferred.entries())i===this.normalizeInstanceIdentifier(s)&&a.resolve(r);return r}onInit(t,e){var i;const r=this.normalizeInstanceIdentifier(e),s=null!==(i=this.onInitCallbacks.get(r))&&void 0!==i?i:new Set;s.add(t),this.onInitCallbacks.set(r,s);const a=this.instances.get(r);return a&&t(a,r),()=>{s.delete(t)}}invokeOnInitCallbacks(t,e){const i=this.onInitCallbacks.get(e);if(i)for(const r of i)try{r(t,e)}catch{}}getOrInitializeService({instanceIdentifier:t,options:e={}}){let i=this.instances.get(t);if(!i&&this.component&&(i=this.component.instanceFactory(this.container,{instanceIdentifier:(n=t,n===ye?void 0:n),options:e}),this.instances.set(t,i),this.instancesOptions.set(t,e),this.invokeOnInitCallbacks(i,t),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,t,i)}catch{}var n;return i||null}normalizeInstanceIdentifier(t=ye){return this.component?this.component.multipleInstances?t:ye:t}shouldAutoInitialize(){return!!this.component&&"EXPLICIT"!==this.component.instantiationMode}}class po{constructor(t){this.name=t,this.providers=new Map}addComponent(t){const e=this.getProvider(t.name);if(e.isComponentSet())throw new Error(`Component ${t.name} has already been registered with ${this.name}`);e.setComponent(t)}addOrOverwriteComponent(t){this.getProvider(t.name).isComponentSet()&&this.providers.delete(t.name),this.addComponent(t)}getProvider(t){if(this.providers.has(t))return this.providers.get(t);const e=new uo(t,this);return this.providers.set(t,e),e}getProviders(){return Array.from(this.providers.values())}}const wt=[];var S=function(n){return n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT",n}(S||{});const ci={debug:S.DEBUG,verbose:S.VERBOSE,info:S.INFO,warn:S.WARN,error:S.ERROR,silent:S.SILENT},_o=S.INFO,mo={[S.DEBUG]:"log",[S.VERBOSE]:"log",[S.INFO]:"info",[S.WARN]:"warn",[S.ERROR]:"error"},go=(n,t,...e)=>{if(t<n.logLevel)return;const i=(new Date).toISOString(),r=mo[t];if(!r)throw new Error(`Attempted to log a message with an invalid logType (value: ${t})`);console[r](`[${i}]  ${n.name}:`,...e)};class di{constructor(t){this.name=t,this._logLevel=_o,this._logHandler=go,this._userLogHandler=null,wt.push(this)}get logLevel(){return this._logLevel}set logLevel(t){if(!(t in S))throw new TypeError(`Invalid value "${t}" assigned to \`logLevel\``);this._logLevel=t}setLogLevel(t){this._logLevel="string"==typeof t?ci[t]:t}get logHandler(){return this._logHandler}set logHandler(t){if("function"!=typeof t)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t}get userLogHandler(){return this._userLogHandler}set userLogHandler(t){this._userLogHandler=t}debug(...t){this._userLogHandler&&this._userLogHandler(this,S.DEBUG,...t),this._logHandler(this,S.DEBUG,...t)}log(...t){this._userLogHandler&&this._userLogHandler(this,S.VERBOSE,...t),this._logHandler(this,S.VERBOSE,...t)}info(...t){this._userLogHandler&&this._userLogHandler(this,S.INFO,...t),this._logHandler(this,S.INFO,...t)}warn(...t){this._userLogHandler&&this._userLogHandler(this,S.WARN,...t),this._logHandler(this,S.WARN,...t)}error(...t){this._userLogHandler&&this._userLogHandler(this,S.ERROR,...t),this._logHandler(this,S.ERROR,...t)}}const yo=(n,t)=>t.some(e=>n instanceof e);let ui,hi;const fi=new WeakMap,bt=new WeakMap,pi=new WeakMap,St=new WeakMap,xt=new WeakMap;let At={get(n,t,e){if(n instanceof IDBTransaction){if("done"===t)return bt.get(n);if("objectStoreNames"===t)return n.objectStoreNames||pi.get(n);if("store"===t)return e.objectStoreNames[1]?void 0:e.objectStore(e.objectStoreNames[0])}return se(n[t])},set:(n,t,e)=>(n[t]=e,!0),has:(n,t)=>n instanceof IDBTransaction&&("done"===t||"store"===t)||t in n};function wo(n){return"function"==typeof n?function Io(n){return n!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?function Co(){return hi||(hi=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}().includes(n)?function(...t){return n.apply(Ot(this),t),se(fi.get(this))}:function(...t){return se(n.apply(Ot(this),t))}:function(t,...e){const i=n.call(Ot(this),t,...e);return pi.set(i,t.sort?t.sort():[t]),se(i)}}(n):(n instanceof IDBTransaction&&function Eo(n){if(bt.has(n))return;const t=new Promise((e,i)=>{const r=()=>{n.removeEventListener("complete",s),n.removeEventListener("error",a),n.removeEventListener("abort",a)},s=()=>{e(),r()},a=()=>{i(n.error||new DOMException("AbortError","AbortError")),r()};n.addEventListener("complete",s),n.addEventListener("error",a),n.addEventListener("abort",a)});bt.set(n,t)}(n),yo(n,function vo(){return ui||(ui=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}())?new Proxy(n,At):n)}function se(n){if(n instanceof IDBRequest)return function Po(n){const t=new Promise((e,i)=>{const r=()=>{n.removeEventListener("success",s),n.removeEventListener("error",a)},s=()=>{e(se(n.result)),r()},a=()=>{i(n.error),r()};n.addEventListener("success",s),n.addEventListener("error",a)});return t.then(e=>{e instanceof IDBCursor&&fi.set(e,n)}).catch(()=>{}),xt.set(t,n),t}(n);if(St.has(n))return St.get(n);const t=wo(n);return t!==n&&(St.set(n,t),xt.set(t,n)),t}const Ot=n=>xt.get(n),So=["get","getKey","getAll","getAllKeys","count"],xo=["put","add","delete","clear"],Nt=new Map;function _i(n,t){if(!(n instanceof IDBDatabase)||t in n||"string"!=typeof t)return;if(Nt.get(t))return Nt.get(t);const e=t.replace(/FromIndex$/,""),i=t!==e,r=xo.includes(e);if(!(e in(i?IDBIndex:IDBObjectStore).prototype)||!r&&!So.includes(e))return;const s=function(){var a=q(function*(l,...c){const d=this.transaction(l,r?"readwrite":"readonly");let h=d.store;return i&&(h=h.index(c.shift())),(yield Promise.all([h[e](...c),r&&d.done]))[0]});return function(c){return a.apply(this,arguments)}}();return Nt.set(t,s),s}!function To(n){At=n(At)}(n=>({...n,get:(t,e,i)=>_i(t,e)||n.get(t,e,i),has:(t,e)=>!!_i(t,e)||n.has(t,e)}));class Ao{constructor(t){this.container=t}getPlatformInfoString(){return this.container.getProviders().map(e=>{if(function Oo(n){const t=n.getComponent();return"VERSION"===t?.type}(e)){const i=e.getImmediate();return`${i.library}/${i.version}`}return null}).filter(e=>e).join(" ")}}const Rt="@firebase/app",ve=new di("@firebase/app"),D0="[DEFAULT]",na={[Rt]:"fire-core","@firebase/app-compat":"fire-core-compat","@firebase/analytics":"fire-analytics","@firebase/analytics-compat":"fire-analytics-compat","@firebase/app-check":"fire-app-check","@firebase/app-check-compat":"fire-app-check-compat","@firebase/auth":"fire-auth","@firebase/auth-compat":"fire-auth-compat","@firebase/database":"fire-rtdb","@firebase/database-compat":"fire-rtdb-compat","@firebase/functions":"fire-fn","@firebase/functions-compat":"fire-fn-compat","@firebase/installations":"fire-iid","@firebase/installations-compat":"fire-iid-compat","@firebase/messaging":"fire-fcm","@firebase/messaging-compat":"fire-fcm-compat","@firebase/performance":"fire-perf","@firebase/performance-compat":"fire-perf-compat","@firebase/remote-config":"fire-rc","@firebase/remote-config-compat":"fire-rc-compat","@firebase/storage":"fire-gcs","@firebase/storage-compat":"fire-gcs-compat","@firebase/firestore":"fire-fst","@firebase/firestore-compat":"fire-fst-compat","fire-js":"fire-js",firebase:"fire-js-all"},Ce=new Map,k0=new Map;function ia(n,t){try{n.container.addComponent(t)}catch(e){ve.debug(`Component ${t.name} failed to register with FirebaseApp ${n.name}`,e)}}function F0(n){const t=n.name;if(k0.has(t))return ve.debug(`There were multiple attempts to register component ${t}.`),!1;k0.set(t,n);for(const e of Ce.values())ia(e,n);return!0}const ne=new oi("app","Firebase",{"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}."});class sa{constructor(t,e,i){this._isDeleted=!1,this._options=Object.assign({},t),this._config=Object.assign({},e),this._name=e.name,this._automaticDataCollectionEnabled=e.automaticDataCollectionEnabled,this._container=i,this.container.addComponent(new Xe("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(t){this.checkDestroyed(),this._automaticDataCollectionEnabled=t}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(t){this._isDeleted=t}checkDestroyed(){if(this.isDeleted)throw ne.create("app-deleted",{appName:this._name})}}function Lt(n,t={}){let e=n;"object"!=typeof t&&(t={name:t});const i=Object.assign({name:D0,automaticDataCollectionEnabled:!1},t),r=i.name;if("string"!=typeof r||!r)throw ne.create("bad-app-name",{appName:String(r)});if(e||(e=ri()),!e)throw ne.create("no-options");const s=Ce.get(r);if(s){if(Tt(e,s.options)&&Tt(i,s.config))return s;throw ne.create("duplicate-app",{appName:r})}const a=new po(r);for(const c of k0.values())a.addComponent(c);const l=new sa(e,i,a);return Ce.set(r,l),l}function ke(n,t,e){var i;let r=null!==(i=na[n])&&void 0!==i?i:n;e&&(r+=`-${e}`);const s=r.match(/\s|\//),a=t.match(/\s|\//);if(s||a){const l=[`Unable to register library "${r}" with version "${t}":`];return s&&l.push(`library name "${r}" contains illegal characters (whitespace or "/")`),s&&a&&l.push("and"),a&&l.push(`version name "${t}" contains illegal characters (whitespace or "/")`),void ve.warn(l.join(" "))}F0(new Xe(`${r}-version`,()=>({library:r,version:t}),"VERSION"))}const la="firebase-heartbeat-database",ca=1,e0="firebase-heartbeat-store";let Dt=null;function yi(){return Dt||(Dt=function bo(n,t,{blocked:e,upgrade:i,blocking:r,terminated:s}={}){const a=indexedDB.open(n,t),l=se(a);return i&&a.addEventListener("upgradeneeded",c=>{i(se(a.result),c.oldVersion,c.newVersion,se(a.transaction),c)}),e&&a.addEventListener("blocked",c=>e(c.oldVersion,c.newVersion,c)),l.then(c=>{s&&c.addEventListener("close",()=>s()),r&&c.addEventListener("versionchange",d=>r(d.oldVersion,d.newVersion,d))}).catch(()=>{}),l}(la,ca,{upgrade:(n,t)=>{0===t&&n.createObjectStore(e0)}}).catch(n=>{throw ne.create("idb-open",{originalErrorMessage:n.message})})),Dt}function kt(){return(kt=q(function*(n){try{return yield(yield yi()).transaction(e0).objectStore(e0).get(Ci(n))}catch(t){if(t instanceof $e)ve.warn(t.message);else{const e=ne.create("idb-get",{originalErrorMessage:t?.message});ve.warn(e.message)}}})).apply(this,arguments)}function vi(n,t){return Ft.apply(this,arguments)}function Ft(){return(Ft=q(function*(n,t){try{const i=(yield yi()).transaction(e0,"readwrite");yield i.objectStore(e0).put(t,Ci(n)),yield i.done}catch(e){if(e instanceof $e)ve.warn(e.message);else{const i=ne.create("idb-set",{originalErrorMessage:e?.message});ve.warn(i.message)}}})).apply(this,arguments)}function Ci(n){return`${n.name}!${n.options.appId}`}class fa{constructor(t){this.container=t,this._heartbeatsCache=null;const e=this.container.getProvider("app").getImmediate();this._storage=new _a(e),this._heartbeatsCachePromise=this._storage.read().then(i=>(this._heartbeatsCache=i,i))}triggerHeartbeat(){var t=this;return q(function*(){const i=t.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),r=Pi();if(null===t._heartbeatsCache&&(t._heartbeatsCache=yield t._heartbeatsCachePromise),t._heartbeatsCache.lastSentHeartbeatDate!==r&&!t._heartbeatsCache.heartbeats.some(s=>s.date===r))return t._heartbeatsCache.heartbeats.push({date:r,agent:i}),t._heartbeatsCache.heartbeats=t._heartbeatsCache.heartbeats.filter(s=>{const a=new Date(s.date).valueOf();return Date.now()-a<=2592e6}),t._storage.overwrite(t._heartbeatsCache)})()}getHeartbeatsHeader(){var t=this;return q(function*(){if(null===t._heartbeatsCache&&(yield t._heartbeatsCachePromise),null===t._heartbeatsCache||0===t._heartbeatsCache.heartbeats.length)return"";const e=Pi(),{heartbeatsToSend:i,unsentEntries:r}=function pa(n,t=1024){const e=[];let i=n.slice();for(const r of n){const s=e.find(a=>a.agent===r.agent);if(s){if(s.dates.push(r.date),Ei(e)>t){s.dates.pop();break}}else if(e.push({agent:r.agent,dates:[r.date]}),Ei(e)>t){e.pop();break}i=i.slice(1)}return{heartbeatsToSend:e,unsentEntries:i}}(t._heartbeatsCache.heartbeats),s=A0(JSON.stringify({version:2,heartbeats:i}));return t._heartbeatsCache.lastSentHeartbeatDate=e,r.length>0?(t._heartbeatsCache.heartbeats=r,yield t._storage.overwrite(t._heartbeatsCache)):(t._heartbeatsCache.heartbeats=[],t._storage.overwrite(t._heartbeatsCache)),s})()}}function Pi(){return(new Date).toISOString().substring(0,10)}class _a{constructor(t){this.app=t,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}runIndexedDBEnvironmentCheck(){return q(function*(){return!!function zs(){try{return"object"==typeof indexedDB}catch{return!1}}()&&function js(){return new Promise((n,t)=>{try{let e=!0;const i="validate-browser-context-for-indexeddb-analytics-module",r=self.indexedDB.open(i);r.onsuccess=()=>{r.result.close(),e||self.indexedDB.deleteDatabase(i),n(!0)},r.onupgradeneeded=()=>{e=!1},r.onerror=()=>{var s;t((null===(s=r.error)||void 0===s?void 0:s.message)||"")}}catch(e){t(e)}})}().then(()=>!0).catch(()=>!1)})()}read(){var t=this;return q(function*(){return(yield t._canUseIndexedDBPromise)&&(yield function da(n){return kt.apply(this,arguments)}(t.app))||{heartbeats:[]}})()}overwrite(t){var e=this;return q(function*(){var i;if(yield e._canUseIndexedDBPromise){const s=yield e.read();return vi(e.app,{lastSentHeartbeatDate:null!==(i=t.lastSentHeartbeatDate)&&void 0!==i?i:s.lastSentHeartbeatDate,heartbeats:t.heartbeats})}})()}add(t){var e=this;return q(function*(){var i;if(yield e._canUseIndexedDBPromise){const s=yield e.read();return vi(e.app,{lastSentHeartbeatDate:null!==(i=t.lastSentHeartbeatDate)&&void 0!==i?i:s.lastSentHeartbeatDate,heartbeats:[...s.heartbeats,...t.heartbeats]})}})()}}function Ei(n){return A0(JSON.stringify({version:2,heartbeats:n})).length}!function ma(n){F0(new Xe("platform-logger",t=>new Ao(t),"PRIVATE")),F0(new Xe("heartbeat",t=>new fa(t),"PRIVATE")),ke(Rt,"0.9.15",n),ke(Rt,"0.9.15","esm2017"),ke("fire-js","")}(""),ke("firebase","10.1.0","app");const Ti="@firebase/database";let Bt="";class va{constructor(t){this.domStorage_=t,this.prefix_="firebase:"}set(t,e){null==e?this.domStorage_.removeItem(this.prefixedName_(t)):this.domStorage_.setItem(this.prefixedName_(t),L(e))}get(t){const e=this.domStorage_.getItem(this.prefixedName_(t));return null==e?null:Je(e)}remove(t){this.domStorage_.removeItem(this.prefixedName_(t))}prefixedName_(t){return this.prefix_+t}toString(){return this.domStorage_.toString()}}class Ca{constructor(){this.cache_={},this.isInMemoryStorage=!0}set(t,e){null==e?delete this.cache_[t]:this.cache_[t]=e}get(t){return te(this.cache_,t)?this.cache_[t]:null}remove(t){delete this.cache_[t]}}const bi=function(n){try{if(typeof window<"u"&&typeof window[n]<"u"){const t=window[n];return t.setItem("firebase:sentinel","cache"),t.removeItem("firebase:sentinel"),new va(t)}}catch{}return new Ca},Pe=bi("localStorage"),Ut=bi("sessionStorage"),Fe=new di("@firebase/database"),Si=function(){let n=1;return function(){return n++}}(),xi=function(n){const t=function(n){const t=[];let e=0;for(let i=0;i<n.length;i++){let r=n.charCodeAt(i);if(r>=55296&&r<=56319){const s=r-55296;i++,_(i<n.length,"Surrogate pair missing trail surrogate."),r=65536+(s<<10)+(n.charCodeAt(i)-56320)}r<128?t[e++]=r:r<2048?(t[e++]=r>>6|192,t[e++]=63&r|128):r<65536?(t[e++]=r>>12|224,t[e++]=r>>6&63|128,t[e++]=63&r|128):(t[e++]=r>>18|240,t[e++]=r>>12&63|128,t[e++]=r>>6&63|128,t[e++]=63&r|128)}return t}(n),e=new to;e.update(t);const i=e.digest();return Pt.encodeByteArray(i)},t0=function(...n){let t="";for(let e=0;e<n.length;e++){const i=n[e];Array.isArray(i)||i&&"object"==typeof i&&"number"==typeof i.length?t+=t0.apply(null,i):t+="object"==typeof i?L(i):i,t+=" "}return t};let Ee=null,Ai=!0;const M=function(...n){if(!0===Ai&&(Ai=!1,null===Ee&&!0===Ut.get("logging_enabled")&&function(n,t){_(!t||!0===n||!1===n,"Can't turn on custom loggers persistently."),!0===n?(Fe.logLevel=S.VERBOSE,Ee=Fe.log.bind(Fe),t&&Ut.set("logging_enabled",!0)):"function"==typeof n?Ee=n:(Ee=null,Ut.remove("logging_enabled"))}(!0)),Ee){const t=t0.apply(null,n);Ee(t)}},n0=function(n){return function(...t){M(n,...t)}},Ht=function(...n){const t="FIREBASE INTERNAL ERROR: "+t0(...n);Fe.error(t)},Y=function(...n){const t=`FIREBASE FATAL ERROR: ${t0(...n)}`;throw Fe.error(t),new Error(t)},k=function(...n){const t="FIREBASE WARNING: "+t0(...n);Fe.warn(t)},B0=function(n){return"number"==typeof n&&(n!=n||n===Number.POSITIVE_INFINITY||n===Number.NEGATIVE_INFINITY)},oe="[MIN_NAME]",ie="[MAX_NAME]",Te=function(n,t){if(n===t)return 0;if(n===oe||t===ie)return-1;if(t===oe||n===ie)return 1;{const e=Li(n),i=Li(t);return null!==e?null!==i?e-i==0?n.length-t.length:e-i:-1:null!==i?1:n<t?-1:1}},Ta=function(n,t){return n===t?0:n<t?-1:1},r0=function(n,t){if(t&&n in t)return t[n];throw new Error("Missing required key ("+n+") in object: "+L(t))},Gt=function(n){if("object"!=typeof n||null===n)return L(n);const t=[];for(const i in n)t.push(i);t.sort();let e="{";for(let i=0;i<t.length;i++)0!==i&&(e+=","),e+=L(t[i]),e+=":",e+=Gt(n[t[i]]);return e+="}",e},Ni=function(n,t){const e=n.length;if(e<=t)return[n];const i=[];for(let r=0;r<e;r+=t)i.push(n.substring(r,r+t>e?e:r+t));return i};function D(n,t){for(const e in n)n.hasOwnProperty(e)&&t(e,n[e])}const Ri=function(n){_(!B0(n),"Invalid JSON number");const i=1023;let r,s,a,l,c;0===n?(s=0,a=0,r=1/n==-1/0?1:0):(r=n<0,(n=Math.abs(n))>=Math.pow(2,1-i)?(l=Math.min(Math.floor(Math.log(n)/Math.LN2),i),s=l+i,a=Math.round(n*Math.pow(2,52-l)-Math.pow(2,52))):(s=0,a=Math.round(n/Math.pow(2,-1074))));const d=[];for(c=52;c;c-=1)d.push(a%2?1:0),a=Math.floor(a/2);for(c=11;c;c-=1)d.push(s%2?1:0),s=Math.floor(s/2);d.push(r?1:0),d.reverse();const h=d.join("");let u="";for(c=0;c<64;c+=8){let f=parseInt(h.substr(c,8),2).toString(16);1===f.length&&(f="0"+f),u+=f}return u.toLowerCase()},Sa=new RegExp("^-?(0*)\\d{1,10}$"),Li=function(n){if(Sa.test(n)){const t=Number(n);if(t>=-2147483648&&t<=2147483647)return t}return null},Be=function(n){try{n()}catch(t){setTimeout(()=>{throw k("Exception was thrown by user callback.",t.stack||""),t},Math.floor(0))}},s0=function(n,t){const e=setTimeout(n,t);return"number"==typeof e&&typeof Deno<"u"&&Deno.unrefTimer?Deno.unrefTimer(e):"object"==typeof e&&e.unref&&e.unref(),e};class Na{constructor(t,e){this.appName_=t,this.appCheckProvider=e,this.appCheck=e?.getImmediate({optional:!0}),this.appCheck||e?.get().then(i=>this.appCheck=i)}getToken(t){return this.appCheck?this.appCheck.getToken(t):new Promise((e,i)=>{setTimeout(()=>{this.appCheck?this.getToken(t).then(e,i):e(null)},0)})}addTokenChangeListener(t){var e;null===(e=this.appCheckProvider)||void 0===e||e.get().then(i=>i.addTokenListener(t))}notifyForInvalidToken(){k(`Provided AppCheck credentials for the app named "${this.appName_}" are invalid. This usually indicates your app was not initialized correctly.`)}}class Ra{constructor(t,e,i){this.appName_=t,this.firebaseOptions_=e,this.authProvider_=i,this.auth_=null,this.auth_=i.getImmediate({optional:!0}),this.auth_||i.onInit(r=>this.auth_=r)}getToken(t){return this.auth_?this.auth_.getToken(t).catch(e=>e&&"auth/token-not-initialized"===e.code?(M("Got auth/token-not-initialized error.  Treating as null token."),null):Promise.reject(e)):new Promise((e,i)=>{setTimeout(()=>{this.auth_?this.getToken(t).then(e,i):e(null)},0)})}addTokenChangeListener(t){this.auth_?this.auth_.addAuthTokenListener(t):this.authProvider_.get().then(e=>e.addAuthTokenListener(t))}removeTokenChangeListener(t){this.authProvider_.get().then(e=>e.removeAuthTokenListener(t))}notifyForInvalidToken(){let t='Provided authentication credentials for the app named "'+this.appName_+'" are invalid. This usually indicates your app was not initialized correctly. ';t+="credential"in this.firebaseOptions_?'Make sure the "credential" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':"serviceAccount"in this.firebaseOptions_?'Make sure the "serviceAccount" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':'Make sure the "apiKey" and "databaseURL" properties provided to initializeApp() match the values provided for your app at https://console.firebase.google.com/.',k(t)}}let o0=(()=>{class n{constructor(e){this.accessToken=e}getToken(e){return Promise.resolve({accessToken:this.accessToken})}addTokenChangeListener(e){e(this.accessToken)}removeTokenChangeListener(e){}notifyForInvalidToken(){}}return n.OWNER="owner",n})();const Bi=/(console\.firebase|firebase-console-\w+\.corp|firebase\.corp)\.google\.com/,Gi="websocket",Wi="long_polling";class Zt{constructor(t,e,i,r,s=!1,a="",l=!1,c=!1){this.secure=e,this.namespace=i,this.webSocketOnly=r,this.nodeAdmin=s,this.persistenceKey=a,this.includeNamespaceInQueryParams=l,this.isUsingEmulator=c,this._host=t.toLowerCase(),this._domain=this._host.substr(this._host.indexOf(".")+1),this.internalHost=Pe.get("host:"+t)||this._host}isCacheableHost(){return"s-"===this.internalHost.substr(0,2)}isCustomHost(){return"firebaseio.com"!==this._domain&&"firebaseio-demo.com"!==this._domain}get host(){return this._host}set host(t){t!==this.internalHost&&(this.internalHost=t,this.isCacheableHost()&&Pe.set("host:"+this._host,this.internalHost))}toString(){let t=this.toURLString();return this.persistenceKey&&(t+="<"+this.persistenceKey+">"),t}toURLString(){return`${this.secure?"https://":"http://"}${this.host}/${this.includeNamespaceInQueryParams?`?ns=${this.namespace}`:""}`}}function Zi(n,t,e){let i;if(_("string"==typeof t,"typeof type must == string"),_("object"==typeof e,"typeof params must == object"),t===Gi)i=(n.secure?"wss://":"ws://")+n.internalHost+"/.ws?";else{if(t!==Wi)throw new Error("Unknown connection type: "+t);i=(n.secure?"https://":"http://")+n.internalHost+"/.lp?"}(function La(n){return n.host!==n.internalHost||n.isCustomHost()||n.includeNamespaceInQueryParams})(n)&&(e.ns=n.namespace);const r=[];return D(e,(s,a)=>{r.push(s+"="+a)}),i+r.join("&")}class Ma{constructor(){this.counters_={}}incrementCounter(t,e=1){te(this.counters_,t)||(this.counters_[t]=0),this.counters_[t]+=e}get(){return ks(this.counters_)}}const qt={},Vt={};function Kt(n){const t=n.toString();return qt[t]||(qt[t]=new Ma),qt[t]}class ka{constructor(t){this.onMessage_=t,this.pendingResponses=[],this.currentResponseNum=0,this.closeAfterResponse=-1,this.onClose=null}closeAfter(t,e){this.closeAfterResponse=t,this.onClose=e,this.closeAfterResponse<this.currentResponseNum&&(this.onClose(),this.onClose=null)}handleResponse(t,e){for(this.pendingResponses[t]=e;this.pendingResponses[this.currentResponseNum];){const i=this.pendingResponses[this.currentResponseNum];delete this.pendingResponses[this.currentResponseNum];for(let r=0;r<i.length;++r)i[r]&&Be(()=>{this.onMessage_(i[r])});if(this.currentResponseNum===this.closeAfterResponse){this.onClose&&(this.onClose(),this.onClose=null);break}this.currentResponseNum++}}}class ae{constructor(t,e,i,r,s,a,l){this.connId=t,this.repoInfo=e,this.applicationId=i,this.appCheckToken=r,this.authToken=s,this.transportSessionId=a,this.lastSessionId=l,this.bytesSent=0,this.bytesReceived=0,this.everConnected_=!1,this.log_=n0(t),this.stats_=Kt(e),this.urlFn=c=>(this.appCheckToken&&(c.ac=this.appCheckToken),Zi(e,Wi,c))}open(t,e){this.curSegmentNum=0,this.onDisconnect_=e,this.myPacketOrderer=new ka(t),this.isClosed_=!1,this.connectTimeoutTimer_=setTimeout(()=>{this.log_("Timed out trying to connect."),this.onClosed_(),this.connectTimeoutTimer_=null},Math.floor(3e4)),function(n){if("complete"===document.readyState)n();else{let t=!1;const e=function(){document.body?t||(t=!0,n()):setTimeout(e,Math.floor(10))};document.addEventListener?(document.addEventListener("DOMContentLoaded",e,!1),window.addEventListener("load",e,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",()=>{"complete"===document.readyState&&e()}),window.attachEvent("onload",e))}}(()=>{if(this.isClosed_)return;this.scriptTagHolder=new zt((...s)=>{const[a,l,c,d,h]=s;if(this.incrementIncomingBytes_(s),this.scriptTagHolder)if(this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null),this.everConnected_=!0,"start"===a)this.id=l,this.password=c;else{if("close"!==a)throw new Error("Unrecognized command received: "+a);l?(this.scriptTagHolder.sendNewPolls=!1,this.myPacketOrderer.closeAfter(l,()=>{this.onClosed_()})):this.onClosed_()}},(...s)=>{const[a,l]=s;this.incrementIncomingBytes_(s),this.myPacketOrderer.handleResponse(a,l)},()=>{this.onClosed_()},this.urlFn);const i={start:"t"};i.ser=Math.floor(1e8*Math.random()),this.scriptTagHolder.uniqueCallbackIdentifier&&(i.cb=this.scriptTagHolder.uniqueCallbackIdentifier),i.v="5",this.transportSessionId&&(i.s=this.transportSessionId),this.lastSessionId&&(i.ls=this.lastSessionId),this.applicationId&&(i.p=this.applicationId),this.appCheckToken&&(i.ac=this.appCheckToken),typeof location<"u"&&location.hostname&&Bi.test(location.hostname)&&(i.r="f");const r=this.urlFn(i);this.log_("Connecting via long-poll to "+r),this.scriptTagHolder.addTag(r,()=>{})})}start(){this.scriptTagHolder.startLongPoll(this.id,this.password),this.addDisconnectPingFrame(this.id,this.password)}static forceAllow(){ae.forceAllow_=!0}static forceDisallow(){ae.forceDisallow_=!0}static isAvailable(){return!(!ae.forceAllow_&&(ae.forceDisallow_||!(typeof document<"u")||null==document.createElement||"object"==typeof window&&window.chrome&&window.chrome.extension&&!/^chrome/.test(window.location.href)||"object"==typeof Windows&&"object"==typeof Windows.UI))}markConnectionHealthy(){}shutdown_(){this.isClosed_=!0,this.scriptTagHolder&&(this.scriptTagHolder.close(),this.scriptTagHolder=null),this.myDisconnFrame&&(document.body.removeChild(this.myDisconnFrame),this.myDisconnFrame=null),this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null)}onClosed_(){this.isClosed_||(this.log_("Longpoll is closing itself"),this.shutdown_(),this.onDisconnect_&&(this.onDisconnect_(this.everConnected_),this.onDisconnect_=null))}close(){this.isClosed_||(this.log_("Longpoll is being closed."),this.shutdown_())}send(t){const e=L(t);this.bytesSent+=e.length,this.stats_.incrementCounter("bytes_sent",e.length);const i=ni(e),r=Ni(i,1840);for(let s=0;s<r.length;s++)this.scriptTagHolder.enqueueSegment(this.curSegmentNum,r.length,r[s]),this.curSegmentNum++}addDisconnectPingFrame(t,e){this.myDisconnFrame=document.createElement("iframe");const i={dframe:"t"};i.id=t,i.pw=e,this.myDisconnFrame.src=this.urlFn(i),this.myDisconnFrame.style.display="none",document.body.appendChild(this.myDisconnFrame)}incrementIncomingBytes_(t){const e=L(t).length;this.bytesReceived+=e,this.stats_.incrementCounter("bytes_received",e)}}class zt{constructor(t,e,i,r){this.onDisconnect=i,this.urlFn=r,this.outstandingRequests=new Set,this.pendingSegs=[],this.currentSerial=Math.floor(1e8*Math.random()),this.sendNewPolls=!0;{this.uniqueCallbackIdentifier=Si(),window["pLPCommand"+this.uniqueCallbackIdentifier]=t,window["pRTLPCB"+this.uniqueCallbackIdentifier]=e,this.myIFrame=zt.createIFrame_();let s="";this.myIFrame.src&&"javascript:"===this.myIFrame.src.substr(0,11)&&(s='<script>document.domain="'+document.domain+'";<\/script>');const a="<html><body>"+s+"</body></html>";try{this.myIFrame.doc.open(),this.myIFrame.doc.write(a),this.myIFrame.doc.close()}catch(l){M("frame writing exception"),l.stack&&M(l.stack),M(l)}}}static createIFrame_(){const t=document.createElement("iframe");if(t.style.display="none",!document.body)throw"Document body has not initialized. Wait to initialize Firebase until after the document is ready.";document.body.appendChild(t);try{t.contentWindow.document||M("No IE domain setting required")}catch{const i=document.domain;t.src="javascript:void((function(){document.open();document.domain='"+i+"';document.close();})())"}return t.contentDocument?t.doc=t.contentDocument:t.contentWindow?t.doc=t.contentWindow.document:t.document&&(t.doc=t.document),t}close(){this.alive=!1,this.myIFrame&&(this.myIFrame.doc.body.textContent="",setTimeout(()=>{null!==this.myIFrame&&(document.body.removeChild(this.myIFrame),this.myIFrame=null)},Math.floor(0)));const t=this.onDisconnect;t&&(this.onDisconnect=null,t())}startLongPoll(t,e){for(this.myID=t,this.myPW=e,this.alive=!0;this.newRequest_(););}newRequest_(){if(this.alive&&this.sendNewPolls&&this.outstandingRequests.size<(this.pendingSegs.length>0?2:1)){this.currentSerial++;const t={};t.id=this.myID,t.pw=this.myPW,t.ser=this.currentSerial;let e=this.urlFn(t),i="",r=0;for(;this.pendingSegs.length>0&&this.pendingSegs[0].d.length+30+i.length<=1870;){const a=this.pendingSegs.shift();i=i+"&seg"+r+"="+a.seg+"&ts"+r+"="+a.ts+"&d"+r+"="+a.d,r++}return e+=i,this.addLongPollTag_(e,this.currentSerial),!0}return!1}enqueueSegment(t,e,i){this.pendingSegs.push({seg:t,ts:e,d:i}),this.alive&&this.newRequest_()}addLongPollTag_(t,e){this.outstandingRequests.add(e);const i=()=>{this.outstandingRequests.delete(e),this.newRequest_()},r=setTimeout(i,Math.floor(25e3));this.addTag(t,()=>{clearTimeout(r),i()})}addTag(t,e){setTimeout(()=>{try{if(!this.sendNewPolls)return;const i=this.myIFrame.doc.createElement("script");i.type="text/javascript",i.async=!0,i.src=t,i.onload=i.onreadystatechange=function(){const r=i.readyState;(!r||"loaded"===r||"complete"===r)&&(i.onload=i.onreadystatechange=null,i.parentNode&&i.parentNode.removeChild(i),e())},i.onerror=()=>{M("Long-poll script failed to load: "+t),this.sendNewPolls=!1,this.close()},this.myIFrame.doc.body.appendChild(i)}catch{}},Math.floor(1))}}let H0=null;typeof MozWebSocket<"u"?H0=MozWebSocket:typeof WebSocket<"u"&&(H0=WebSocket);let Ue=(()=>{class n{constructor(e,i,r,s,a,l,c){this.connId=e,this.applicationId=r,this.appCheckToken=s,this.authToken=a,this.keepaliveTimer=null,this.frames=null,this.totalFrames=0,this.bytesSent=0,this.bytesReceived=0,this.log_=n0(this.connId),this.stats_=Kt(i),this.connURL=n.connectionURL_(i,l,c,s,r),this.nodeAdmin=i.nodeAdmin}static connectionURL_(e,i,r,s,a){const l={v:"5"};return typeof location<"u"&&location.hostname&&Bi.test(location.hostname)&&(l.r="f"),i&&(l.s=i),r&&(l.ls=r),s&&(l.ac=s),a&&(l.p=a),Zi(e,Gi,l)}open(e,i){this.onDisconnect=i,this.onMessage=e,this.log_("Websocket connecting to "+this.connURL),this.everConnected_=!1,Pe.set("previous_websocket_failure",!0);try{let r;0,this.mySock=new H0(this.connURL,[],r)}catch(r){this.log_("Error instantiating WebSocket.");const s=r.message||r.data;return s&&this.log_(s),void this.onClosed_()}this.mySock.onopen=()=>{this.log_("Websocket connected."),this.everConnected_=!0},this.mySock.onclose=()=>{this.log_("Websocket connection was disconnected."),this.mySock=null,this.onClosed_()},this.mySock.onmessage=r=>{this.handleIncomingFrame(r)},this.mySock.onerror=r=>{this.log_("WebSocket error.  Closing connection.");const s=r.message||r.data;s&&this.log_(s),this.onClosed_()}}start(){}static forceDisallow(){n.forceDisallow_=!0}static isAvailable(){let e=!1;if(typeof navigator<"u"&&navigator.userAgent){const r=navigator.userAgent.match(/Android ([0-9]{0,}\.[0-9]{0,})/);r&&r.length>1&&parseFloat(r[1])<4.4&&(e=!0)}return!e&&null!==H0&&!n.forceDisallow_}static previouslyFailed(){return Pe.isInMemoryStorage||!0===Pe.get("previous_websocket_failure")}markConnectionHealthy(){Pe.remove("previous_websocket_failure")}appendFrame_(e){if(this.frames.push(e),this.frames.length===this.totalFrames){const i=this.frames.join("");this.frames=null;const r=Je(i);this.onMessage(r)}}handleNewFrameCount_(e){this.totalFrames=e,this.frames=[]}extractFrameCount_(e){if(_(null===this.frames,"We already have a frame buffer"),e.length<=6){const i=Number(e);if(!isNaN(i))return this.handleNewFrameCount_(i),null}return this.handleNewFrameCount_(1),e}handleIncomingFrame(e){if(null===this.mySock)return;const i=e.data;if(this.bytesReceived+=i.length,this.stats_.incrementCounter("bytes_received",i.length),this.resetKeepAlive(),null!==this.frames)this.appendFrame_(i);else{const r=this.extractFrameCount_(i);null!==r&&this.appendFrame_(r)}}send(e){this.resetKeepAlive();const i=L(e);this.bytesSent+=i.length,this.stats_.incrementCounter("bytes_sent",i.length);const r=Ni(i,16384);r.length>1&&this.sendString_(String(r.length));for(let s=0;s<r.length;s++)this.sendString_(r[s])}shutdown_(){this.isClosed_=!0,this.keepaliveTimer&&(clearInterval(this.keepaliveTimer),this.keepaliveTimer=null),this.mySock&&(this.mySock.close(),this.mySock=null)}onClosed_(){this.isClosed_||(this.log_("WebSocket is closing itself"),this.shutdown_(),this.onDisconnect&&(this.onDisconnect(this.everConnected_),this.onDisconnect=null))}close(){this.isClosed_||(this.log_("WebSocket is being closed"),this.shutdown_())}resetKeepAlive(){clearInterval(this.keepaliveTimer),this.keepaliveTimer=setInterval(()=>{this.mySock&&this.sendString_("0"),this.resetKeepAlive()},Math.floor(45e3))}sendString_(e){try{this.mySock.send(e)}catch(i){this.log_("Exception thrown from WebSocket.send():",i.message||i.data,"Closing connection."),setTimeout(this.onClosed_.bind(this),0)}}}return n.responsesRequiredToBeHealthy=2,n.healthyTimeout=3e4,n})(),Qi=(()=>{class n{constructor(e){this.initTransports_(e)}static get ALL_TRANSPORTS(){return[ae,Ue]}static get IS_TRANSPORT_INITIALIZED(){return this.globalTransportInitialized_}initTransports_(e){const i=Ue&&Ue.isAvailable();let r=i&&!Ue.previouslyFailed();if(e.webSocketOnly&&(i||k("wss:// URL used, but browser isn't known to support websockets.  Trying anyway."),r=!0),r)this.transports_=[Ue];else{const s=this.transports_=[];for(const a of n.ALL_TRANSPORTS)a&&a.isAvailable()&&s.push(a);n.globalTransportInitialized_=!0}}initialTransport(){if(this.transports_.length>0)return this.transports_[0];throw new Error("No transports available")}upgradeTransport(){return this.transports_.length>1?this.transports_[1]:null}}return n.globalTransportInitialized_=!1,n})();class ir{constructor(t,e,i,r,s,a,l,c,d,h){this.id=t,this.repoInfo_=e,this.applicationId_=i,this.appCheckToken_=r,this.authToken_=s,this.onMessage_=a,this.onReady_=l,this.onDisconnect_=c,this.onKill_=d,this.lastSessionId=h,this.connectionCount=0,this.pendingDataMessages=[],this.state_=0,this.log_=n0("c:"+this.id+":"),this.transportManager_=new Qi(e),this.log_("Connection created"),this.start_()}start_(){const t=this.transportManager_.initialTransport();this.conn_=new t(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,null,this.lastSessionId),this.primaryResponsesRequired_=t.responsesRequiredToBeHealthy||0;const e=this.connReceiver_(this.conn_),i=this.disconnReceiver_(this.conn_);this.tx_=this.conn_,this.rx_=this.conn_,this.secondaryConn_=null,this.isHealthy_=!1,setTimeout(()=>{this.conn_&&this.conn_.open(e,i)},Math.floor(0));const r=t.healthyTimeout||0;r>0&&(this.healthyTimeout_=s0(()=>{this.healthyTimeout_=null,this.isHealthy_||(this.conn_&&this.conn_.bytesReceived>102400?(this.log_("Connection exceeded healthy timeout but has received "+this.conn_.bytesReceived+" bytes.  Marking connection healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()):this.conn_&&this.conn_.bytesSent>10240?this.log_("Connection exceeded healthy timeout but has sent "+this.conn_.bytesSent+" bytes.  Leaving connection alive."):(this.log_("Closing unhealthy connection after timeout."),this.close()))},Math.floor(r)))}nextTransportId_(){return"c:"+this.id+":"+this.connectionCount++}disconnReceiver_(t){return e=>{t===this.conn_?this.onConnectionLost_(e):t===this.secondaryConn_?(this.log_("Secondary connection lost."),this.onSecondaryConnectionLost_()):this.log_("closing an old connection")}}connReceiver_(t){return e=>{2!==this.state_&&(t===this.rx_?this.onPrimaryMessageReceived_(e):t===this.secondaryConn_?this.onSecondaryMessageReceived_(e):this.log_("message on old connection"))}}sendRequest(t){this.sendData_({t:"d",d:t})}tryCleanupConnection(){this.tx_===this.secondaryConn_&&this.rx_===this.secondaryConn_&&(this.log_("cleaning up and promoting a connection: "+this.secondaryConn_.connId),this.conn_=this.secondaryConn_,this.secondaryConn_=null)}onSecondaryControl_(t){if("t"in t){const e=t.t;"a"===e?this.upgradeIfSecondaryHealthy_():"r"===e?(this.log_("Got a reset on secondary, closing it"),this.secondaryConn_.close(),(this.tx_===this.secondaryConn_||this.rx_===this.secondaryConn_)&&this.close()):"o"===e&&(this.log_("got pong on secondary."),this.secondaryResponsesRequired_--,this.upgradeIfSecondaryHealthy_())}}onSecondaryMessageReceived_(t){const e=r0("t",t),i=r0("d",t);if("c"===e)this.onSecondaryControl_(i);else{if("d"!==e)throw new Error("Unknown protocol layer: "+e);this.pendingDataMessages.push(i)}}upgradeIfSecondaryHealthy_(){this.secondaryResponsesRequired_<=0?(this.log_("Secondary connection is healthy."),this.isHealthy_=!0,this.secondaryConn_.markConnectionHealthy(),this.proceedWithUpgrade_()):(this.log_("sending ping on secondary."),this.secondaryConn_.send({t:"c",d:{t:"p",d:{}}}))}proceedWithUpgrade_(){this.secondaryConn_.start(),this.log_("sending client ack on secondary"),this.secondaryConn_.send({t:"c",d:{t:"a",d:{}}}),this.log_("Ending transmission on primary"),this.conn_.send({t:"c",d:{t:"n",d:{}}}),this.tx_=this.secondaryConn_,this.tryCleanupConnection()}onPrimaryMessageReceived_(t){const e=r0("t",t),i=r0("d",t);"c"===e?this.onControl_(i):"d"===e&&this.onDataMessage_(i)}onDataMessage_(t){this.onPrimaryResponse_(),this.onMessage_(t)}onPrimaryResponse_(){this.isHealthy_||(this.primaryResponsesRequired_--,this.primaryResponsesRequired_<=0&&(this.log_("Primary connection is healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()))}onControl_(t){const e=r0("t",t);if("d"in t){const i=t.d;if("h"===e){const r=Object.assign({},i);this.repoInfo_.isUsingEmulator&&(r.h=this.repoInfo_.host),this.onHandshake_(r)}else if("n"===e){this.log_("recvd end transmission on primary"),this.rx_=this.secondaryConn_;for(let r=0;r<this.pendingDataMessages.length;++r)this.onDataMessage_(this.pendingDataMessages[r]);this.pendingDataMessages=[],this.tryCleanupConnection()}else"s"===e?this.onConnectionShutdown_(i):"r"===e?this.onReset_(i):"e"===e?Ht("Server Error: "+i):"o"===e?(this.log_("got pong on primary."),this.onPrimaryResponse_(),this.sendPingOnPrimaryIfNecessary_()):Ht("Unknown control packet command: "+e)}}onHandshake_(t){const e=t.ts,i=t.v,r=t.h;this.sessionId=t.s,this.repoInfo_.host=r,0===this.state_&&(this.conn_.start(),this.onConnectionEstablished_(this.conn_,e),"5"!==i&&k("Protocol version mismatch detected"),this.tryStartUpgrade_())}tryStartUpgrade_(){const t=this.transportManager_.upgradeTransport();t&&this.startUpgrade_(t)}startUpgrade_(t){this.secondaryConn_=new t(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,this.sessionId),this.secondaryResponsesRequired_=t.responsesRequiredToBeHealthy||0;const e=this.connReceiver_(this.secondaryConn_),i=this.disconnReceiver_(this.secondaryConn_);this.secondaryConn_.open(e,i),s0(()=>{this.secondaryConn_&&(this.log_("Timed out trying to upgrade."),this.secondaryConn_.close())},Math.floor(6e4))}onReset_(t){this.log_("Reset packet received.  New host: "+t),this.repoInfo_.host=t,1===this.state_?this.close():(this.closeConnections_(),this.start_())}onConnectionEstablished_(t,e){this.log_("Realtime connection established."),this.conn_=t,this.state_=1,this.onReady_&&(this.onReady_(e,this.sessionId),this.onReady_=null),0===this.primaryResponsesRequired_?(this.log_("Primary connection is healthy."),this.isHealthy_=!0):s0(()=>{this.sendPingOnPrimaryIfNecessary_()},Math.floor(5e3))}sendPingOnPrimaryIfNecessary_(){!this.isHealthy_&&1===this.state_&&(this.log_("sending ping on primary."),this.sendData_({t:"c",d:{t:"p",d:{}}}))}onSecondaryConnectionLost_(){const t=this.secondaryConn_;this.secondaryConn_=null,(this.tx_===t||this.rx_===t)&&this.close()}onConnectionLost_(t){this.conn_=null,t||0!==this.state_?1===this.state_&&this.log_("Realtime connection lost."):(this.log_("Realtime connection failed."),this.repoInfo_.isCacheableHost()&&(Pe.remove("host:"+this.repoInfo_.host),this.repoInfo_.internalHost=this.repoInfo_.host)),this.close()}onConnectionShutdown_(t){this.log_("Connection shutdown command received. Shutting down..."),this.onKill_&&(this.onKill_(t),this.onKill_=null),this.onDisconnect_=null,this.close()}sendData_(t){if(1!==this.state_)throw"Connection is not connected";this.tx_.send(t)}close(){2!==this.state_&&(this.log_("Closing realtime connection."),this.state_=2,this.closeConnections_(),this.onDisconnect_&&(this.onDisconnect_(),this.onDisconnect_=null))}closeConnections_(){this.log_("Shutting down all connections"),this.conn_&&(this.conn_.close(),this.conn_=null),this.secondaryConn_&&(this.secondaryConn_.close(),this.secondaryConn_=null),this.healthyTimeout_&&(clearTimeout(this.healthyTimeout_),this.healthyTimeout_=null)}}class rr{put(t,e,i,r){}merge(t,e,i,r){}refreshAuthToken(t){}refreshAppCheckToken(t){}onDisconnectPut(t,e,i){}onDisconnectMerge(t,e,i){}onDisconnectCancel(t,e){}reportStats(t){}}class sr{constructor(t){this.allowedEvents_=t,this.listeners_={},_(Array.isArray(t)&&t.length>0,"Requires a non-empty array")}trigger(t,...e){if(Array.isArray(this.listeners_[t])){const i=[...this.listeners_[t]];for(let r=0;r<i.length;r++)i[r].callback.apply(i[r].context,e)}}on(t,e,i){this.validateEventType_(t),this.listeners_[t]=this.listeners_[t]||[],this.listeners_[t].push({callback:e,context:i});const r=this.getInitialEvent(t);r&&e.apply(i,r)}off(t,e,i){this.validateEventType_(t);const r=this.listeners_[t]||[];for(let s=0;s<r.length;s++)if(r[s].callback===e&&(!i||i===r[s].context))return void r.splice(s,1)}validateEventType_(t){_(this.allowedEvents_.find(e=>e===t),"Unknown event: "+t)}}class G0 extends sr{constructor(){super(["online"]),this.online_=!0,typeof window<"u"&&typeof window.addEventListener<"u"&&!si()&&(window.addEventListener("online",()=>{this.online_||(this.online_=!0,this.trigger("online",!0))},!1),window.addEventListener("offline",()=>{this.online_&&(this.online_=!1,this.trigger("online",!1))},!1))}static getInstance(){return new G0}getInitialEvent(t){return _("online"===t,"Unknown event type: "+t),[this.online_]}currentlyOnline(){return this.online_}}class I{constructor(t,e){if(void 0===e){this.pieces_=t.split("/");let i=0;for(let r=0;r<this.pieces_.length;r++)this.pieces_[r].length>0&&(this.pieces_[i]=this.pieces_[r],i++);this.pieces_.length=i,this.pieceNum_=0}else this.pieces_=t,this.pieceNum_=e}toString(){let t="";for(let e=this.pieceNum_;e<this.pieces_.length;e++)""!==this.pieces_[e]&&(t+="/"+this.pieces_[e]);return t||"/"}}function T(){return new I("")}function v(n){return n.pieceNum_>=n.pieces_.length?null:n.pieces_[n.pieceNum_]}function le(n){return n.pieces_.length-n.pieceNum_}function b(n){let t=n.pieceNum_;return t<n.pieces_.length&&t++,new I(n.pieces_,t)}function Yt(n){return n.pieceNum_<n.pieces_.length?n.pieces_[n.pieces_.length-1]:null}function a0(n,t=0){return n.pieces_.slice(n.pieceNum_+t)}function lr(n){if(n.pieceNum_>=n.pieces_.length)return null;const t=[];for(let e=n.pieceNum_;e<n.pieces_.length-1;e++)t.push(n.pieces_[e]);return new I(t,0)}function O(n,t){const e=[];for(let i=n.pieceNum_;i<n.pieces_.length;i++)e.push(n.pieces_[i]);if(t instanceof I)for(let i=t.pieceNum_;i<t.pieces_.length;i++)e.push(t.pieces_[i]);else{const i=t.split("/");for(let r=0;r<i.length;r++)i[r].length>0&&e.push(i[r])}return new I(e,0)}function C(n){return n.pieceNum_>=n.pieces_.length}function B(n,t){const e=v(n),i=v(t);if(null===e)return t;if(e===i)return B(b(n),b(t));throw new Error("INTERNAL ERROR: innerPath ("+t+") is not within outerPath ("+n+")")}function Qt(n,t){if(le(n)!==le(t))return!1;for(let e=n.pieceNum_,i=t.pieceNum_;e<=n.pieces_.length;e++,i++)if(n.pieces_[e]!==t.pieces_[i])return!1;return!0}function Z(n,t){let e=n.pieceNum_,i=t.pieceNum_;if(le(n)>le(t))return!1;for(;e<n.pieces_.length;){if(n.pieces_[e]!==t.pieces_[i])return!1;++e,++i}return!0}class sl{constructor(t,e){this.errorPrefix_=e,this.parts_=a0(t,0),this.byteLength_=Math.max(1,this.parts_.length);for(let i=0;i<this.parts_.length;i++)this.byteLength_+=M0(this.parts_[i]);cr(this)}}function cr(n){if(n.byteLength_>768)throw new Error(n.errorPrefix_+"has a key path longer than 768 bytes ("+n.byteLength_+").");if(n.parts_.length>32)throw new Error(n.errorPrefix_+"path specified exceeds the maximum depth that can be written (32) or object contains a cycle "+Ie(n))}function Ie(n){return 0===n.parts_.length?"":"in property '"+n.parts_.join(".")+"'"}class $t extends sr{constructor(){let t,e;super(["visible"]),typeof document<"u"&&typeof document.addEventListener<"u"&&(typeof document.hidden<"u"?(e="visibilitychange",t="hidden"):typeof document.mozHidden<"u"?(e="mozvisibilitychange",t="mozHidden"):typeof document.msHidden<"u"?(e="msvisibilitychange",t="msHidden"):typeof document.webkitHidden<"u"&&(e="webkitvisibilitychange",t="webkitHidden")),this.visible_=!0,e&&document.addEventListener(e,()=>{const i=!document[t];i!==this.visible_&&(this.visible_=i,this.trigger("visible",i))},!1)}static getInstance(){return new $t}getInitialEvent(t){return _("visible"===t,"Unknown event type: "+t),[this.visible_]}}const l0=1e3;let Z0,we=(()=>{class n extends rr{constructor(e,i,r,s,a,l,c,d){if(super(),this.repoInfo_=e,this.applicationId_=i,this.onDataUpdate_=r,this.onConnectStatus_=s,this.onServerInfoUpdate_=a,this.authTokenProvider_=l,this.appCheckTokenProvider_=c,this.authOverride_=d,this.id=n.nextPersistentConnectionId_++,this.log_=n0("p:"+this.id+":"),this.interruptReasons_={},this.listens=new Map,this.outstandingPuts_=[],this.outstandingGets_=[],this.outstandingPutCount_=0,this.outstandingGetCount_=0,this.onDisconnectRequestQueue_=[],this.connected_=!1,this.reconnectDelay_=l0,this.maxReconnectDelay_=3e5,this.securityDebugCallback_=null,this.lastSessionId=null,this.establishConnectionTimer_=null,this.visible_=!1,this.requestCBHash_={},this.requestNumber_=0,this.realtime_=null,this.authToken_=null,this.appCheckToken_=null,this.forceTokenRefresh_=!1,this.invalidAuthTokenCount_=0,this.invalidAppCheckTokenCount_=0,this.firstConnection_=!0,this.lastConnectionAttemptTime_=null,this.lastConnectionEstablishedTime_=null,d)throw new Error("Auth override specified in options, but not supported on non Node.js platforms");$t.getInstance().on("visible",this.onVisible_,this),-1===e.host.indexOf("fblocal")&&G0.getInstance().on("online",this.onOnline_,this)}sendRequest(e,i,r){const s=++this.requestNumber_,a={r:s,a:e,b:i};this.log_(L(a)),_(this.connected_,"sendRequest call when we're not connected not allowed."),this.realtime_.sendRequest(a),r&&(this.requestCBHash_[s]=r)}get(e){this.initConnection_();const i=new Qe,s={action:"g",request:{p:e._path.toString(),q:e._queryObject},onComplete:l=>{const c=l.d;"ok"===l.s?i.resolve(c):i.reject(c)}};return this.outstandingGets_.push(s),this.outstandingGetCount_++,this.connected_&&this.sendGet_(this.outstandingGets_.length-1),i.promise}listen(e,i,r,s){this.initConnection_();const a=e._queryIdentifier,l=e._path.toString();this.log_("Listen called for "+l+" "+a),this.listens.has(l)||this.listens.set(l,new Map),_(e._queryParams.isDefault()||!e._queryParams.loadsAllData(),"listen() called for non-default but complete query"),_(!this.listens.get(l).has(a),"listen() called twice for same path/queryId.");const c={onComplete:s,hashFn:i,query:e,tag:r};this.listens.get(l).set(a,c),this.connected_&&this.sendListen_(c)}sendGet_(e){const i=this.outstandingGets_[e];this.sendRequest("g",i.request,r=>{delete this.outstandingGets_[e],this.outstandingGetCount_--,0===this.outstandingGetCount_&&(this.outstandingGets_=[]),i.onComplete&&i.onComplete(r)})}sendListen_(e){const i=e.query,r=i._path.toString(),s=i._queryIdentifier;this.log_("Listen on "+r+" for "+s);const a={p:r};e.tag&&(a.q=i._queryObject,a.t=e.tag),a.h=e.hashFn(),this.sendRequest("q",a,c=>{const d=c.d,h=c.s;n.warnOnListenWarnings_(d,i),(this.listens.get(r)&&this.listens.get(r).get(s))===e&&(this.log_("listen response",c),"ok"!==h&&this.removeListen_(r,s),e.onComplete&&e.onComplete(h,d))})}static warnOnListenWarnings_(e,i){if(e&&"object"==typeof e&&te(e,"w")){const r=Le(e,"w");if(Array.isArray(r)&&~r.indexOf("no_index")){const s='".indexOn": "'+i._queryParams.getIndex().toString()+'"',a=i._path.toString();k(`Using an unspecified index. Your data will be downloaded and filtered on the client. Consider adding ${s} at ${a} to your security rules for better performance.`)}}}refreshAuthToken(e){this.authToken_=e,this.log_("Auth token refreshed"),this.authToken_?this.tryAuth():this.connected_&&this.sendRequest("unauth",{},()=>{}),this.reduceReconnectDelayIfAdminCredential_(e)}reduceReconnectDelayIfAdminCredential_(e){(e&&40===e.length||function(n){const t=R0(n).claims;return"object"==typeof t&&!0===t.admin}(e))&&(this.log_("Admin auth credential detected.  Reducing max reconnect time."),this.maxReconnectDelay_=3e4)}refreshAppCheckToken(e){this.appCheckToken_=e,this.log_("App check token refreshed"),this.appCheckToken_?this.tryAppCheck():this.connected_&&this.sendRequest("unappeck",{},()=>{})}tryAuth(){if(this.connected_&&this.authToken_){const e=this.authToken_,i=function(n){const e=R0(n).claims;return!!e&&"object"==typeof e&&e.hasOwnProperty("iat")}(e)?"auth":"gauth",r={cred:e};null===this.authOverride_?r.noauth=!0:"object"==typeof this.authOverride_&&(r.authvar=this.authOverride_),this.sendRequest(i,r,s=>{const a=s.s,l=s.d||"error";this.authToken_===e&&("ok"===a?this.invalidAuthTokenCount_=0:this.onAuthRevoked_(a,l))})}}tryAppCheck(){this.connected_&&this.appCheckToken_&&this.sendRequest("appcheck",{token:this.appCheckToken_},e=>{const i=e.s,r=e.d||"error";"ok"===i?this.invalidAppCheckTokenCount_=0:this.onAppCheckRevoked_(i,r)})}unlisten(e,i){const r=e._path.toString(),s=e._queryIdentifier;this.log_("Unlisten called for "+r+" "+s),_(e._queryParams.isDefault()||!e._queryParams.loadsAllData(),"unlisten() called for non-default but complete query"),this.removeListen_(r,s)&&this.connected_&&this.sendUnlisten_(r,s,e._queryObject,i)}sendUnlisten_(e,i,r,s){this.log_("Unlisten on "+e+" for "+i);const a={p:e};s&&(a.q=r,a.t=s),this.sendRequest("n",a)}onDisconnectPut(e,i,r){this.initConnection_(),this.connected_?this.sendOnDisconnect_("o",e,i,r):this.onDisconnectRequestQueue_.push({pathString:e,action:"o",data:i,onComplete:r})}onDisconnectMerge(e,i,r){this.initConnection_(),this.connected_?this.sendOnDisconnect_("om",e,i,r):this.onDisconnectRequestQueue_.push({pathString:e,action:"om",data:i,onComplete:r})}onDisconnectCancel(e,i){this.initConnection_(),this.connected_?this.sendOnDisconnect_("oc",e,null,i):this.onDisconnectRequestQueue_.push({pathString:e,action:"oc",data:null,onComplete:i})}sendOnDisconnect_(e,i,r,s){const a={p:i,d:r};this.log_("onDisconnect "+e,a),this.sendRequest(e,a,l=>{s&&setTimeout(()=>{s(l.s,l.d)},Math.floor(0))})}put(e,i,r,s){this.putInternal("p",e,i,r,s)}merge(e,i,r,s){this.putInternal("m",e,i,r,s)}putInternal(e,i,r,s,a){this.initConnection_();const l={p:i,d:r};void 0!==a&&(l.h=a),this.outstandingPuts_.push({action:e,request:l,onComplete:s}),this.outstandingPutCount_++,this.connected_?this.sendPut_(this.outstandingPuts_.length-1):this.log_("Buffering put: "+i)}sendPut_(e){const i=this.outstandingPuts_[e].action,r=this.outstandingPuts_[e].request,s=this.outstandingPuts_[e].onComplete;this.outstandingPuts_[e].queued=this.connected_,this.sendRequest(i,r,a=>{this.log_(i+" response",a),delete this.outstandingPuts_[e],this.outstandingPutCount_--,0===this.outstandingPutCount_&&(this.outstandingPuts_=[]),s&&s(a.s,a.d)})}reportStats(e){if(this.connected_){const i={c:e};this.log_("reportStats",i),this.sendRequest("s",i,r=>{"ok"!==r.s&&this.log_("reportStats","Error sending stats: "+r.d)})}}onDataMessage_(e){if("r"in e){this.log_("from server: "+L(e));const i=e.r,r=this.requestCBHash_[i];r&&(delete this.requestCBHash_[i],r(e.b))}else{if("error"in e)throw"A server-side error has occurred: "+e.error;"a"in e&&this.onDataPush_(e.a,e.b)}}onDataPush_(e,i){this.log_("handleServerMessage",e,i),"d"===e?this.onDataUpdate_(i.p,i.d,!1,i.t):"m"===e?this.onDataUpdate_(i.p,i.d,!0,i.t):"c"===e?this.onListenRevoked_(i.p,i.q):"ac"===e?this.onAuthRevoked_(i.s,i.d):"apc"===e?this.onAppCheckRevoked_(i.s,i.d):"sd"===e?this.onSecurityDebugPacket_(i):Ht("Unrecognized action received from server: "+L(e)+"\nAre you using the latest client?")}onReady_(e,i){this.log_("connection ready"),this.connected_=!0,this.lastConnectionEstablishedTime_=(new Date).getTime(),this.handleTimestamp_(e),this.lastSessionId=i,this.firstConnection_&&this.sendConnectStats_(),this.restoreState_(),this.firstConnection_=!1,this.onConnectStatus_(!0)}scheduleConnect_(e){_(!this.realtime_,"Scheduling a connect when we're already connected/ing?"),this.establishConnectionTimer_&&clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=setTimeout(()=>{this.establishConnectionTimer_=null,this.establishConnection_()},Math.floor(e))}initConnection_(){!this.realtime_&&this.firstConnection_&&this.scheduleConnect_(0)}onVisible_(e){e&&!this.visible_&&this.reconnectDelay_===this.maxReconnectDelay_&&(this.log_("Window became visible.  Reducing delay."),this.reconnectDelay_=l0,this.realtime_||this.scheduleConnect_(0)),this.visible_=e}onOnline_(e){e?(this.log_("Browser went online."),this.reconnectDelay_=l0,this.realtime_||this.scheduleConnect_(0)):(this.log_("Browser went offline.  Killing connection."),this.realtime_&&this.realtime_.close())}onRealtimeDisconnect_(){if(this.log_("data client disconnected"),this.connected_=!1,this.realtime_=null,this.cancelSentTransactions_(),this.requestCBHash_={},this.shouldReconnect_()){this.visible_?this.lastConnectionEstablishedTime_&&((new Date).getTime()-this.lastConnectionEstablishedTime_>3e4&&(this.reconnectDelay_=l0),this.lastConnectionEstablishedTime_=null):(this.log_("Window isn't visible.  Delaying reconnect."),this.reconnectDelay_=this.maxReconnectDelay_,this.lastConnectionAttemptTime_=(new Date).getTime());const e=(new Date).getTime()-this.lastConnectionAttemptTime_;let i=Math.max(0,this.reconnectDelay_-e);i=Math.random()*i,this.log_("Trying to reconnect in "+i+"ms"),this.scheduleConnect_(i),this.reconnectDelay_=Math.min(this.maxReconnectDelay_,1.3*this.reconnectDelay_)}this.onConnectStatus_(!1)}establishConnection_(){var e=this;return q(function*(){if(e.shouldReconnect_()){e.log_("Making a connection attempt"),e.lastConnectionAttemptTime_=(new Date).getTime(),e.lastConnectionEstablishedTime_=null;const i=e.onDataMessage_.bind(e),r=e.onReady_.bind(e),s=e.onRealtimeDisconnect_.bind(e),a=e.id+":"+n.nextConnectionId_++,l=e.lastSessionId;let c=!1,d=null;const h=function(){d?d.close():(c=!0,s())};e.realtime_={close:h,sendRequest:function(p){_(d,"sendRequest call when we're not connected not allowed."),d.sendRequest(p)}};const f=e.forceTokenRefresh_;e.forceTokenRefresh_=!1;try{const[p,g]=yield Promise.all([e.authTokenProvider_.getToken(f),e.appCheckTokenProvider_.getToken(f)]);c?M("getToken() completed but was canceled"):(M("getToken() completed. Creating connection."),e.authToken_=p&&p.accessToken,e.appCheckToken_=g&&g.token,d=new ir(a,e.repoInfo_,e.applicationId_,e.appCheckToken_,e.authToken_,i,r,s,E=>{k(E+" ("+e.repoInfo_.toString()+")"),e.interrupt("server_kill")},l))}catch(p){e.log_("Failed to get token: "+p),c||(e.repoInfo_.nodeAdmin&&k(p),h())}}})()}interrupt(e){M("Interrupting connection for reason: "+e),this.interruptReasons_[e]=!0,this.realtime_?this.realtime_.close():(this.establishConnectionTimer_&&(clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=null),this.connected_&&this.onRealtimeDisconnect_())}resume(e){M("Resuming connection for reason: "+e),delete this.interruptReasons_[e],ai(this.interruptReasons_)&&(this.reconnectDelay_=l0,this.realtime_||this.scheduleConnect_(0))}handleTimestamp_(e){const i=e-(new Date).getTime();this.onServerInfoUpdate_({serverTimeOffset:i})}cancelSentTransactions_(){for(let e=0;e<this.outstandingPuts_.length;e++){const i=this.outstandingPuts_[e];i&&"h"in i.request&&i.queued&&(i.onComplete&&i.onComplete("disconnect"),delete this.outstandingPuts_[e],this.outstandingPutCount_--)}0===this.outstandingPutCount_&&(this.outstandingPuts_=[])}onListenRevoked_(e,i){let r;r=i?i.map(a=>Gt(a)).join("$"):"default";const s=this.removeListen_(e,r);s&&s.onComplete&&s.onComplete("permission_denied")}removeListen_(e,i){const r=new I(e).toString();let s;if(this.listens.has(r)){const a=this.listens.get(r);s=a.get(i),a.delete(i),0===a.size&&this.listens.delete(r)}else s=void 0;return s}onAuthRevoked_(e,i){M("Auth token revoked: "+e+"/"+i),this.authToken_=null,this.forceTokenRefresh_=!0,this.realtime_.close(),("invalid_token"===e||"permission_denied"===e)&&(this.invalidAuthTokenCount_++,this.invalidAuthTokenCount_>=3&&(this.reconnectDelay_=3e4,this.authTokenProvider_.notifyForInvalidToken()))}onAppCheckRevoked_(e,i){M("App check token revoked: "+e+"/"+i),this.appCheckToken_=null,this.forceTokenRefresh_=!0,("invalid_token"===e||"permission_denied"===e)&&(this.invalidAppCheckTokenCount_++,this.invalidAppCheckTokenCount_>=3&&this.appCheckTokenProvider_.notifyForInvalidToken())}onSecurityDebugPacket_(e){this.securityDebugCallback_?this.securityDebugCallback_(e):"msg"in e&&console.log("FIREBASE: "+e.msg.replace("\n","\nFIREBASE: "))}restoreState_(){this.tryAuth(),this.tryAppCheck();for(const e of this.listens.values())for(const i of e.values())this.sendListen_(i);for(let e=0;e<this.outstandingPuts_.length;e++)this.outstandingPuts_[e]&&this.sendPut_(e);for(;this.onDisconnectRequestQueue_.length;){const e=this.onDisconnectRequestQueue_.shift();this.sendOnDisconnect_(e.action,e.pathString,e.data,e.onComplete)}for(let e=0;e<this.outstandingGets_.length;e++)this.outstandingGets_[e]&&this.sendGet_(e)}sendConnectStats_(){const e={};let i="js";e["sdk."+i+"."+Bt.replace(/\./g,"-")]=1,si()?e["framework.cordova"]=1:function Ks(){return"object"==typeof navigator&&"ReactNative"===navigator.product}()&&(e["framework.reactnative"]=1),this.reportStats(e)}shouldReconnect_(){const e=G0.getInstance().currentlyOnline();return ai(this.interruptReasons_)&&e}}return n.nextPersistentConnectionId_=0,n.nextConnectionId_=0,n})();class P{constructor(t,e){this.name=t,this.node=e}static Wrap(t,e){return new P(t,e)}}class W0{getCompare(){return this.compare.bind(this)}indexedValueChanged(t,e){const i=new P(oe,t),r=new P(oe,e);return 0!==this.compare(i,r)}minPost(){return P.MIN}}class hr extends W0{static get __EMPTY_NODE(){return Z0}static set __EMPTY_NODE(t){Z0=t}compare(t,e){return Te(t.name,e.name)}isDefinedOn(t){throw Re("KeyIndex.isDefinedOn not expected to be called.")}indexedValueChanged(t,e){return!1}minPost(){return P.MIN}maxPost(){return new P(ie,Z0)}makePost(t,e){return _("string"==typeof t,"KeyIndex indexValue must always be a string."),new P(t,Z0)}toString(){return".key"}}const Q=new hr;class q0{constructor(t,e,i,r,s=null){this.isReverse_=r,this.resultGenerator_=s,this.nodeStack_=[];let a=1;for(;!t.isEmpty();)if(a=e?i(t.key,e):1,r&&(a*=-1),a<0)t=this.isReverse_?t.left:t.right;else{if(0===a){this.nodeStack_.push(t);break}this.nodeStack_.push(t),t=this.isReverse_?t.right:t.left}}getNext(){if(0===this.nodeStack_.length)return null;let e,t=this.nodeStack_.pop();if(e=this.resultGenerator_?this.resultGenerator_(t.key,t.value):{key:t.key,value:t.value},this.isReverse_)for(t=t.left;!t.isEmpty();)this.nodeStack_.push(t),t=t.right;else for(t=t.right;!t.isEmpty();)this.nodeStack_.push(t),t=t.left;return e}hasNext(){return this.nodeStack_.length>0}peek(){if(0===this.nodeStack_.length)return null;const t=this.nodeStack_[this.nodeStack_.length-1];return this.resultGenerator_?this.resultGenerator_(t.key,t.value):{key:t.key,value:t.value}}}let Xt,V=(()=>{class n{constructor(e,i,r,s,a){this.key=e,this.value=i,this.color=r??n.RED,this.left=s??U.EMPTY_NODE,this.right=a??U.EMPTY_NODE}copy(e,i,r,s,a){return new n(e??this.key,i??this.value,r??this.color,s??this.left,a??this.right)}count(){return this.left.count()+1+this.right.count()}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||!!e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min_(){return this.left.isEmpty()?this:this.left.min_()}minKey(){return this.min_().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,i,r){let s=this;const a=r(e,s.key);return s=a<0?s.copy(null,null,null,s.left.insert(e,i,r),null):0===a?s.copy(null,i,null,null,null):s.copy(null,null,null,null,s.right.insert(e,i,r)),s.fixUp_()}removeMin_(){if(this.left.isEmpty())return U.EMPTY_NODE;let e=this;return!e.left.isRed_()&&!e.left.left.isRed_()&&(e=e.moveRedLeft_()),e=e.copy(null,null,null,e.left.removeMin_(),null),e.fixUp_()}remove(e,i){let r,s;if(r=this,i(e,r.key)<0)!r.left.isEmpty()&&!r.left.isRed_()&&!r.left.left.isRed_()&&(r=r.moveRedLeft_()),r=r.copy(null,null,null,r.left.remove(e,i),null);else{if(r.left.isRed_()&&(r=r.rotateRight_()),!r.right.isEmpty()&&!r.right.isRed_()&&!r.right.left.isRed_()&&(r=r.moveRedRight_()),0===i(e,r.key)){if(r.right.isEmpty())return U.EMPTY_NODE;s=r.right.min_(),r=r.copy(s.key,s.value,null,null,r.right.removeMin_())}r=r.copy(null,null,null,null,r.right.remove(e,i))}return r.fixUp_()}isRed_(){return this.color}fixUp_(){let e=this;return e.right.isRed_()&&!e.left.isRed_()&&(e=e.rotateLeft_()),e.left.isRed_()&&e.left.left.isRed_()&&(e=e.rotateRight_()),e.left.isRed_()&&e.right.isRed_()&&(e=e.colorFlip_()),e}moveRedLeft_(){let e=this.colorFlip_();return e.right.left.isRed_()&&(e=e.copy(null,null,null,null,e.right.rotateRight_()),e=e.rotateLeft_(),e=e.colorFlip_()),e}moveRedRight_(){let e=this.colorFlip_();return e.left.left.isRed_()&&(e=e.rotateRight_(),e=e.colorFlip_()),e}rotateLeft_(){const e=this.copy(null,null,n.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight_(){const e=this.copy(null,null,n.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip_(){const e=this.left.copy(null,null,!this.left.color,null,null),i=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,i)}checkMaxDepth_(){const e=this.check_();return Math.pow(2,e)<=this.count()+1}check_(){if(this.isRed_()&&this.left.isRed_())throw new Error("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed_())throw new Error("Right child of ("+this.key+","+this.value+") is red");const e=this.left.check_();if(e!==this.right.check_())throw new Error("Black depths differ");return e+(this.isRed_()?0:1)}}return n.RED=!0,n.BLACK=!1,n})();class U{constructor(t,e=U.EMPTY_NODE){this.comparator_=t,this.root_=e}insert(t,e){return new U(this.comparator_,this.root_.insert(t,e,this.comparator_).copy(null,null,V.BLACK,null,null))}remove(t){return new U(this.comparator_,this.root_.remove(t,this.comparator_).copy(null,null,V.BLACK,null,null))}get(t){let e,i=this.root_;for(;!i.isEmpty();){if(e=this.comparator_(t,i.key),0===e)return i.value;e<0?i=i.left:e>0&&(i=i.right)}return null}getPredecessorKey(t){let e,i=this.root_,r=null;for(;!i.isEmpty();){if(e=this.comparator_(t,i.key),0===e){if(i.left.isEmpty())return r?r.key:null;for(i=i.left;!i.right.isEmpty();)i=i.right;return i.key}e<0?i=i.left:e>0&&(r=i,i=i.right)}throw new Error("Attempted to find predecessor key for a nonexistent key.  What gives?")}isEmpty(){return this.root_.isEmpty()}count(){return this.root_.count()}minKey(){return this.root_.minKey()}maxKey(){return this.root_.maxKey()}inorderTraversal(t){return this.root_.inorderTraversal(t)}reverseTraversal(t){return this.root_.reverseTraversal(t)}getIterator(t){return new q0(this.root_,null,this.comparator_,!1,t)}getIteratorFrom(t,e){return new q0(this.root_,t,this.comparator_,!1,e)}getReverseIteratorFrom(t,e){return new q0(this.root_,t,this.comparator_,!0,e)}getReverseIterator(t){return new q0(this.root_,null,this.comparator_,!0,t)}}function fl(n,t){return Te(n.name,t.name)}function Jt(n,t){return Te(n,t)}U.EMPTY_NODE=new class hl{copy(t,e,i,r,s){return this}insert(t,e,i){return new V(t,e,null)}remove(t,e){return this}count(){return 0}isEmpty(){return!0}inorderTraversal(t){return!1}reverseTraversal(t){return!1}minKey(){return null}maxKey(){return null}check_(){return 0}isRed_(){return!1}};const fr=function(n){return"number"==typeof n?"number:"+Ri(n):"string:"+n},pr=function(n){if(n.isLeafNode()){const t=n.val();_("string"==typeof t||"number"==typeof t||"object"==typeof t&&te(t,".sv"),"Priority must be a string or number.")}else _(n===Xt||n.isEmpty(),"priority of unexpected type.");_(n===Xt||n.getPriority().isEmpty(),"Priority nodes can't have a priority of their own.")};let _r,mr,gr,He=(()=>{class n{constructor(e,i=n.__childrenNodeConstructor.EMPTY_NODE){this.value_=e,this.priorityNode_=i,this.lazyHash_=null,_(null!=this.value_,"LeafNode shouldn't be created with null/undefined value."),pr(this.priorityNode_)}static set __childrenNodeConstructor(e){_r=e}static get __childrenNodeConstructor(){return _r}isLeafNode(){return!0}getPriority(){return this.priorityNode_}updatePriority(e){return new n(this.value_,e)}getImmediateChild(e){return".priority"===e?this.priorityNode_:n.__childrenNodeConstructor.EMPTY_NODE}getChild(e){return C(e)?this:".priority"===v(e)?this.priorityNode_:n.__childrenNodeConstructor.EMPTY_NODE}hasChild(){return!1}getPredecessorChildName(e,i){return null}updateImmediateChild(e,i){return".priority"===e?this.updatePriority(i):i.isEmpty()&&".priority"!==e?this:n.__childrenNodeConstructor.EMPTY_NODE.updateImmediateChild(e,i).updatePriority(this.priorityNode_)}updateChild(e,i){const r=v(e);return null===r?i:i.isEmpty()&&".priority"!==r?this:(_(".priority"!==r||1===le(e),".priority must be the last token in a path"),this.updateImmediateChild(r,n.__childrenNodeConstructor.EMPTY_NODE.updateChild(b(e),i)))}isEmpty(){return!1}numChildren(){return 0}forEachChild(e,i){return!1}val(e){return e&&!this.getPriority().isEmpty()?{".value":this.getValue(),".priority":this.getPriority().val()}:this.getValue()}hash(){if(null===this.lazyHash_){let e="";this.priorityNode_.isEmpty()||(e+="priority:"+fr(this.priorityNode_.val())+":");const i=typeof this.value_;e+=i+":",e+="number"===i?Ri(this.value_):this.value_,this.lazyHash_=xi(e)}return this.lazyHash_}getValue(){return this.value_}compareTo(e){return e===n.__childrenNodeConstructor.EMPTY_NODE?1:e instanceof n.__childrenNodeConstructor?-1:(_(e.isLeafNode(),"Unknown node type"),this.compareToLeafNode_(e))}compareToLeafNode_(e){const i=typeof e.value_,r=typeof this.value_,s=n.VALUE_TYPE_ORDER.indexOf(i),a=n.VALUE_TYPE_ORDER.indexOf(r);return _(s>=0,"Unknown leaf type: "+i),_(a>=0,"Unknown leaf type: "+r),s===a?"object"===r?0:this.value_<e.value_?-1:this.value_===e.value_?0:1:a-s}withIndex(){return this}isIndexed(){return!0}equals(e){return e===this||!!e.isLeafNode()&&(this.value_===e.value_&&this.priorityNode_.equals(e.priorityNode_))}}return n.VALUE_TYPE_ORDER=["object","boolean","number","string"],n})();const x=new class gl extends W0{compare(t,e){const i=t.node.getPriority(),r=e.node.getPriority(),s=i.compareTo(r);return 0===s?Te(t.name,e.name):s}isDefinedOn(t){return!t.getPriority().isEmpty()}indexedValueChanged(t,e){return!t.getPriority().equals(e.getPriority())}minPost(){return P.MIN}maxPost(){return new P(ie,new He("[PRIORITY-POST]",gr))}makePost(t,e){const i=mr(t);return new P(e,new He("[PRIORITY-POST]",i))}toString(){return".priority"}},yl=Math.log(2);class vl{constructor(t){this.count=parseInt(Math.log(t+1)/yl,10),this.current_=this.count-1;const r=(s=>parseInt(Array(this.count+1).join("1"),2))();this.bits_=t+1&r}nextBitIsOne(){const t=!(this.bits_&1<<this.current_);return this.current_--,t}}const V0=function(n,t,e,i){n.sort(t);const r=function(c,d){const h=d-c;let u,f;if(0===h)return null;if(1===h)return u=n[c],f=e?e(u):u,new V(f,u.node,V.BLACK,null,null);{const p=parseInt(h/2,10)+c,g=r(c,p),E=r(p+1,d);return u=n[p],f=e?e(u):u,new V(f,u.node,V.BLACK,g,E)}},l=function(c){let d=null,h=null,u=n.length;const f=function(g,E){const R=u-g,W=u;u-=g;const vt=r(R+1,W),Qn=n[R],vu=e?e(Qn):Qn;p(new V(vu,Qn.node,E,null,vt))},p=function(g){d?(d.left=g,d=g):(h=g,d=g)};for(let g=0;g<c.count;++g){const E=c.nextBitIsOne(),R=Math.pow(2,c.count-(g+1));E?f(R,V.BLACK):(f(R,V.BLACK),f(R,V.RED))}return h}(new vl(n.length));return new U(i||t,l)};let en;const Ge={};class re{constructor(t,e){this.indexes_=t,this.indexSet_=e}static get Default(){return _(Ge&&x,"ChildrenNode.ts has not been loaded"),en=en||new re({".priority":Ge},{".priority":x}),en}get(t){const e=Le(this.indexes_,t);if(!e)throw new Error("No index defined for "+t);return e instanceof U?e:null}hasIndex(t){return te(this.indexSet_,t.toString())}addIndex(t,e){_(t!==Q,"KeyIndex always exists and isn't meant to be added to the IndexMap.");const i=[];let r=!1;const s=e.getIterator(P.Wrap);let l,a=s.getNext();for(;a;)r=r||t.isDefinedOn(a.node),i.push(a),a=s.getNext();l=r?V0(i,t.getCompare()):Ge;const c=t.toString(),d=Object.assign({},this.indexSet_);d[c]=t;const h=Object.assign({},this.indexes_);return h[c]=l,new re(h,d)}addToIndexes(t,e){const i=L0(this.indexes_,(r,s)=>{const a=Le(this.indexSet_,s);if(_(a,"Missing index implementation for "+s),r===Ge){if(a.isDefinedOn(t.node)){const l=[],c=e.getIterator(P.Wrap);let d=c.getNext();for(;d;)d.name!==t.name&&l.push(d),d=c.getNext();return l.push(t),V0(l,a.getCompare())}return Ge}{const l=e.get(t.name);let c=r;return l&&(c=c.remove(new P(t.name,l))),c.insert(t,t.node)}});return new re(i,this.indexSet_)}removeFromIndexes(t,e){const i=L0(this.indexes_,r=>{if(r===Ge)return r;{const s=e.get(t.name);return s?r.remove(new P(t.name,s)):r}});return new re(i,this.indexSet_)}}let c0,y=(()=>{class n{constructor(e,i,r){this.children_=e,this.priorityNode_=i,this.indexMap_=r,this.lazyHash_=null,this.priorityNode_&&pr(this.priorityNode_),this.children_.isEmpty()&&_(!this.priorityNode_||this.priorityNode_.isEmpty(),"An empty node cannot have a priority")}static get EMPTY_NODE(){return c0||(c0=new n(new U(Jt),null,re.Default))}isLeafNode(){return!1}getPriority(){return this.priorityNode_||c0}updatePriority(e){return this.children_.isEmpty()?this:new n(this.children_,e,this.indexMap_)}getImmediateChild(e){if(".priority"===e)return this.getPriority();{const i=this.children_.get(e);return null===i?c0:i}}getChild(e){const i=v(e);return null===i?this:this.getImmediateChild(i).getChild(b(e))}hasChild(e){return null!==this.children_.get(e)}updateImmediateChild(e,i){if(_(i,"We should always be passing snapshot nodes"),".priority"===e)return this.updatePriority(i);{const r=new P(e,i);let s,a;i.isEmpty()?(s=this.children_.remove(e),a=this.indexMap_.removeFromIndexes(r,this.children_)):(s=this.children_.insert(e,i),a=this.indexMap_.addToIndexes(r,this.children_));const l=s.isEmpty()?c0:this.priorityNode_;return new n(s,l,a)}}updateChild(e,i){const r=v(e);if(null===r)return i;{_(".priority"!==v(e)||1===le(e),".priority must be the last token in a path");const s=this.getImmediateChild(r).updateChild(b(e),i);return this.updateImmediateChild(r,s)}}isEmpty(){return this.children_.isEmpty()}numChildren(){return this.children_.count()}val(e){if(this.isEmpty())return null;const i={};let r=0,s=0,a=!0;if(this.forEachChild(x,(l,c)=>{i[l]=c.val(e),r++,a&&n.INTEGER_REGEXP_.test(l)?s=Math.max(s,Number(l)):a=!1}),!e&&a&&s<2*r){const l=[];for(const c in i)l[c]=i[c];return l}return e&&!this.getPriority().isEmpty()&&(i[".priority"]=this.getPriority().val()),i}hash(){if(null===this.lazyHash_){let e="";this.getPriority().isEmpty()||(e+="priority:"+fr(this.getPriority().val())+":"),this.forEachChild(x,(i,r)=>{const s=r.hash();""!==s&&(e+=":"+i+":"+s)}),this.lazyHash_=""===e?"":xi(e)}return this.lazyHash_}getPredecessorChildName(e,i,r){const s=this.resolveIndex_(r);if(s){const a=s.getPredecessorKey(new P(e,i));return a?a.name:null}return this.children_.getPredecessorKey(e)}getFirstChildName(e){const i=this.resolveIndex_(e);if(i){const r=i.minKey();return r&&r.name}return this.children_.minKey()}getFirstChild(e){const i=this.getFirstChildName(e);return i?new P(i,this.children_.get(i)):null}getLastChildName(e){const i=this.resolveIndex_(e);if(i){const r=i.maxKey();return r&&r.name}return this.children_.maxKey()}getLastChild(e){const i=this.getLastChildName(e);return i?new P(i,this.children_.get(i)):null}forEachChild(e,i){const r=this.resolveIndex_(e);return r?r.inorderTraversal(s=>i(s.name,s.node)):this.children_.inorderTraversal(i)}getIterator(e){return this.getIteratorFrom(e.minPost(),e)}getIteratorFrom(e,i){const r=this.resolveIndex_(i);if(r)return r.getIteratorFrom(e,s=>s);{const s=this.children_.getIteratorFrom(e.name,P.Wrap);let a=s.peek();for(;null!=a&&i.compare(a,e)<0;)s.getNext(),a=s.peek();return s}}getReverseIterator(e){return this.getReverseIteratorFrom(e.maxPost(),e)}getReverseIteratorFrom(e,i){const r=this.resolveIndex_(i);if(r)return r.getReverseIteratorFrom(e,s=>s);{const s=this.children_.getReverseIteratorFrom(e.name,P.Wrap);let a=s.peek();for(;null!=a&&i.compare(a,e)>0;)s.getNext(),a=s.peek();return s}}compareTo(e){return this.isEmpty()?e.isEmpty()?0:-1:e.isLeafNode()||e.isEmpty()?1:e===d0?-1:0}withIndex(e){if(e===Q||this.indexMap_.hasIndex(e))return this;{const i=this.indexMap_.addIndex(e,this.children_);return new n(this.children_,this.priorityNode_,i)}}isIndexed(e){return e===Q||this.indexMap_.hasIndex(e)}equals(e){if(e===this)return!0;if(e.isLeafNode())return!1;{const i=e;if(this.getPriority().equals(i.getPriority())){if(this.children_.count()===i.children_.count()){const r=this.getIterator(x),s=i.getIterator(x);let a=r.getNext(),l=s.getNext();for(;a&&l;){if(a.name!==l.name||!a.node.equals(l.node))return!1;a=r.getNext(),l=s.getNext()}return null===a&&null===l}return!1}return!1}}resolveIndex_(e){return e===Q?null:this.indexMap_.get(e.toString())}}return n.INTEGER_REGEXP_=/^(0|[1-9]\d*)$/,n})();const d0=new class Cl extends y{constructor(){super(new U(Jt),y.EMPTY_NODE,re.Default)}compareTo(t){return t===this?0:1}equals(t){return t===this}getPriority(){return this}getImmediateChild(t){return y.EMPTY_NODE}isEmpty(){return!1}};Object.defineProperties(P,{MIN:{value:new P(oe,y.EMPTY_NODE)},MAX:{value:new P(ie,d0)}}),hr.__EMPTY_NODE=y.EMPTY_NODE,He.__childrenNodeConstructor=y,function pl(n){Xt=n}(d0),function ml(n){gr=n}(d0);const Pl=!0;function N(n,t=null){if(null===n)return y.EMPTY_NODE;if("object"==typeof n&&".priority"in n&&(t=n[".priority"]),_(null===t||"string"==typeof t||"number"==typeof t||"object"==typeof t&&".sv"in t,"Invalid priority type found: "+typeof t),"object"==typeof n&&".value"in n&&null!==n[".value"]&&(n=n[".value"]),"object"!=typeof n||".sv"in n)return new He(n,N(t));if(n instanceof Array||!Pl){let e=y.EMPTY_NODE;return D(n,(i,r)=>{if(te(n,i)&&"."!==i.substring(0,1)){const s=N(r);(s.isLeafNode()||!s.isEmpty())&&(e=e.updateImmediateChild(i,s))}}),e.updatePriority(N(t))}{const e=[];let i=!1;if(D(n,(a,l)=>{if("."!==a.substring(0,1)){const c=N(l);c.isEmpty()||(i=i||!c.getPriority().isEmpty(),e.push(new P(a,c)))}}),0===e.length)return y.EMPTY_NODE;const s=V0(e,fl,a=>a.name,Jt);if(i){const a=V0(e,x.getCompare());return new y(s,N(t),new re({".priority":a},{".priority":x}))}return new y(s,N(t),re.Default)}}!function _l(n){mr=n}(N);class tn extends W0{constructor(t){super(),this.indexPath_=t,_(!C(t)&&".priority"!==v(t),"Can't create PathIndex with empty path or .priority key")}extractChild(t){return t.getChild(this.indexPath_)}isDefinedOn(t){return!t.getChild(this.indexPath_).isEmpty()}compare(t,e){const i=this.extractChild(t.node),r=this.extractChild(e.node),s=i.compareTo(r);return 0===s?Te(t.name,e.name):s}makePost(t,e){const i=N(t),r=y.EMPTY_NODE.updateChild(this.indexPath_,i);return new P(e,r)}maxPost(){const t=y.EMPTY_NODE.updateChild(this.indexPath_,d0);return new P(ie,t)}toString(){return a0(this.indexPath_,0).join("/")}}const nn=new class El extends W0{compare(t,e){const i=t.node.compareTo(e.node);return 0===i?Te(t.name,e.name):i}isDefinedOn(t){return!0}indexedValueChanged(t,e){return!t.equals(e)}minPost(){return P.MIN}maxPost(){return P.MAX}makePost(t,e){const i=N(t);return new P(e,i)}toString(){return".value"}};function yr(n){return{type:"value",snapshotNode:n}}function We(n,t){return{type:"child_added",snapshotNode:t,childName:n}}function u0(n,t){return{type:"child_removed",snapshotNode:t,childName:n}}function h0(n,t,e){return{type:"child_changed",snapshotNode:t,childName:n,oldSnap:e}}class rn{constructor(t){this.index_=t}updateChild(t,e,i,r,s,a){_(t.isIndexed(this.index_),"A node must be indexed if only a child is updated");const l=t.getImmediateChild(e);return l.getChild(r).equals(i.getChild(r))&&l.isEmpty()===i.isEmpty()||(null!=a&&(i.isEmpty()?t.hasChild(e)?a.trackChildChange(u0(e,l)):_(t.isLeafNode(),"A child remove without an old child only makes sense on a leaf node"):l.isEmpty()?a.trackChildChange(We(e,i)):a.trackChildChange(h0(e,i,l))),t.isLeafNode()&&i.isEmpty())?t:t.updateImmediateChild(e,i).withIndex(this.index_)}updateFullNode(t,e,i){return null!=i&&(t.isLeafNode()||t.forEachChild(x,(r,s)=>{e.hasChild(r)||i.trackChildChange(u0(r,s))}),e.isLeafNode()||e.forEachChild(x,(r,s)=>{if(t.hasChild(r)){const a=t.getImmediateChild(r);a.equals(s)||i.trackChildChange(h0(r,s,a))}else i.trackChildChange(We(r,s))})),e.withIndex(this.index_)}updatePriority(t,e){return t.isEmpty()?y.EMPTY_NODE:t.updatePriority(e)}filtersNodes(){return!1}getIndexedFilter(){return this}getIndex(){return this.index_}}class f0{constructor(t){this.indexedFilter_=new rn(t.getIndex()),this.index_=t.getIndex(),this.startPost_=f0.getStartPost_(t),this.endPost_=f0.getEndPost_(t),this.startIsInclusive_=!t.startAfterSet_,this.endIsInclusive_=!t.endBeforeSet_}getStartPost(){return this.startPost_}getEndPost(){return this.endPost_}matches(t){const e=this.startIsInclusive_?this.index_.compare(this.getStartPost(),t)<=0:this.index_.compare(this.getStartPost(),t)<0,i=this.endIsInclusive_?this.index_.compare(t,this.getEndPost())<=0:this.index_.compare(t,this.getEndPost())<0;return e&&i}updateChild(t,e,i,r,s,a){return this.matches(new P(e,i))||(i=y.EMPTY_NODE),this.indexedFilter_.updateChild(t,e,i,r,s,a)}updateFullNode(t,e,i){e.isLeafNode()&&(e=y.EMPTY_NODE);let r=e.withIndex(this.index_);r=r.updatePriority(y.EMPTY_NODE);const s=this;return e.forEachChild(x,(a,l)=>{s.matches(new P(a,l))||(r=r.updateImmediateChild(a,y.EMPTY_NODE))}),this.indexedFilter_.updateFullNode(t,r,i)}updatePriority(t,e){return t}filtersNodes(){return!0}getIndexedFilter(){return this.indexedFilter_}getIndex(){return this.index_}static getStartPost_(t){if(t.hasStart()){const e=t.getIndexStartName();return t.getIndex().makePost(t.getIndexStartValue(),e)}return t.getIndex().minPost()}static getEndPost_(t){if(t.hasEnd()){const e=t.getIndexEndName();return t.getIndex().makePost(t.getIndexEndValue(),e)}return t.getIndex().maxPost()}}class Il{constructor(t){this.withinDirectionalStart=e=>this.reverse_?this.withinEndPost(e):this.withinStartPost(e),this.withinDirectionalEnd=e=>this.reverse_?this.withinStartPost(e):this.withinEndPost(e),this.withinStartPost=e=>{const i=this.index_.compare(this.rangedFilter_.getStartPost(),e);return this.startIsInclusive_?i<=0:i<0},this.withinEndPost=e=>{const i=this.index_.compare(e,this.rangedFilter_.getEndPost());return this.endIsInclusive_?i<=0:i<0},this.rangedFilter_=new f0(t),this.index_=t.getIndex(),this.limit_=t.getLimit(),this.reverse_=!t.isViewFromLeft(),this.startIsInclusive_=!t.startAfterSet_,this.endIsInclusive_=!t.endBeforeSet_}updateChild(t,e,i,r,s,a){return this.rangedFilter_.matches(new P(e,i))||(i=y.EMPTY_NODE),t.getImmediateChild(e).equals(i)?t:t.numChildren()<this.limit_?this.rangedFilter_.getIndexedFilter().updateChild(t,e,i,r,s,a):this.fullLimitUpdateChild_(t,e,i,s,a)}updateFullNode(t,e,i){let r;if(e.isLeafNode()||e.isEmpty())r=y.EMPTY_NODE.withIndex(this.index_);else if(2*this.limit_<e.numChildren()&&e.isIndexed(this.index_)){let s;r=y.EMPTY_NODE.withIndex(this.index_),s=this.reverse_?e.getReverseIteratorFrom(this.rangedFilter_.getEndPost(),this.index_):e.getIteratorFrom(this.rangedFilter_.getStartPost(),this.index_);let a=0;for(;s.hasNext()&&a<this.limit_;){const l=s.getNext();if(this.withinDirectionalStart(l)){if(!this.withinDirectionalEnd(l))break;r=r.updateImmediateChild(l.name,l.node),a++}}}else{let s;r=e.withIndex(this.index_),r=r.updatePriority(y.EMPTY_NODE),s=this.reverse_?r.getReverseIterator(this.index_):r.getIterator(this.index_);let a=0;for(;s.hasNext();){const l=s.getNext();a<this.limit_&&this.withinDirectionalStart(l)&&this.withinDirectionalEnd(l)?a++:r=r.updateImmediateChild(l.name,y.EMPTY_NODE)}}return this.rangedFilter_.getIndexedFilter().updateFullNode(t,r,i)}updatePriority(t,e){return t}filtersNodes(){return!0}getIndexedFilter(){return this.rangedFilter_.getIndexedFilter()}getIndex(){return this.index_}fullLimitUpdateChild_(t,e,i,r,s){let a;if(this.reverse_){const u=this.index_.getCompare();a=(f,p)=>u(p,f)}else a=this.index_.getCompare();const l=t;_(l.numChildren()===this.limit_,"");const c=new P(e,i),d=this.reverse_?l.getFirstChild(this.index_):l.getLastChild(this.index_),h=this.rangedFilter_.matches(c);if(l.hasChild(e)){const u=l.getImmediateChild(e);let f=r.getChildAfterChild(this.index_,d,this.reverse_);for(;null!=f&&(f.name===e||l.hasChild(f.name));)f=r.getChildAfterChild(this.index_,f,this.reverse_);const p=null==f?1:a(f,c);if(h&&!i.isEmpty()&&p>=0)return s?.trackChildChange(h0(e,i,u)),l.updateImmediateChild(e,i);{s?.trackChildChange(u0(e,u));const E=l.updateImmediateChild(e,y.EMPTY_NODE);return null!=f&&this.rangedFilter_.matches(f)?(s?.trackChildChange(We(f.name,f.node)),E.updateImmediateChild(f.name,f.node)):E}}return i.isEmpty()?t:h&&a(d,c)>=0?(null!=s&&(s.trackChildChange(u0(d.name,d.node)),s.trackChildChange(We(e,i))),l.updateImmediateChild(e,i).updateImmediateChild(d.name,y.EMPTY_NODE)):t}}class sn{constructor(){this.limitSet_=!1,this.startSet_=!1,this.startNameSet_=!1,this.startAfterSet_=!1,this.endSet_=!1,this.endNameSet_=!1,this.endBeforeSet_=!1,this.limit_=0,this.viewFrom_="",this.indexStartValue_=null,this.indexStartName_="",this.indexEndValue_=null,this.indexEndName_="",this.index_=x}hasStart(){return this.startSet_}isViewFromLeft(){return""===this.viewFrom_?this.startSet_:"l"===this.viewFrom_}getIndexStartValue(){return _(this.startSet_,"Only valid if start has been set"),this.indexStartValue_}getIndexStartName(){return _(this.startSet_,"Only valid if start has been set"),this.startNameSet_?this.indexStartName_:oe}hasEnd(){return this.endSet_}getIndexEndValue(){return _(this.endSet_,"Only valid if end has been set"),this.indexEndValue_}getIndexEndName(){return _(this.endSet_,"Only valid if end has been set"),this.endNameSet_?this.indexEndName_:ie}hasLimit(){return this.limitSet_}hasAnchoredLimit(){return this.limitSet_&&""!==this.viewFrom_}getLimit(){return _(this.limitSet_,"Only valid if limit has been set"),this.limit_}getIndex(){return this.index_}loadsAllData(){return!(this.startSet_||this.endSet_||this.limitSet_)}isDefault(){return this.loadsAllData()&&this.index_===x}copy(){const t=new sn;return t.limitSet_=this.limitSet_,t.limit_=this.limit_,t.startSet_=this.startSet_,t.startAfterSet_=this.startAfterSet_,t.indexStartValue_=this.indexStartValue_,t.startNameSet_=this.startNameSet_,t.indexStartName_=this.indexStartName_,t.endSet_=this.endSet_,t.endBeforeSet_=this.endBeforeSet_,t.indexEndValue_=this.indexEndValue_,t.endNameSet_=this.endNameSet_,t.indexEndName_=this.indexEndName_,t.index_=this.index_,t.viewFrom_=this.viewFrom_,t}}function vr(n){const t={};if(n.isDefault())return t;let e;if(n.index_===x?e="$priority":n.index_===nn?e="$value":n.index_===Q?e="$key":(_(n.index_ instanceof tn,"Unrecognized index type!"),e=n.index_.toString()),t.orderBy=L(e),n.startSet_){const i=n.startAfterSet_?"startAfter":"startAt";t[i]=L(n.indexStartValue_),n.startNameSet_&&(t[i]+=","+L(n.indexStartName_))}if(n.endSet_){const i=n.endBeforeSet_?"endBefore":"endAt";t[i]=L(n.indexEndValue_),n.endNameSet_&&(t[i]+=","+L(n.indexEndName_))}return n.limitSet_&&(n.isViewFromLeft()?t.limitToFirst=n.limit_:t.limitToLast=n.limit_),t}function Cr(n){const t={};if(n.startSet_&&(t.sp=n.indexStartValue_,n.startNameSet_&&(t.sn=n.indexStartName_),t.sin=!n.startAfterSet_),n.endSet_&&(t.ep=n.indexEndValue_,n.endNameSet_&&(t.en=n.indexEndName_),t.ein=!n.endBeforeSet_),n.limitSet_){t.l=n.limit_;let e=n.viewFrom_;""===e&&(e=n.isViewFromLeft()?"l":"r"),t.vf=e}return n.index_!==x&&(t.i=n.index_.toString()),t}class z0 extends rr{constructor(t,e,i,r){super(),this.repoInfo_=t,this.onDataUpdate_=e,this.authTokenProvider_=i,this.appCheckTokenProvider_=r,this.log_=n0("p:rest:"),this.listens_={}}reportStats(t){throw new Error("Method not implemented.")}static getListenId_(t,e){return void 0!==e?"tag$"+e:(_(t._queryParams.isDefault(),"should have a tag if it's not a default query."),t._path.toString())}listen(t,e,i,r){const s=t._path.toString();this.log_("Listen called for "+s+" "+t._queryIdentifier);const a=z0.getListenId_(t,i),l={};this.listens_[a]=l;const c=vr(t._queryParams);this.restRequest_(s+".json",c,(d,h)=>{let u=h;if(404===d&&(u=null,d=null),null===d&&this.onDataUpdate_(s,u,!1,i),Le(this.listens_,a)===l){let f;f=d?401===d?"permission_denied":"rest_error:"+d:"ok",r(f,null)}})}unlisten(t,e){const i=z0.getListenId_(t,e);delete this.listens_[i]}get(t){const e=vr(t._queryParams),i=t._path.toString(),r=new Qe;return this.restRequest_(i+".json",e,(s,a)=>{let l=a;404===s&&(l=null,s=null),null===s?(this.onDataUpdate_(i,l,!1,null),r.resolve(l)):r.reject(new Error(l))}),r.promise}refreshAuthToken(t){}restRequest_(t,e={},i){return e.format="export",Promise.all([this.authTokenProvider_.getToken(!1),this.appCheckTokenProvider_.getToken(!1)]).then(([r,s])=>{r&&r.accessToken&&(e.auth=r.accessToken),s&&s.token&&(e.ac=s.token);const a=(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host+t+"?ns="+this.repoInfo_.namespace+function eo(n){const t=[];for(const[e,i]of Object.entries(n))Array.isArray(i)?i.forEach(r=>{t.push(encodeURIComponent(e)+"="+encodeURIComponent(r))}):t.push(encodeURIComponent(e)+"="+encodeURIComponent(i));return t.length?"&"+t.join("&"):""}(e);this.log_("Sending REST request for "+a);const l=new XMLHttpRequest;l.onreadystatechange=()=>{if(i&&4===l.readyState){this.log_("REST Response for "+a+" received. status:",l.status,"response:",l.responseText);let c=null;if(l.status>=200&&l.status<300){try{c=Je(l.responseText)}catch{k("Failed to parse JSON response for "+a+": "+l.responseText)}i(null,c)}else 401!==l.status&&404!==l.status&&k("Got unsuccessful REST response for "+a+" Status: "+l.status),i(l.status);i=null}},l.open("GET",a,!0),l.send()})}}class Ol{constructor(){this.rootNode_=y.EMPTY_NODE}getNode(t){return this.rootNode_.getChild(t)}updateSnapshot(t,e){this.rootNode_=this.rootNode_.updateChild(t,e)}}function j0(){return{value:null,children:new Map}}function Ze(n,t,e){if(C(t))n.value=e,n.children.clear();else if(null!==n.value)n.value=n.value.updateChild(t,e);else{const i=v(t);n.children.has(i)||n.children.set(i,j0()),Ze(n.children.get(i),t=b(t),e)}}function cn(n,t,e){null!==n.value?e(t,n.value):function Nl(n,t){n.children.forEach((e,i)=>{t(i,e)})}(n,(i,r)=>{cn(r,new I(t.toString()+"/"+i),e)})}class Rl{constructor(t){this.collection_=t,this.last_=null}get(){const t=this.collection_.get(),e=Object.assign({},t);return this.last_&&D(this.last_,(i,r)=>{e[i]=e[i]-r}),this.last_=t,e}}class Dl{constructor(t,e){this.server_=e,this.statsToReport_={},this.statsListener_=new Rl(t);const i=1e4+2e4*Math.random();s0(this.reportStats_.bind(this),Math.floor(i))}reportStats_(){const t=this.statsListener_.get(),e={};let i=!1;D(t,(r,s)=>{s>0&&te(this.statsToReport_,r)&&(e[r]=s,i=!0)}),i&&this.server_.reportStats(e),s0(this.reportStats_.bind(this),Math.floor(2*Math.random()*3e5))}}var $=function(n){return n[n.OVERWRITE=0]="OVERWRITE",n[n.MERGE=1]="MERGE",n[n.ACK_USER_WRITE=2]="ACK_USER_WRITE",n[n.LISTEN_COMPLETE=3]="LISTEN_COMPLETE",n}($||{});function hn(n){return{fromUser:!1,fromServer:!0,queryId:n,tagged:!0}}class Y0{constructor(t,e,i){this.path=t,this.affectedTree=e,this.revert=i,this.type=$.ACK_USER_WRITE,this.source={fromUser:!0,fromServer:!1,queryId:null,tagged:!1}}operationForChild(t){if(C(this.path)){if(null!=this.affectedTree.value)return _(this.affectedTree.children.isEmpty(),"affectedTree should not have overlapping affected paths."),this;{const e=this.affectedTree.subtree(new I(t));return new Y0(T(),e,this.revert)}}return _(v(this.path)===t,"operationForChild called for unrelated child."),new Y0(b(this.path),this.affectedTree,this.revert)}}class p0{constructor(t,e){this.source=t,this.path=e,this.type=$.LISTEN_COMPLETE}operationForChild(t){return C(this.path)?new p0(this.source,T()):new p0(this.source,b(this.path))}}class be{constructor(t,e,i){this.source=t,this.path=e,this.snap=i,this.type=$.OVERWRITE}operationForChild(t){return C(this.path)?new be(this.source,T(),this.snap.getImmediateChild(t)):new be(this.source,b(this.path),this.snap)}}class qe{constructor(t,e,i){this.source=t,this.path=e,this.children=i,this.type=$.MERGE}operationForChild(t){if(C(this.path)){const e=this.children.subtree(new I(t));return e.isEmpty()?null:e.value?new be(this.source,T(),e.value):new qe(this.source,T(),e)}return _(v(this.path)===t,"Can't get a merge for a child not on the path of the operation"),new qe(this.source,b(this.path),this.children)}toString(){return"Operation("+this.path+": "+this.source.toString()+" merge: "+this.children.toString()+")"}}class ce{constructor(t,e,i){this.node_=t,this.fullyInitialized_=e,this.filtered_=i}isFullyInitialized(){return this.fullyInitialized_}isFiltered(){return this.filtered_}isCompleteForPath(t){if(C(t))return this.isFullyInitialized()&&!this.filtered_;const e=v(t);return this.isCompleteForChild(e)}isCompleteForChild(t){return this.isFullyInitialized()&&!this.filtered_||this.node_.hasChild(t)}getNode(){return this.node_}}class kl{constructor(t){this.query_=t,this.index_=this.query_._queryParams.getIndex()}}function _0(n,t,e,i,r,s){const a=i.filter(l=>l.type===e);a.sort((l,c)=>function Ul(n,t,e){if(null==t.childName||null==e.childName)throw Re("Should only compare child_ events.");const i=new P(t.childName,t.snapshotNode),r=new P(e.childName,e.snapshotNode);return n.index_.compare(i,r)}(n,l,c)),a.forEach(l=>{const c=function Bl(n,t,e){return"value"===t.type||"child_removed"===t.type||(t.prevName=e.getPredecessorChildName(t.childName,t.snapshotNode,n.index_)),t}(n,l,s);r.forEach(d=>{d.respondsTo(l.type)&&t.push(d.createEvent(c,n.query_))})})}function Q0(n,t){return{eventCache:n,serverCache:t}}function m0(n,t,e,i){return Q0(new ce(t,e,i),n.serverCache)}function Er(n,t,e,i){return Q0(n.eventCache,new ce(t,e,i))}function $0(n){return n.eventCache.isFullyInitialized()?n.eventCache.getNode():null}function Se(n){return n.serverCache.isFullyInitialized()?n.serverCache.getNode():null}let fn;class A{constructor(t,e=(()=>(fn||(fn=new U(Ta)),fn))()){this.value=t,this.children=e}static fromObject(t){let e=new A(null);return D(t,(i,r)=>{e=e.set(new I(i),r)}),e}isEmpty(){return null===this.value&&this.children.isEmpty()}findRootMostMatchingPathAndValue(t,e){if(null!=this.value&&e(this.value))return{path:T(),value:this.value};if(C(t))return null;{const i=v(t),r=this.children.get(i);if(null!==r){const s=r.findRootMostMatchingPathAndValue(b(t),e);return null!=s?{path:O(new I(i),s.path),value:s.value}:null}return null}}findRootMostValueAndPath(t){return this.findRootMostMatchingPathAndValue(t,()=>!0)}subtree(t){if(C(t))return this;{const e=v(t),i=this.children.get(e);return null!==i?i.subtree(b(t)):new A(null)}}set(t,e){if(C(t))return new A(e,this.children);{const i=v(t),s=(this.children.get(i)||new A(null)).set(b(t),e),a=this.children.insert(i,s);return new A(this.value,a)}}remove(t){if(C(t))return this.children.isEmpty()?new A(null):new A(null,this.children);{const e=v(t),i=this.children.get(e);if(i){const r=i.remove(b(t));let s;return s=r.isEmpty()?this.children.remove(e):this.children.insert(e,r),null===this.value&&s.isEmpty()?new A(null):new A(this.value,s)}return this}}get(t){if(C(t))return this.value;{const e=v(t),i=this.children.get(e);return i?i.get(b(t)):null}}setTree(t,e){if(C(t))return e;{const i=v(t),s=(this.children.get(i)||new A(null)).setTree(b(t),e);let a;return a=s.isEmpty()?this.children.remove(i):this.children.insert(i,s),new A(this.value,a)}}fold(t){return this.fold_(T(),t)}fold_(t,e){const i={};return this.children.inorderTraversal((r,s)=>{i[r]=s.fold_(O(t,r),e)}),e(t,this.value,i)}findOnPath(t,e){return this.findOnPath_(t,T(),e)}findOnPath_(t,e,i){const r=!!this.value&&i(e,this.value);if(r)return r;if(C(t))return null;{const s=v(t),a=this.children.get(s);return a?a.findOnPath_(b(t),O(e,s),i):null}}foreachOnPath(t,e){return this.foreachOnPath_(t,T(),e)}foreachOnPath_(t,e,i){if(C(t))return this;{this.value&&i(e,this.value);const r=v(t),s=this.children.get(r);return s?s.foreachOnPath_(b(t),O(e,r),i):new A(null)}}foreach(t){this.foreach_(T(),t)}foreach_(t,e){this.children.inorderTraversal((i,r)=>{r.foreach_(O(t,i),e)}),this.value&&e(t,this.value)}foreachChild(t){this.children.inorderTraversal((e,i)=>{i.value&&t(e,i.value)})}}class K{constructor(t){this.writeTree_=t}static empty(){return new K(new A(null))}}function g0(n,t,e){if(C(t))return new K(new A(e));{const i=n.writeTree_.findRootMostValueAndPath(t);if(null!=i){const r=i.path;let s=i.value;const a=B(r,t);return s=s.updateChild(a,e),new K(n.writeTree_.set(r,s))}{const r=new A(e),s=n.writeTree_.setTree(t,r);return new K(s)}}}function pn(n,t,e){let i=n;return D(e,(r,s)=>{i=g0(i,O(t,r),s)}),i}function Tr(n,t){if(C(t))return K.empty();{const e=n.writeTree_.setTree(t,new A(null));return new K(e)}}function _n(n,t){return null!=xe(n,t)}function xe(n,t){const e=n.writeTree_.findRootMostValueAndPath(t);return null!=e?n.writeTree_.get(e.path).getChild(B(e.path,t)):null}function Ir(n){const t=[],e=n.writeTree_.value;return null!=e?e.isLeafNode()||e.forEachChild(x,(i,r)=>{t.push(new P(i,r))}):n.writeTree_.children.inorderTraversal((i,r)=>{null!=r.value&&t.push(new P(i,r.value))}),t}function de(n,t){if(C(t))return n;{const e=xe(n,t);return new K(null!=e?new A(e):n.writeTree_.subtree(t))}}function mn(n){return n.writeTree_.isEmpty()}function Ve(n,t){return wr(T(),n.writeTree_,t)}function wr(n,t,e){if(null!=t.value)return e.updateChild(n,t.value);{let i=null;return t.children.inorderTraversal((r,s)=>{".priority"===r?(_(null!==s.value,"Priority writes must always be leaf nodes"),i=s.value):e=wr(O(n,r),s,e)}),!e.getChild(n).isEmpty()&&null!==i&&(e=e.updateChild(O(n,".priority"),i)),e}}function J0(n,t){return Or(t,n)}function Vl(n,t){if(n.snap)return Z(n.path,t);for(const e in n.children)if(n.children.hasOwnProperty(e)&&Z(O(n.path,e),t))return!0;return!1}function zl(n){return n.visible}function br(n,t,e){let i=K.empty();for(let r=0;r<n.length;++r){const s=n[r];if(t(s)){const a=s.path;let l;if(s.snap)Z(e,a)?(l=B(e,a),i=g0(i,l,s.snap)):Z(a,e)&&(l=B(a,e),i=g0(i,T(),s.snap.getChild(l)));else{if(!s.children)throw Re("WriteRecord should have .snap or .children");if(Z(e,a))l=B(e,a),i=pn(i,l,s.children);else if(Z(a,e))if(l=B(a,e),C(l))i=pn(i,T(),s.children);else{const c=Le(s.children,v(l));if(c){const d=c.getChild(b(l));i=g0(i,T(),d)}}}}}return i}function Sr(n,t,e,i,r){if(i||r){const s=de(n.visibleWrites,t);return!r&&mn(s)?e:r||null!=e||_n(s,T())?Ve(br(n.allWrites,function(d){return(d.visible||r)&&(!i||!~i.indexOf(d.writeId))&&(Z(d.path,t)||Z(t,d.path))},t),e||y.EMPTY_NODE):null}{const s=xe(n.visibleWrites,t);if(null!=s)return s;{const a=de(n.visibleWrites,t);return mn(a)?e:null!=e||_n(a,T())?Ve(a,e||y.EMPTY_NODE):null}}}function X0(n,t,e,i){return Sr(n.writeTree,n.treePath,t,e,i)}function gn(n,t){return function jl(n,t,e){let i=y.EMPTY_NODE;const r=xe(n.visibleWrites,t);if(r)return r.isLeafNode()||r.forEachChild(x,(s,a)=>{i=i.updateImmediateChild(s,a)}),i;if(e){const s=de(n.visibleWrites,t);return e.forEachChild(x,(a,l)=>{const c=Ve(de(s,new I(a)),l);i=i.updateImmediateChild(a,c)}),Ir(s).forEach(a=>{i=i.updateImmediateChild(a.name,a.node)}),i}return Ir(de(n.visibleWrites,t)).forEach(a=>{i=i.updateImmediateChild(a.name,a.node)}),i}(n.writeTree,n.treePath,t)}function xr(n,t,e,i){return function Yl(n,t,e,i,r){_(i||r,"Either existingEventSnap or existingServerSnap must exist");const s=O(t,e);if(_n(n.visibleWrites,s))return null;{const a=de(n.visibleWrites,s);return mn(a)?r.getChild(e):Ve(a,r.getChild(e))}}(n.writeTree,n.treePath,t,e,i)}function et(n,t){return function $l(n,t){return xe(n.visibleWrites,t)}(n.writeTree,O(n.treePath,t))}function yn(n,t,e){return function Ql(n,t,e,i){const r=O(t,e),s=xe(n.visibleWrites,r);return null!=s?s:i.isCompleteForChild(e)?Ve(de(n.visibleWrites,r),i.getNode().getImmediateChild(e)):null}(n.writeTree,n.treePath,t,e)}function Ar(n,t){return Or(O(n.treePath,t),n.writeTree)}function Or(n,t){return{treePath:n,writeTree:t}}class tc{constructor(){this.changeMap=new Map}trackChildChange(t){const e=t.type,i=t.childName;_("child_added"===e||"child_changed"===e||"child_removed"===e,"Only child changes supported for tracking"),_(".priority"!==i,"Only non-priority child changes can be tracked.");const r=this.changeMap.get(i);if(r){const s=r.type;if("child_added"===e&&"child_removed"===s)this.changeMap.set(i,h0(i,t.snapshotNode,r.snapshotNode));else if("child_removed"===e&&"child_added"===s)this.changeMap.delete(i);else if("child_removed"===e&&"child_changed"===s)this.changeMap.set(i,u0(i,r.oldSnap));else if("child_changed"===e&&"child_added"===s)this.changeMap.set(i,We(i,t.snapshotNode));else{if("child_changed"!==e||"child_changed"!==s)throw Re("Illegal combination of changes: "+t+" occurred after "+r);this.changeMap.set(i,h0(i,t.snapshotNode,r.oldSnap))}}else this.changeMap.set(i,t)}getChanges(){return Array.from(this.changeMap.values())}}const Nr=new class nc{getCompleteChild(t){return null}getChildAfterChild(t,e,i){return null}};class vn{constructor(t,e,i=null){this.writes_=t,this.viewCache_=e,this.optCompleteServerCache_=i}getCompleteChild(t){const e=this.viewCache_.eventCache;if(e.isCompleteForChild(t))return e.getNode().getImmediateChild(t);{const i=null!=this.optCompleteServerCache_?new ce(this.optCompleteServerCache_,!0,!1):this.viewCache_.serverCache;return yn(this.writes_,t,i)}}getChildAfterChild(t,e,i){const r=null!=this.optCompleteServerCache_?this.optCompleteServerCache_:Se(this.viewCache_),s=function ec(n,t,e,i,r,s){return function Jl(n,t,e,i,r,s,a){let l;const c=de(n.visibleWrites,t),d=xe(c,T());if(null!=d)l=d;else{if(null==e)return[];l=Ve(c,e)}if(l=l.withIndex(a),l.isEmpty()||l.isLeafNode())return[];{const h=[],u=a.getCompare(),f=s?l.getReverseIteratorFrom(i,a):l.getIteratorFrom(i,a);let p=f.getNext();for(;p&&h.length<r;)0!==u(p,i)&&h.push(p),p=f.getNext();return h}}(n.writeTree,n.treePath,t,e,i,r,s)}(this.writes_,r,e,1,i,t);return 0===s.length?null:s[0]}}function Rr(n,t,e,i,r,s){const a=t.eventCache;if(null!=et(i,e))return t;{let l,c;if(C(e))if(_(t.serverCache.isFullyInitialized(),"If change path is empty, we must have complete server data"),t.serverCache.isFiltered()){const d=Se(t),u=gn(i,d instanceof y?d:y.EMPTY_NODE);l=n.filter.updateFullNode(t.eventCache.getNode(),u,s)}else{const d=X0(i,Se(t));l=n.filter.updateFullNode(t.eventCache.getNode(),d,s)}else{const d=v(e);if(".priority"===d){_(1===le(e),"Can't have a priority with additional path components");const h=a.getNode();c=t.serverCache.getNode();const u=xr(i,e,h,c);l=null!=u?n.filter.updatePriority(h,u):a.getNode()}else{const h=b(e);let u;if(a.isCompleteForChild(d)){c=t.serverCache.getNode();const f=xr(i,e,a.getNode(),c);u=null!=f?a.getNode().getImmediateChild(d).updateChild(h,f):a.getNode().getImmediateChild(d)}else u=yn(i,d,t.serverCache);l=null!=u?n.filter.updateChild(a.getNode(),d,u,h,r,s):a.getNode()}}return m0(t,l,a.isFullyInitialized()||C(e),n.filter.filtersNodes())}}function tt(n,t,e,i,r,s,a,l){const c=t.serverCache;let d;const h=a?n.filter:n.filter.getIndexedFilter();if(C(e))d=h.updateFullNode(c.getNode(),i,null);else if(h.filtersNodes()&&!c.isFiltered()){const p=c.getNode().updateChild(e,i);d=h.updateFullNode(c.getNode(),p,null)}else{const p=v(e);if(!c.isCompleteForPath(e)&&le(e)>1)return t;const g=b(e),R=c.getNode().getImmediateChild(p).updateChild(g,i);d=".priority"===p?h.updatePriority(c.getNode(),R):h.updateChild(c.getNode(),p,R,g,Nr,null)}const u=Er(t,d,c.isFullyInitialized()||C(e),h.filtersNodes());return Rr(n,u,e,r,new vn(r,u,s),l)}function Cn(n,t,e,i,r,s,a){const l=t.eventCache;let c,d;const h=new vn(r,t,s);if(C(e))d=n.filter.updateFullNode(t.eventCache.getNode(),i,a),c=m0(t,d,!0,n.filter.filtersNodes());else{const u=v(e);if(".priority"===u)d=n.filter.updatePriority(t.eventCache.getNode(),i),c=m0(t,d,l.isFullyInitialized(),l.isFiltered());else{const f=b(e),p=l.getNode().getImmediateChild(u);let g;if(C(f))g=i;else{const E=h.getCompleteChild(u);g=null!=E?".priority"===Yt(f)&&E.getChild(lr(f)).isEmpty()?E:E.updateChild(f,i):y.EMPTY_NODE}c=p.equals(g)?t:m0(t,n.filter.updateChild(l.getNode(),u,g,f,h,a),l.isFullyInitialized(),n.filter.filtersNodes())}}return c}function Lr(n,t){return n.eventCache.isCompleteForChild(t)}function Mr(n,t,e){return e.foreach((i,r)=>{t=t.updateChild(i,r)}),t}function Pn(n,t,e,i,r,s,a,l){if(t.serverCache.getNode().isEmpty()&&!t.serverCache.isFullyInitialized())return t;let d,c=t;d=C(e)?i:new A(null).setTree(e,i);const h=t.serverCache.getNode();return d.children.inorderTraversal((u,f)=>{if(h.hasChild(u)){const g=Mr(0,t.serverCache.getNode().getImmediateChild(u),f);c=tt(n,c,new I(u),g,r,s,a,l)}}),d.children.inorderTraversal((u,f)=>{const p=!t.serverCache.isCompleteForChild(u)&&null===f.value;if(!h.hasChild(u)&&!p){const E=Mr(0,t.serverCache.getNode().getImmediateChild(u),f);c=tt(n,c,new I(u),E,r,s,a,l)}}),c}class uc{constructor(t,e){this.query_=t,this.eventRegistrations_=[];const i=this.query_._queryParams,r=new rn(i.getIndex()),s=function wl(n){return n.loadsAllData()?new rn(n.getIndex()):n.hasLimit()?new Il(n):new f0(n)}(i);this.processor_=function ic(n){return{filter:n}}(s);const a=e.serverCache,l=e.eventCache,c=r.updateFullNode(y.EMPTY_NODE,a.getNode(),null),d=s.updateFullNode(y.EMPTY_NODE,l.getNode(),null),h=new ce(c,a.isFullyInitialized(),r.filtersNodes()),u=new ce(d,l.isFullyInitialized(),s.filtersNodes());this.viewCache_=Q0(u,h),this.eventGenerator_=new kl(this.query_)}get query(){return this.query_}}function pc(n,t){const e=Se(n.viewCache_);return e&&(n.query._queryParams.loadsAllData()||!C(t)&&!e.getImmediateChild(v(t)).isEmpty())?e.getChild(t):null}function Dr(n){return 0===n.eventRegistrations_.length}function kr(n,t,e){const i=[];if(e){_(null==t,"A cancel should cancel all event registrations.");const r=n.query._path;n.eventRegistrations_.forEach(s=>{const a=s.createCancelEvent(e,r);a&&i.push(a)})}if(t){let r=[];for(let s=0;s<n.eventRegistrations_.length;++s){const a=n.eventRegistrations_[s];if(a.matches(t)){if(t.hasAnyCallback()){r=r.concat(n.eventRegistrations_.slice(s+1));break}}else r.push(a)}n.eventRegistrations_=r}else n.eventRegistrations_=[];return i}function Fr(n,t,e,i){t.type===$.MERGE&&null!==t.source.queryId&&(_(Se(n.viewCache_),"We should always have a full cache before handling merges"),_($0(n.viewCache_),"Missing event cache, even though we have a server cache"));const r=n.viewCache_,s=function sc(n,t,e,i,r){const s=new tc;let a,l;if(e.type===$.OVERWRITE){const d=e;d.source.fromUser?a=Cn(n,t,d.path,d.snap,i,r,s):(_(d.source.fromServer,"Unknown source."),l=d.source.tagged||t.serverCache.isFiltered()&&!C(d.path),a=tt(n,t,d.path,d.snap,i,r,l,s))}else if(e.type===$.MERGE){const d=e;d.source.fromUser?a=function ac(n,t,e,i,r,s,a){let l=t;return i.foreach((c,d)=>{const h=O(e,c);Lr(t,v(h))&&(l=Cn(n,l,h,d,r,s,a))}),i.foreach((c,d)=>{const h=O(e,c);Lr(t,v(h))||(l=Cn(n,l,h,d,r,s,a))}),l}(n,t,d.path,d.children,i,r,s):(_(d.source.fromServer,"Unknown source."),l=d.source.tagged||t.serverCache.isFiltered(),a=Pn(n,t,d.path,d.children,i,r,l,s))}else if(e.type===$.ACK_USER_WRITE){const d=e;a=d.revert?function dc(n,t,e,i,r,s){let a;if(null!=et(i,e))return t;{const l=new vn(i,t,r),c=t.eventCache.getNode();let d;if(C(e)||".priority"===v(e)){let h;if(t.serverCache.isFullyInitialized())h=X0(i,Se(t));else{const u=t.serverCache.getNode();_(u instanceof y,"serverChildren would be complete if leaf node"),h=gn(i,u)}d=n.filter.updateFullNode(c,h,s)}else{const h=v(e);let u=yn(i,h,t.serverCache);null==u&&t.serverCache.isCompleteForChild(h)&&(u=c.getImmediateChild(h)),d=null!=u?n.filter.updateChild(c,h,u,b(e),l,s):t.eventCache.getNode().hasChild(h)?n.filter.updateChild(c,h,y.EMPTY_NODE,b(e),l,s):c,d.isEmpty()&&t.serverCache.isFullyInitialized()&&(a=X0(i,Se(t)),a.isLeafNode()&&(d=n.filter.updateFullNode(d,a,s)))}return a=t.serverCache.isFullyInitialized()||null!=et(i,T()),m0(t,d,a,n.filter.filtersNodes())}}(n,t,d.path,i,r,s):function lc(n,t,e,i,r,s,a){if(null!=et(r,e))return t;const l=t.serverCache.isFiltered(),c=t.serverCache;if(null!=i.value){if(C(e)&&c.isFullyInitialized()||c.isCompleteForPath(e))return tt(n,t,e,c.getNode().getChild(e),r,s,l,a);if(C(e)){let d=new A(null);return c.getNode().forEachChild(Q,(h,u)=>{d=d.set(new I(h),u)}),Pn(n,t,e,d,r,s,l,a)}return t}{let d=new A(null);return i.foreach((h,u)=>{const f=O(e,h);c.isCompleteForPath(f)&&(d=d.set(h,c.getNode().getChild(f)))}),Pn(n,t,e,d,r,s,l,a)}}(n,t,d.path,d.affectedTree,i,r,s)}else{if(e.type!==$.LISTEN_COMPLETE)throw Re("Unknown operation type: "+e.type);a=function cc(n,t,e,i,r){const s=t.serverCache;return Rr(n,Er(t,s.getNode(),s.isFullyInitialized()||C(e),s.isFiltered()),e,i,Nr,r)}(n,t,e.path,i,s)}const c=s.getChanges();return function oc(n,t,e){const i=t.eventCache;if(i.isFullyInitialized()){const r=i.getNode().isLeafNode()||i.getNode().isEmpty(),s=$0(n);(e.length>0||!n.eventCache.isFullyInitialized()||r&&!i.getNode().equals(s)||!i.getNode().getPriority().equals(s.getPriority()))&&e.push(yr($0(t)))}}(t,a,c),{viewCache:a,changes:c}}(n.processor_,r,t,e,i);return function rc(n,t){_(t.eventCache.getNode().isIndexed(n.filter.getIndex()),"Event snap not indexed"),_(t.serverCache.getNode().isIndexed(n.filter.getIndex()),"Server snap not indexed")}(n.processor_,s.viewCache),_(s.viewCache.serverCache.isFullyInitialized()||!r.serverCache.isFullyInitialized(),"Once a server snap is complete, it should never go back"),n.viewCache_=s.viewCache,Br(n,s.changes,s.viewCache.eventCache.getNode(),null)}function Br(n,t,e,i){return function Fl(n,t,e,i){const r=[],s=[];return t.forEach(a=>{"child_changed"===a.type&&n.index_.indexedValueChanged(a.oldSnap,a.snapshotNode)&&s.push(function Tl(n,t){return{type:"child_moved",snapshotNode:t,childName:n}}(a.childName,a.snapshotNode))}),_0(n,r,"child_removed",t,i,e),_0(n,r,"child_added",t,i,e),_0(n,r,"child_moved",s,i,e),_0(n,r,"child_changed",t,i,e),_0(n,r,"value",t,i,e),r}(n.eventGenerator_,t,e,i?[i]:n.eventRegistrations_)}let nt,rt;class Ur{constructor(){this.views=new Map}}function En(n,t,e,i){const r=t.source.queryId;if(null!==r){const s=n.views.get(r);return _(null!=s,"SyncTree gave us an op for an invalid query."),Fr(s,t,e,i)}{let s=[];for(const a of n.views.values())s=s.concat(Fr(a,t,e,i));return s}}function Hr(n,t,e,i,r){const a=n.views.get(t._queryIdentifier);if(!a){let l=X0(e,r?i:null),c=!1;l?c=!0:i instanceof y?(l=gn(e,i),c=!1):(l=y.EMPTY_NODE,c=!1);const d=Q0(new ce(l,c,!1),new ce(i,r,!1));return new uc(t,d)}return a}function Gr(n){const t=[];for(const e of n.views.values())e.query._queryParams.loadsAllData()||t.push(e);return t}function ue(n,t){let e=null;for(const i of n.views.values())e=e||pc(i,t);return e}function Wr(n,t){return t._queryParams.loadsAllData()?it(n):n.views.get(t._queryIdentifier)}function Zr(n,t){return null!=Wr(n,t)}function he(n){return null!=it(n)}function it(n){for(const t of n.views.values())if(t.query._queryParams.loadsAllData())return t;return null}let Ic=1;class qr{constructor(t){this.listenProvider_=t,this.syncPointTree_=new A(null),this.pendingWriteTree_=function Xl(){return{visibleWrites:K.empty(),allWrites:[],lastWriteId:-1}}(),this.tagToQueryMap=new Map,this.queryToTagMap=new Map}}function Tn(n,t,e,i,r){return function Gl(n,t,e,i,r){_(i>n.lastWriteId,"Stacking an older write on top of newer ones"),void 0===r&&(r=!0),n.allWrites.push({path:t,snap:e,writeId:i,visible:r}),r&&(n.visibleWrites=g0(n.visibleWrites,t,e)),n.lastWriteId=i}(n.pendingWriteTree_,t,e,i,r),r?Ke(n,new be({fromUser:!0,fromServer:!1,queryId:null,tagged:!1},t,e)):[]}function fe(n,t,e=!1){const i=function Zl(n,t){for(let e=0;e<n.allWrites.length;e++){const i=n.allWrites[e];if(i.writeId===t)return i}return null}(n.pendingWriteTree_,t);if(function ql(n,t){const e=n.allWrites.findIndex(l=>l.writeId===t);_(e>=0,"removeWrite called with nonexistent writeId.");const i=n.allWrites[e];n.allWrites.splice(e,1);let r=i.visible,s=!1,a=n.allWrites.length-1;for(;r&&a>=0;){const l=n.allWrites[a];l.visible&&(a>=e&&Vl(l,i.path)?r=!1:Z(i.path,l.path)&&(s=!0)),a--}return!!r&&(s?(function Kl(n){n.visibleWrites=br(n.allWrites,zl,T()),n.lastWriteId=n.allWrites.length>0?n.allWrites[n.allWrites.length-1].writeId:-1}(n),!0):(i.snap?n.visibleWrites=Tr(n.visibleWrites,i.path):D(i.children,c=>{n.visibleWrites=Tr(n.visibleWrites,O(i.path,c))}),!0))}(n.pendingWriteTree_,t)){let s=new A(null);return null!=i.snap?s=s.set(T(),!0):D(i.children,a=>{s=s.set(new I(a),!0)}),Ke(n,new Y0(i.path,s,e))}return[]}function y0(n,t,e){return Ke(n,new be({fromUser:!1,fromServer:!0,queryId:null,tagged:!1},t,e))}function st(n,t,e,i,r=!1){const s=t._path,a=n.syncPointTree_.get(s);let l=[];if(a&&("default"===t._queryIdentifier||Zr(a,t))){const c=function Pc(n,t,e,i){const r=t._queryIdentifier,s=[];let a=[];const l=he(n);if("default"===r)for(const[c,d]of n.views.entries())a=a.concat(kr(d,e,i)),Dr(d)&&(n.views.delete(c),d.query._queryParams.loadsAllData()||s.push(d.query));else{const c=n.views.get(r);c&&(a=a.concat(kr(c,e,i)),Dr(c)&&(n.views.delete(r),c.query._queryParams.loadsAllData()||s.push(c.query)))}return l&&!he(n)&&s.push(new(function yc(){return _(nt,"Reference.ts has not been loaded"),nt}())(t._repo,t._path)),{removed:s,events:a}}(a,t,e,i);(function vc(n){return 0===n.views.size})(a)&&(n.syncPointTree_=n.syncPointTree_.remove(s));const d=c.removed;if(l=c.events,!r){const h=-1!==d.findIndex(f=>f._queryParams.loadsAllData()),u=n.syncPointTree_.findOnPath(s,(f,p)=>he(p));if(h&&!u){const f=n.syncPointTree_.subtree(s);if(!f.isEmpty()){const p=function Nc(n){return n.fold((t,e,i)=>{if(e&&he(e))return[it(e)];{let r=[];return e&&(r=Gr(e)),D(i,(s,a)=>{r=r.concat(a)}),r}})}(f);for(let g=0;g<p.length;++g){const E=p[g],R=E.query,W=jr(n,E);n.listenProvider_.startListening(C0(R),v0(n,R),W.hashFn,W.onComplete)}}}!u&&d.length>0&&!i&&(h?n.listenProvider_.stopListening(C0(t),null):d.forEach(f=>{const p=n.queryToTagMap.get(at(f));n.listenProvider_.stopListening(C0(f),p)}))}!function Rc(n,t){for(let e=0;e<t.length;++e){const i=t[e];if(!i._queryParams.loadsAllData()){const r=at(i),s=n.queryToTagMap.get(r);n.queryToTagMap.delete(r),n.tagToQueryMap.delete(s)}}}(n,d)}return l}function Vr(n,t,e,i){const r=wn(n,i);if(null!=r){const s=bn(r),a=s.path,l=s.queryId,c=B(a,t);return Sn(n,a,new be(hn(l),c,e))}return[]}function In(n,t,e,i=!1){const r=t._path;let s=null,a=!1;n.syncPointTree_.foreachOnPath(r,(f,p)=>{const g=B(f,r);s=s||ue(p,g),a=a||he(p)});let c,l=n.syncPointTree_.get(r);l?(a=a||he(l),s=s||ue(l,T())):(l=new Ur,n.syncPointTree_=n.syncPointTree_.set(r,l)),null!=s?c=!0:(c=!1,s=y.EMPTY_NODE,n.syncPointTree_.subtree(r).foreachChild((p,g)=>{const E=ue(g,T());E&&(s=s.updateImmediateChild(p,E))}));const d=Zr(l,t);if(!d&&!t._queryParams.loadsAllData()){const f=at(t);_(!n.queryToTagMap.has(f),"View does not exist, but we have a tag");const p=function Lc(){return Ic++}();n.queryToTagMap.set(f,p),n.tagToQueryMap.set(p,f)}let u=function Cc(n,t,e,i,r,s){const a=Hr(n,t,i,r,s);return n.views.has(t._queryIdentifier)||n.views.set(t._queryIdentifier,a),function _c(n,t){n.eventRegistrations_.push(t)}(a,e),function mc(n,t){const e=n.viewCache_.eventCache,i=[];return e.getNode().isLeafNode()||e.getNode().forEachChild(x,(s,a)=>{i.push(We(s,a))}),e.isFullyInitialized()&&i.push(yr(e.getNode())),Br(n,i,e.getNode(),t)}(a,e)}(l,t,e,J0(n.pendingWriteTree_,r),s,c);if(!d&&!a&&!i){const f=Wr(l,t);u=u.concat(function Mc(n,t,e){const i=t._path,r=v0(n,t),s=jr(n,e),a=n.listenProvider_.startListening(C0(t),r,s.hashFn,s.onComplete),l=n.syncPointTree_.subtree(i);if(r)_(!he(l.value),"If we're adding a query, it shouldn't be shadowed");else{const c=l.fold((d,h,u)=>{if(!C(d)&&h&&he(h))return[it(h).query];{let f=[];return h&&(f=f.concat(Gr(h).map(p=>p.query))),D(u,(p,g)=>{f=f.concat(g)}),f}});for(let d=0;d<c.length;++d){const h=c[d];n.listenProvider_.stopListening(C0(h),v0(n,h))}}return a}(n,t,f))}return u}function ot(n,t,e){const r=n.pendingWriteTree_,s=n.syncPointTree_.findOnPath(t,(a,l)=>{const d=ue(l,B(a,t));if(d)return d});return Sr(r,t,s,e,!0)}function Ke(n,t){return Kr(t,n.syncPointTree_,null,J0(n.pendingWriteTree_,T()))}function Kr(n,t,e,i){if(C(n.path))return zr(n,t,e,i);{const r=t.get(T());null==e&&null!=r&&(e=ue(r,T()));let s=[];const a=v(n.path),l=n.operationForChild(a),c=t.children.get(a);if(c&&l){const d=e?e.getImmediateChild(a):null,h=Ar(i,a);s=s.concat(Kr(l,c,d,h))}return r&&(s=s.concat(En(r,n,i,e))),s}}function zr(n,t,e,i){const r=t.get(T());null==e&&null!=r&&(e=ue(r,T()));let s=[];return t.children.inorderTraversal((a,l)=>{const c=e?e.getImmediateChild(a):null,d=Ar(i,a),h=n.operationForChild(a);h&&(s=s.concat(zr(h,l,c,d)))}),r&&(s=s.concat(En(r,n,i,e))),s}function jr(n,t){const e=t.query,i=v0(n,e);return{hashFn:()=>(function hc(n){return n.viewCache_.serverCache.getNode()}(t)||y.EMPTY_NODE).hash(),onComplete:r=>{if("ok"===r)return i?function xc(n,t,e){const i=wn(n,e);if(i){const r=bn(i),s=r.path,a=r.queryId,l=B(s,t);return Sn(n,s,new p0(hn(a),l))}return[]}(n,e._path,i):function Sc(n,t){return Ke(n,new p0({fromUser:!1,fromServer:!0,queryId:null,tagged:!1},t))}(n,e._path);{const s=function ba(n,t){let e="Unknown Error";"too_big"===n?e="The data requested exceeds the maximum size that can be accessed with a single request.":"permission_denied"===n?e="Client doesn't have permission to access the desired data.":"unavailable"===n&&(e="The service is unavailable");const i=new Error(n+" at "+t._path.toString()+": "+e);return i.code=n.toUpperCase(),i}(r,e);return st(n,e,null,s)}}}}function v0(n,t){const e=at(t);return n.queryToTagMap.get(e)}function at(n){return n._path.toString()+"$"+n._queryIdentifier}function wn(n,t){return n.tagToQueryMap.get(t)}function bn(n){const t=n.indexOf("$");return _(-1!==t&&t<n.length-1,"Bad queryKey."),{queryId:n.substr(t+1),path:new I(n.substr(0,t))}}function Sn(n,t,e){const i=n.syncPointTree_.get(t);return _(i,"Missing sync point for query tag that we're tracking"),En(i,e,J0(n.pendingWriteTree_,t),null)}function C0(n){return n._queryParams.loadsAllData()&&!n._queryParams.isDefault()?new(function Tc(){return _(rt,"Reference.ts has not been loaded"),rt}())(n._repo,n._path):n}class xn{constructor(t){this.node_=t}getImmediateChild(t){const e=this.node_.getImmediateChild(t);return new xn(e)}node(){return this.node_}}class An{constructor(t,e){this.syncTree_=t,this.path_=e}getImmediateChild(t){const e=O(this.path_,t);return new An(this.syncTree_,e)}node(){return ot(this.syncTree_,this.path_)}}const Dc=function(n){return(n=n||{}).timestamp=n.timestamp||(new Date).getTime(),n},Yr=function(n,t,e){return n&&"object"==typeof n?(_(".sv"in n,"Unexpected leaf node or priority contents"),"string"==typeof n[".sv"]?kc(n[".sv"],t,e):"object"==typeof n[".sv"]?Fc(n[".sv"],t):void _(!1,"Unexpected server value: "+JSON.stringify(n,null,2))):n},kc=function(n,t,e){if("timestamp"===n)return e.timestamp;_(!1,"Unexpected server value: "+n)},Fc=function(n,t,e){n.hasOwnProperty("increment")||_(!1,"Unexpected server value: "+JSON.stringify(n,null,2));const i=n.increment;"number"!=typeof i&&_(!1,"Unexpected increment value: "+i);const r=t.node();if(_(null!==r&&typeof r<"u","Expected ChildrenNode.EMPTY_NODE for nulls"),!r.isLeafNode())return i;const a=r.getValue();return"number"!=typeof a?i:a+i},Qr=function(n,t,e,i){return Nn(t,new An(e,n),i)},On=function(n,t,e){return Nn(n,new xn(t),e)};function Nn(n,t,e){const i=n.getPriority().val(),r=Yr(i,t.getImmediateChild(".priority"),e);let s;if(n.isLeafNode()){const a=n,l=Yr(a.getValue(),t,e);return l!==a.getValue()||r!==a.getPriority().val()?new He(l,N(r)):n}{const a=n;return s=a,r!==a.getPriority().val()&&(s=s.updatePriority(new He(r))),a.forEachChild(x,(l,c)=>{const d=Nn(c,t.getImmediateChild(l),e);d!==c&&(s=s.updateImmediateChild(l,d))}),s}}class Rn{constructor(t="",e=null,i={children:{},childCount:0}){this.name=t,this.parent=e,this.node=i}}function lt(n,t){let e=t instanceof I?t:new I(t),i=n,r=v(e);for(;null!==r;){const s=Le(i.node.children,r)||{children:{},childCount:0};i=new Rn(r,i,s),e=b(e),r=v(e)}return i}function Ae(n){return n.node.value}function Ln(n,t){n.node.value=t,Mn(n)}function $r(n){return n.node.childCount>0}function ct(n,t){D(n.node.children,(e,i)=>{t(new Rn(e,n,i))})}function Jr(n,t,e,i){e&&!i&&t(n),ct(n,r=>{Jr(r,t,!0,i)}),e&&i&&t(n)}function P0(n){return new I(null===n.parent?n.name:P0(n.parent)+"/"+n.name)}function Mn(n){null!==n.parent&&function Hc(n,t,e){const i=function Bc(n){return void 0===Ae(n)&&!$r(n)}(e),r=te(n.node.children,t);i&&r?(delete n.node.children[t],n.node.childCount--,Mn(n)):!i&&!r&&(n.node.children[t]=e.node,n.node.childCount++,Mn(n))}(n.parent,n.name,n)}const Gc=/[\[\].#$\/\u0000-\u001F\u007F]/,Wc=/[\[\].#$\u0000-\u001F\u007F]/,Dn=10485760,dt=function(n){return"string"==typeof n&&0!==n.length&&!Gc.test(n)},Xr=function(n){return"string"==typeof n&&0!==n.length&&!Wc.test(n)},T0=function(n,t,e){const i=e instanceof I?new sl(e,n):e;if(void 0===t)throw new Error(n+"contains undefined "+Ie(i));if("function"==typeof t)throw new Error(n+"contains a function "+Ie(i)+" with contents = "+t.toString());if(B0(t))throw new Error(n+"contains "+t.toString()+" "+Ie(i));if("string"==typeof t&&t.length>Dn/3&&M0(t)>Dn)throw new Error(n+"contains a string greater than "+Dn+" utf8 bytes "+Ie(i)+" ('"+t.substring(0,50)+"...')");if(t&&"object"==typeof t){let r=!1,s=!1;if(D(t,(a,l)=>{if(".value"===a)r=!0;else if(".priority"!==a&&".sv"!==a&&(s=!0,!dt(a)))throw new Error(n+" contains an invalid key ("+a+") "+Ie(i)+'.  Keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]"');(function ol(n,t){n.parts_.length>0&&(n.byteLength_+=1),n.parts_.push(t),n.byteLength_+=M0(t),cr(n)})(i,a),T0(n,l,i),function al(n){const t=n.parts_.pop();n.byteLength_-=M0(t),n.parts_.length>0&&(n.byteLength_-=1)}(i)}),r&&s)throw new Error(n+' contains ".value" child '+Ie(i)+" in addition to actual children.")}},Fn=function(n,t,e,i){if(!(i&&void 0===e||Xr(e)))throw new Error(Me(n,t)+'was an invalid path = "'+e+'". Paths must be non-empty strings and can\'t contain ".", "#", "$", "[", or "]"')},Vc=function(n,t,e,i){e&&(e=e.replace(/^\/*\.info(\/|$)/,"/")),Fn(n,t,e,i)};class Kc{constructor(){this.eventLists_=[],this.recursionDepth_=0}}function ut(n,t){let e=null;for(let i=0;i<t.length;i++){const r=t[i],s=r.getPath();null!==e&&!Qt(s,e.path)&&(n.eventLists_.push(e),e=null),null===e&&(e={events:[],path:s}),e.events.push(r)}e&&n.eventLists_.push(e)}function H(n,t,e){ut(n,e),function is(n,t){n.recursionDepth_++;let e=!0;for(let i=0;i<n.eventLists_.length;i++){const r=n.eventLists_[i];r&&(t(r.path)?(zc(n.eventLists_[i]),n.eventLists_[i]=null):e=!1)}e&&(n.eventLists_=[]),n.recursionDepth_--}(n,i=>Z(i,t)||Z(t,i))}function zc(n){for(let t=0;t<n.events.length;t++){const e=n.events[t];if(null!==e){n.events[t]=null;const i=e.getEventRunner();Ee&&M("event: "+e.toString()),Be(i)}}}const jc=25;class Yc{constructor(t,e,i,r){this.repoInfo_=t,this.forceRestClient_=e,this.authTokenProvider_=i,this.appCheckProvider_=r,this.dataUpdateCount=0,this.statsListener_=null,this.eventQueue_=new Kc,this.nextWriteId_=1,this.interceptServerDataCallback_=null,this.onDisconnect_=j0(),this.transactionQueueTree_=new Rn,this.persistentConnection_=null,this.key=this.repoInfo_.toURLString()}toString(){return(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host}}function ss(n){const e=n.infoData_.getNode(new I(".info/serverTimeOffset")).val()||0;return(new Date).getTime()+e}function w0(n){return Dc({timestamp:ss(n)})}function os(n,t,e,i,r){n.dataUpdateCount++;const s=new I(t);e=n.interceptServerDataCallback_?n.interceptServerDataCallback_(t,e):e;let a=[];if(r)if(i){const c=L0(e,d=>N(d));a=function Ac(n,t,e,i){const r=wn(n,i);if(r){const s=bn(r),a=s.path,l=s.queryId,c=B(a,t),d=A.fromObject(e);return Sn(n,a,new qe(hn(l),c,d))}return[]}(n.serverSyncTree_,s,c,r)}else{const c=N(e);a=Vr(n.serverSyncTree_,s,c,r)}else if(i){const c=L0(e,d=>N(d));a=function bc(n,t,e){const i=A.fromObject(e);return Ke(n,new qe({fromUser:!1,fromServer:!0,queryId:null,tagged:!1},t,i))}(n.serverSyncTree_,s,c)}else{const c=N(e);a=y0(n.serverSyncTree_,s,c)}let l=s;a.length>0&&(l=je(n,s)),H(n.eventQueue_,l,a)}function as(n,t){Bn(n,"connected",t),!1===t&&function ed(n){ze(n,"onDisconnectEvents");const t=w0(n),e=j0();cn(n.onDisconnect_,T(),(r,s)=>{const a=Qr(r,s,n.serverSyncTree_,t);Ze(e,r,a)});let i=[];cn(e,T(),(r,s)=>{i=i.concat(y0(n.serverSyncTree_,r,s));const a=Wn(n,r);je(n,a)}),n.onDisconnect_=j0(),H(n.eventQueue_,T(),i)}(n)}function Bn(n,t,e){const i=new I("/.info/"+t),r=N(e);n.infoData_.updateSnapshot(i,r);const s=y0(n.infoSyncTree_,i,r);H(n.eventQueue_,i,s)}function ht(n){return n.nextWriteId_++}function Un(n,t,e,i,r){ze(n,"set",{path:t.toString(),value:e,priority:i});const s=w0(n),a=N(e,i),l=ot(n.serverSyncTree_,t),c=On(a,l,s),d=ht(n),h=Tn(n.serverSyncTree_,t,c,d,!0);ut(n.eventQueue_,h),n.server_.put(t.toString(),a.val(!0),(f,p)=>{const g="ok"===f;g||k("set at "+t+" failed: "+f);const E=fe(n.serverSyncTree_,d,!g);H(n.eventQueue_,t,E),function pe(n,t,e,i){t&&Be(()=>{if("ok"===e)t(null);else{const r=(e||"error").toUpperCase();let s=r;i&&(s+=": "+i);const a=new Error(s);a.code=r,t(a)}})}(0,r,f,p)});const u=Wn(n,t);je(n,u),H(n.eventQueue_,u,[])}function ze(n,...t){let e="";n.persistentConnection_&&(e=n.persistentConnection_.id+":"),M(e,...t)}function Gn(n,t,e){return ot(n.serverSyncTree_,t,e)||y.EMPTY_NODE}function ft(n,t=n.transactionQueueTree_){if(t||pt(n,t),Ae(t)){const e=us(n,t);_(e.length>0,"Sending zero length transaction queue"),e.every(r=>0===r.status)&&function ad(n,t,e){const i=e.map(d=>d.currentWriteId),r=Gn(n,t,i);let s=r;const a=r.hash();for(let d=0;d<e.length;d++){const h=e[d];_(0===h.status,"tryToSendTransactionQueue_: items in queue should all be run."),h.status=1,h.retryCount++;const u=B(t,h.path);s=s.updateChild(u,h.currentOutputSnapshotRaw)}const l=s.val(!0),c=t;n.server_.put(c.toString(),l,d=>{ze(n,"transaction put response",{path:c.toString(),status:d});let h=[];if("ok"===d){const u=[];for(let f=0;f<e.length;f++)e[f].status=2,h=h.concat(fe(n.serverSyncTree_,e[f].currentWriteId)),e[f].onComplete&&u.push(()=>e[f].onComplete(null,!0,e[f].currentOutputSnapshotResolved)),e[f].unwatcher();pt(n,lt(n.transactionQueueTree_,t)),ft(n,n.transactionQueueTree_),H(n.eventQueue_,t,h);for(let f=0;f<u.length;f++)Be(u[f])}else{if("datastale"===d)for(let u=0;u<e.length;u++)e[u].status=3===e[u].status?4:0;else{k("transaction at "+c.toString()+" failed: "+d);for(let u=0;u<e.length;u++)e[u].status=4,e[u].abortReason=d}je(n,t)}},a)}(n,P0(t),e)}else $r(t)&&ct(t,e=>{ft(n,e)})}function je(n,t){const e=ds(n,t),i=P0(e);return function ld(n,t,e){if(0===t.length)return;const i=[];let r=[];const a=t.filter(l=>0===l.status).map(l=>l.currentWriteId);for(let l=0;l<t.length;l++){const c=t[l],d=B(e,c.path);let u,h=!1;if(_(null!==d,"rerunTransactionsUnderNode_: relativePath should not be null."),4===c.status)h=!0,u=c.abortReason,r=r.concat(fe(n.serverSyncTree_,c.currentWriteId,!0));else if(0===c.status)if(c.retryCount>=jc)h=!0,u="maxretry",r=r.concat(fe(n.serverSyncTree_,c.currentWriteId,!0));else{const f=Gn(n,c.path,a);c.currentInputSnapshot=f;const p=t[l].update(f.val());if(void 0!==p){T0("transaction failed: Data returned ",p,c.path);let g=N(p);"object"==typeof p&&null!=p&&te(p,".priority")||(g=g.updatePriority(f.getPriority()));const R=c.currentWriteId,W=w0(n),vt=On(g,f,W);c.currentOutputSnapshotRaw=g,c.currentOutputSnapshotResolved=vt,c.currentWriteId=ht(n),a.splice(a.indexOf(R),1),r=r.concat(Tn(n.serverSyncTree_,c.path,vt,c.currentWriteId,c.applyLocally)),r=r.concat(fe(n.serverSyncTree_,R,!0))}else h=!0,u="nodata",r=r.concat(fe(n.serverSyncTree_,c.currentWriteId,!0))}H(n.eventQueue_,e,r),r=[],h&&(t[l].status=2,setTimeout(t[l].unwatcher,Math.floor(0)),t[l].onComplete&&i.push("nodata"===u?()=>t[l].onComplete(null,!1,t[l].currentInputSnapshot):()=>t[l].onComplete(new Error(u),!1,null)))}pt(n,n.transactionQueueTree_);for(let l=0;l<i.length;l++)Be(i[l]);ft(n,n.transactionQueueTree_)}(n,us(n,e),i),i}function ds(n,t){let e,i=n.transactionQueueTree_;for(e=v(t);null!==e&&void 0===Ae(i);)i=lt(i,e),e=v(t=b(t));return i}function us(n,t){const e=[];return hs(n,t,e),e.sort((i,r)=>i.order-r.order),e}function hs(n,t,e){const i=Ae(t);if(i)for(let r=0;r<i.length;r++)e.push(i[r]);ct(t,r=>{hs(n,r,e)})}function pt(n,t){const e=Ae(t);if(e){let i=0;for(let r=0;r<e.length;r++)2!==e[r].status&&(e[i]=e[r],i++);e.length=i,Ln(t,e.length>0?e:void 0)}ct(t,i=>{pt(n,i)})}function Wn(n,t){const e=P0(ds(n,t)),i=lt(n.transactionQueueTree_,t);return function Uc(n,t,e){let i=e?n:n.parent;for(;null!==i;){if(t(i))return!0;i=i.parent}}(i,r=>{Zn(n,r)}),Zn(n,i),Jr(i,r=>{Zn(n,r)}),e}function Zn(n,t){const e=Ae(t);if(e){const i=[];let r=[],s=-1;for(let a=0;a<e.length;a++)3===e[a].status||(1===e[a].status?(_(s===a-1,"All SENT items should be at beginning of queue."),s=a,e[a].status=3,e[a].abortReason="set"):(_(0===e[a].status,"Unexpected transaction status in abort"),e[a].unwatcher(),r=r.concat(fe(n.serverSyncTree_,e[a].currentWriteId,!0)),e[a].onComplete&&i.push(e[a].onComplete.bind(null,new Error("set"),!1,null))));-1===s?Ln(t,void 0):e.length=s+1,H(n.eventQueue_,P0(t),r);for(let a=0;a<i.length;a++)Be(i[a])}}const qn=function(n,t){const e=ud(n),i=e.namespace;return"firebase.com"===e.domain&&Y(e.host+" is no longer supported. Please use <YOUR FIREBASE>.firebaseio.com instead"),(!i||"undefined"===i)&&"localhost"!==e.domain&&Y("Cannot parse Firebase url. Please use https://<YOUR FIREBASE>.firebaseio.com"),e.secure||typeof window<"u"&&window.location&&window.location.protocol&&-1!==window.location.protocol.indexOf("https:")&&k("Insecure Firebase access from a secure page. Please use https in calls to new Firebase()."),{repoInfo:new Zt(e.host,e.secure,i,"ws"===e.scheme||"wss"===e.scheme,t,"",i!==e.subdomain),path:new I(e.pathString)}},ud=function(n){let t="",e="",i="",r="",s="",a=!0,l="https",c=443;if("string"==typeof n){let d=n.indexOf("//");d>=0&&(l=n.substring(0,d-1),n=n.substring(d+2));let h=n.indexOf("/");-1===h&&(h=n.length);let u=n.indexOf("?");-1===u&&(u=n.length),t=n.substring(0,Math.min(h,u)),h<u&&(r=function cd(n){let t="";const e=n.split("/");for(let i=0;i<e.length;i++)if(e[i].length>0){let r=e[i];try{r=decodeURIComponent(r.replace(/\+/g," "))}catch{}t+="/"+r}return t}(n.substring(h,u)));const f=function dd(n){const t={};"?"===n.charAt(0)&&(n=n.substring(1));for(const e of n.split("&")){if(0===e.length)continue;const i=e.split("=");2===i.length?t[decodeURIComponent(i[0])]=decodeURIComponent(i[1]):k(`Invalid query segment '${e}' in query '${n}'`)}return t}(n.substring(Math.min(n.length,u)));d=t.indexOf(":"),d>=0?(a="https"===l||"wss"===l,c=parseInt(t.substring(d+1),10)):d=t.length;const p=t.slice(0,d);if("localhost"===p.toLowerCase())e="localhost";else if(p.split(".").length<=2)e=p;else{const g=t.indexOf(".");i=t.substring(0,g).toLowerCase(),e=t.substring(g+1),s=i}"ns"in f&&(s=f.ns)}return{host:t,port:c,domain:e,subdomain:i,secure:a,scheme:l,pathString:r,namespace:s}};class ps{constructor(t,e,i,r){this.eventType=t,this.eventRegistration=e,this.snapshot=i,this.prevName=r}getPath(){const t=this.snapshot.ref;return"value"===this.eventType?t._path:t.parent._path}getEventType(){return this.eventType}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.getPath().toString()+":"+this.eventType+":"+L(this.snapshot.exportVal())}}class _s{constructor(t,e,i){this.eventRegistration=t,this.error=e,this.path=i}getPath(){return this.path}getEventType(){return"cancel"}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.path.toString()+":cancel"}}class Vn{constructor(t,e){this.snapshotCallback=t,this.cancelCallback=e}onValue(t,e){this.snapshotCallback.call(null,t,e)}onCancel(t){return _(this.hasCancelCallback,"Raising a cancel event on a listener with no cancel callback"),this.cancelCallback.call(null,t)}get hasCancelCallback(){return!!this.cancelCallback}matches(t){return this.snapshotCallback===t.snapshotCallback||void 0!==this.snapshotCallback.userCallback&&this.snapshotCallback.userCallback===t.snapshotCallback.userCallback&&this.snapshotCallback.context===t.snapshotCallback.context}}class G{constructor(t,e,i,r){this._repo=t,this._path=e,this._queryParams=i,this._orderByCalled=r}get key(){return C(this._path)?null:Yt(this._path)}get ref(){return new z(this._repo,this._path)}get _queryIdentifier(){const t=Cr(this._queryParams),e=Gt(t);return"{}"===e?"default":e}get _queryObject(){return Cr(this._queryParams)}isEqual(t){if(!((t=De(t))instanceof G))return!1;const e=this._repo===t._repo,i=Qt(this._path,t._path);return e&&i&&this._queryIdentifier===t._queryIdentifier}toJSON(){return this.toString()}toString(){return this._repo.toString()+function il(n){let t="";for(let e=n.pieceNum_;e<n.pieces_.length;e++)""!==n.pieces_[e]&&(t+="/"+encodeURIComponent(String(n.pieces_[e])));return t||"/"}(this._path)}}class z extends G{constructor(t,e){super(t,e,new sn,!1)}get parent(){const t=lr(this._path);return null===t?null:new z(this._repo,t)}get root(){let t=this;for(;null!==t.parent;)t=t.parent;return t}}class Oe{constructor(t,e,i){this._node=t,this.ref=e,this._index=i}get priority(){return this._node.getPriority().val()}get key(){return this.ref.key}get size(){return this._node.numChildren()}child(t){const e=new I(t),i=me(this.ref,t);return new Oe(this._node.getChild(e),i,x)}exists(){return!this._node.isEmpty()}exportVal(){return this._node.val(!0)}forEach(t){return!this._node.isLeafNode()&&!!this._node.forEachChild(this._index,(i,r)=>t(new Oe(r,me(this.ref,i),x)))}hasChild(t){const e=new I(t);return!this._node.getChild(e).isEmpty()}hasChildren(){return!this._node.isLeafNode()&&!this._node.isEmpty()}toJSON(){return this.exportVal()}val(){return this._node.val()}}function gt(n,t){return(n=De(n))._checkNotDeleted("ref"),void 0!==t?me(n._root,t):n._root}function me(n,t){return null===v((n=De(n))._path)?Vc("child","path",t,!1):Fn("child","path",t,!1),new z(n._repo,O(n._path,t))}function Kn(n,t){(function(n,t){if(".info"===v(t))throw new Error(n+" failed = Can't modify data under /.info/")})("set",(n=De(n))._path),function(n,t,e,i){i&&void 0===t||T0(Me(n,"value"),t,e)}("set",t,n._path,!1);const e=new Qe;return Un(n._repo,n._path,t,null,e.wrapCallback(()=>{})),e.promise}function ms(n){n=De(n);const t=new Vn(()=>{}),e=new b0(t);return function Jc(n,t,e){const i=function Oc(n,t){const e=t._path;let i=null;n.syncPointTree_.foreachOnPath(e,(d,h)=>{const u=B(d,e);i=i||ue(h,u)});let r=n.syncPointTree_.get(e);r?i=i||ue(r,T()):(r=new Ur,n.syncPointTree_=n.syncPointTree_.set(e,r));const s=null!=i,a=s?new ce(i,!0,!1):null;return function fc(n){return $0(n.viewCache_)}(Hr(r,t,J0(n.pendingWriteTree_,t._path),s?a.getNode():y.EMPTY_NODE,s))}(n.serverSyncTree_,t);return null!=i?Promise.resolve(i):n.server_.get(t).then(r=>{const s=N(r).withIndex(t._queryParams.getIndex());let a;if(In(n.serverSyncTree_,t,e,!0),t._queryParams.loadsAllData())a=y0(n.serverSyncTree_,t._path,s);else{const l=v0(n.serverSyncTree_,t);a=Vr(n.serverSyncTree_,t._path,s,l)}return H(n.eventQueue_,t._path,a),st(n.serverSyncTree_,t,e,null,!0),s},r=>(ze(n,"get for query "+L(t)+" failed: "+r),Promise.reject(new Error(r))))}(n._repo,n,e).then(i=>new Oe(i,new z(n._repo,n._path),n._queryParams.getIndex()))}class b0{constructor(t){this.callbackContext=t}respondsTo(t){return"value"===t}createEvent(t,e){const i=e._queryParams.getIndex();return new ps("value",this,new Oe(t.snapshotNode,new z(e._repo,e._path),i))}getEventRunner(t){return"cancel"===t.getEventType()?()=>this.callbackContext.onCancel(t.error):()=>this.callbackContext.onValue(t.snapshot,null)}createCancelEvent(t,e){return this.callbackContext.hasCancelCallback?new _s(this,t,e):null}matches(t){return t instanceof b0&&(!t.callbackContext||!this.callbackContext||t.callbackContext.matches(this.callbackContext))}hasAnyCallback(){return null!==this.callbackContext}}(function gc(n){_(!nt,"__referenceConstructor has already been defined"),nt=n})(z),function Ec(n){_(!rt,"__referenceConstructor has already been defined"),rt=n}(z);const zn={};function Cs(n,t,e,i,r){let s=i||n.options.databaseURL;void 0===s&&(n.options.projectId||Y("Can't determine Firebase Database URL. Be sure to include  a Project ID when calling firebase.initializeApp()."),M("Using default host for project ",n.options.projectId),s=`${n.options.projectId}-default-rtdb.firebaseio.com`);let c,d,a=qn(s,r),l=a.repoInfo;typeof process<"u"&&process.env&&(d=process.env.FIREBASE_DATABASE_EMULATOR_HOST),d?(c=!0,s=`http://${d}?ns=${l.namespace}`,a=qn(s,r),l=a.repoInfo):c=!a.repoInfo.secure;const h=r&&c?new o0(o0.OWNER):new Ra(n.name,n.options,t);(function(n,t){const e=t.path.toString();if("string"!=typeof t.repoInfo.host||0===t.repoInfo.host.length||!dt(t.repoInfo.namespace)&&"localhost"!==t.repoInfo.host.split(":")[0]||0!==e.length&&!function(n){return n&&(n=n.replace(/^\/*\.info(\/|$)/,"/")),Xr(n)}(e))throw new Error(Me(n,"url")+'must be a valid firebase URL and the path can\'t contain ".", "#", "$", "[", or "]".')})("Invalid Firebase Database URL",a),C(a.path)||Y("Database URL must point to the root of a Firebase Database (not including a child path).");const u=function Sd(n,t,e,i){let r=zn[t.name];r||(r={},zn[t.name]=r);let s=r[n.toURLString()];return s&&Y("Database initialized multiple times. Please make sure the format of the database URL matches with each database() call."),s=new Yc(n,false,e,i),r[n.toURLString()]=s,s}(l,n,h,new Na(n.name,e));return new Ad(u,n)}class Ad{constructor(t,e){this._repoInternal=t,this.app=e,this.type="database",this._instanceStarted=!1}get _repo(){return this._instanceStarted||(function Qc(n,t,e){if(n.stats_=Kt(n.repoInfo_),n.forceRestClient_||("object"==typeof window&&window.navigator&&window.navigator.userAgent||"").search(/googlebot|google webmaster tools|bingbot|yahoo! slurp|baiduspider|yandexbot|duckduckbot/i)>=0)n.server_=new z0(n.repoInfo_,(i,r,s,a)=>{os(n,i,r,s,a)},n.authTokenProvider_,n.appCheckProvider_),setTimeout(()=>as(n,!0),0);else{if(typeof e<"u"&&null!==e){if("object"!=typeof e)throw new Error("Only objects are supported for option databaseAuthVariableOverride");try{L(e)}catch(i){throw new Error("Invalid authOverride provided: "+i)}}n.persistentConnection_=new we(n.repoInfo_,t,(i,r,s,a)=>{os(n,i,r,s,a)},i=>{as(n,i)},i=>{!function $c(n,t){D(t,(e,i)=>{Bn(n,e,i)})}(n,i)},n.authTokenProvider_,n.appCheckProvider_,e),n.server_=n.persistentConnection_}n.authTokenProvider_.addTokenChangeListener(i=>{n.server_.refreshAuthToken(i)}),n.appCheckProvider_.addTokenChangeListener(i=>{n.server_.refreshAppCheckToken(i.token)}),n.statsReporter_=function Da(n,t){const e=n.toString();return Vt[e]||(Vt[e]=t()),Vt[e]}(n.repoInfo_,()=>new Dl(n.stats_,n.server_)),n.infoData_=new Ol,n.infoSyncTree_=new qr({startListening:(i,r,s,a)=>{let l=[];const c=n.infoData_.getNode(i._path);return c.isEmpty()||(l=y0(n.infoSyncTree_,i._path,c),setTimeout(()=>{a("ok")},0)),l},stopListening:()=>{}}),Bn(n,"connected",!1),n.serverSyncTree_=new qr({startListening:(i,r,s,a)=>(n.server_.listen(i,s,r,(l,c)=>{const d=a(l,c);H(n.eventQueue_,i._path,d)}),[]),stopListening:(i,r)=>{n.server_.unlisten(i,r)}})}(this._repoInternal,this.app.options.appId,this.app.options.databaseAuthVariableOverride),this._instanceStarted=!0),this._repoInternal}get _root(){return this._rootInternal||(this._rootInternal=new z(this._repo,T())),this._rootInternal}_delete(){return null!==this._rootInternal&&(function bd(n,t){const e=zn[t];(!e||e[n.key]!==n)&&Y(`Database ${t}(${n.repoInfo_}) has already been deleted.`),function cs(n){n.persistentConnection_&&n.persistentConnection_.interrupt("repo_interrupt")}(n),delete e[n.key]}(this._repo,this.app.name),this._repoInternal=null,this._rootInternal=null),Promise.resolve()}_checkNotDeleted(t){null===this._rootInternal&&Y("Cannot call "+t+" on a deleted database.")}}function jn(n=function aa(n=D0){const t=Ce.get(n);if(!t&&n===D0&&ri())return Lt();if(!t)throw ne.create("no-app",{appName:n});return t}(),t){const e=function gi(n,t){const e=n.container.getProvider("heartbeat").getImmediate({optional:!0});return e&&e.triggerHeartbeat(),n.container.getProvider(t)}(n,"database").getImmediate({identifier:t});if(!e._instanceStarted){const i=(n=>{const t=(n=>{var t,e;return null===(e=null===(t=O0())||void 0===t?void 0:t.emulatorHosts)||void 0===e?void 0:e[n]})(n);if(!t)return;const e=t.lastIndexOf(":");if(e<=0||e+1===t.length)throw new Error(`Invalid host ${t} with no separate hostname and port!`);const i=parseInt(t.substring(e+1),10);return"["===t[0]?[t.substring(1,e-1),i]:[t.substring(0,e),i]})("database");i&&function Od(n,t,e,i={}){(n=De(n))._checkNotDeleted("useEmulator"),n._instanceStarted&&Y("Cannot call useEmulator() after instance has already been initialized.");const r=n._repoInternal;let s;if(r.repoInfo_.nodeAdmin)i.mockUserToken&&Y('mockUserToken is not supported by the Admin SDK. For client access with mock users, please use the "firebase" package instead of "firebase-admin".'),s=new o0(o0.OWNER);else if(i.mockUserToken){const a="string"==typeof i.mockUserToken?i.mockUserToken:function qs(n,t){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const i=t||"demo-project",r=n.iat||0,s=n.sub||n.user_id;if(!s)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const a=Object.assign({iss:`https://securetoken.google.com/${i}`,aud:i,iat:r,exp:r+3600,auth_time:r,sub:s,user_id:s,firebase:{sign_in_provider:"custom",identities:{}}},n);return[A0(JSON.stringify({alg:"none",type:"JWT"})),A0(JSON.stringify(a)),""].join(".")}(i.mockUserToken,n.app.options.projectId);s=new o0(a)}!function wd(n,t,e,i){n.repoInfo_=new Zt(`${t}:${e}`,!1,n.repoInfo_.namespace,n.repoInfo_.webSocketOnly,n.repoInfo_.nodeAdmin,n.repoInfo_.persistenceKey,n.repoInfo_.includeNamespaceInQueryParams,!0),i&&(n.authTokenProvider_=i)}(r,t,e,s)}(e,...i)}return e}function x0(n){return(x0="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(n)}function m(n,t,e){return(t=function Dd(n){var t=function Md(n,t){if("object"!==x0(n)||null===n)return n;var e=n[Symbol.toPrimitive];if(void 0!==e){var i=e.call(n,t||"default");if("object"!==x0(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(n)}(n,"string");return"symbol"===x0(t)?t:String(t)}(t))in n?Object.defineProperty(n,t,{value:e,enumerable:!0,configurable:!0,writable:!0}):n[t]=e,n}we.prototype.simpleListen=function(n,t){this.sendRequest("q",{p:n},t)},we.prototype.echo=function(n,t){this.sendRequest("echo",{d:n},t)},function Nd(n){(function wi(n){Bt=n})("10.1.0"),F0(new Xe("database",(t,{instanceIdentifier:e})=>Cs(t.getProvider("app").getImmediate(),t.getProvider("auth-internal"),t.getProvider("app-check-internal"),e),"PUBLIC").setMultipleInstances(!0)),ke(Ti,"1.0.1",n),ke(Ti,"1.0.1","esm2017")}();let w=(()=>{class n{static addClass(e,i){e&&i&&(e.classList?e.classList.add(i):e.className+=" "+i)}static addMultipleClasses(e,i){if(e&&i)if(e.classList){let r=i.trim().split(" ");for(let s=0;s<r.length;s++)e.classList.add(r[s])}else{let r=i.split(" ");for(let s=0;s<r.length;s++)e.className+=" "+r[s]}}static removeClass(e,i){e&&i&&(e.classList?e.classList.remove(i):e.className=e.className.replace(new RegExp("(^|\\b)"+i.split(" ").join("|")+"(\\b|$)","gi")," "))}static hasClass(e,i){return!(!e||!i)&&(e.classList?e.classList.contains(i):new RegExp("(^| )"+i+"( |$)","gi").test(e.className))}static siblings(e){return Array.prototype.filter.call(e.parentNode.children,function(i){return i!==e})}static find(e,i){return Array.from(e.querySelectorAll(i))}static findSingle(e,i){return this.isElement(e)?e.querySelector(i):null}static index(e){let i=e.parentNode.childNodes,r=0;for(var s=0;s<i.length;s++){if(i[s]==e)return r;1==i[s].nodeType&&r++}return-1}static indexWithinGroup(e,i){let r=e.parentNode?e.parentNode.childNodes:[],s=0;for(var a=0;a<r.length;a++){if(r[a]==e)return s;r[a].attributes&&r[a].attributes[i]&&1==r[a].nodeType&&s++}return-1}static appendOverlay(e,i,r="self"){"self"!==r&&e&&i&&this.appendChild(e,i)}static alignOverlay(e,i,r="self",s=!0){e&&i&&(s&&(e.style.minWidth=`${n.getOuterWidth(i)}px`),"self"===r?this.relativePosition(e,i):this.absolutePosition(e,i))}static relativePosition(e,i){const r=W=>{if(W)return"relative"===getComputedStyle(W).getPropertyValue("position")?W:r(W.parentElement)},s=e.offsetParent?{width:e.offsetWidth,height:e.offsetHeight}:this.getHiddenElementDimensions(e),a=i.offsetHeight,l=i.getBoundingClientRect(),c=this.getWindowScrollTop(),d=this.getWindowScrollLeft(),h=this.getViewport(),f=r(e)?.getBoundingClientRect()||{top:-1*c,left:-1*d};let p,g;l.top+a+s.height>h.height?(p=l.top-f.top-s.height,e.style.transformOrigin="bottom",l.top+p<0&&(p=-1*l.top)):(p=a+l.top-f.top,e.style.transformOrigin="top");const E=l.left+s.width-h.width;g=s.width>h.width?-1*(l.left-f.left):E>0?l.left-f.left-E:l.left-f.left,e.style.top=p+"px",e.style.left=g+"px"}static absolutePosition(e,i){const r=e.offsetParent?{width:e.offsetWidth,height:e.offsetHeight}:this.getHiddenElementDimensions(e),s=r.height,a=r.width,l=i.offsetHeight,c=i.offsetWidth,d=i.getBoundingClientRect(),h=this.getWindowScrollTop(),u=this.getWindowScrollLeft(),f=this.getViewport();let p,g;d.top+l+s>f.height?(p=d.top+h-s,e.style.transformOrigin="bottom",p<0&&(p=h)):(p=l+d.top+h,e.style.transformOrigin="top"),g=d.left+a>f.width?Math.max(0,d.left+u+c-a):d.left+u,e.style.top=p+"px",e.style.left=g+"px"}static getParents(e,i=[]){return null===e.parentNode?i:this.getParents(e.parentNode,i.concat([e.parentNode]))}static getScrollableParents(e){let i=[];if(e){let r=this.getParents(e);const s=/(auto|scroll)/,a=l=>{let c=window.getComputedStyle(l,null);return s.test(c.getPropertyValue("overflow"))||s.test(c.getPropertyValue("overflowX"))||s.test(c.getPropertyValue("overflowY"))};for(let l of r){let c=1===l.nodeType&&l.dataset.scrollselectors;if(c){let d=c.split(",");for(let h of d){let u=this.findSingle(l,h);u&&a(u)&&i.push(u)}}9!==l.nodeType&&a(l)&&i.push(l)}}return i}static getHiddenElementOuterHeight(e){e.style.visibility="hidden",e.style.display="block";let i=e.offsetHeight;return e.style.display="none",e.style.visibility="visible",i}static getHiddenElementOuterWidth(e){e.style.visibility="hidden",e.style.display="block";let i=e.offsetWidth;return e.style.display="none",e.style.visibility="visible",i}static getHiddenElementDimensions(e){let i={};return e.style.visibility="hidden",e.style.display="block",i.width=e.offsetWidth,i.height=e.offsetHeight,e.style.display="none",e.style.visibility="visible",i}static scrollInView(e,i){let r=getComputedStyle(e).getPropertyValue("borderTopWidth"),s=r?parseFloat(r):0,a=getComputedStyle(e).getPropertyValue("paddingTop"),l=a?parseFloat(a):0,c=e.getBoundingClientRect(),h=i.getBoundingClientRect().top+document.body.scrollTop-(c.top+document.body.scrollTop)-s-l,u=e.scrollTop,f=e.clientHeight,p=this.getOuterHeight(i);h<0?e.scrollTop=u+h:h+p>f&&(e.scrollTop=u+h-f+p)}static fadeIn(e,i){e.style.opacity=0;let r=+new Date,s=0,a=function(){s=+e.style.opacity.replace(",",".")+((new Date).getTime()-r)/i,e.style.opacity=s,r=+new Date,+s<1&&(window.requestAnimationFrame&&requestAnimationFrame(a)||setTimeout(a,16))};a()}static fadeOut(e,i){var r=1,l=50/i;let c=setInterval(()=>{(r-=l)<=0&&(r=0,clearInterval(c)),e.style.opacity=r},50)}static getWindowScrollTop(){let e=document.documentElement;return(window.pageYOffset||e.scrollTop)-(e.clientTop||0)}static getWindowScrollLeft(){let e=document.documentElement;return(window.pageXOffset||e.scrollLeft)-(e.clientLeft||0)}static matches(e,i){var r=Element.prototype;return(r.matches||r.webkitMatchesSelector||r.mozMatchesSelector||r.msMatchesSelector||function(a){return-1!==[].indexOf.call(document.querySelectorAll(a),this)}).call(e,i)}static getOuterWidth(e,i){let r=e.offsetWidth;if(i){let s=getComputedStyle(e);r+=parseFloat(s.marginLeft)+parseFloat(s.marginRight)}return r}static getHorizontalPadding(e){let i=getComputedStyle(e);return parseFloat(i.paddingLeft)+parseFloat(i.paddingRight)}static getHorizontalMargin(e){let i=getComputedStyle(e);return parseFloat(i.marginLeft)+parseFloat(i.marginRight)}static innerWidth(e){let i=e.offsetWidth,r=getComputedStyle(e);return i+=parseFloat(r.paddingLeft)+parseFloat(r.paddingRight),i}static width(e){let i=e.offsetWidth,r=getComputedStyle(e);return i-=parseFloat(r.paddingLeft)+parseFloat(r.paddingRight),i}static getInnerHeight(e){let i=e.offsetHeight,r=getComputedStyle(e);return i+=parseFloat(r.paddingTop)+parseFloat(r.paddingBottom),i}static getOuterHeight(e,i){let r=e.offsetHeight;if(i){let s=getComputedStyle(e);r+=parseFloat(s.marginTop)+parseFloat(s.marginBottom)}return r}static getHeight(e){let i=e.offsetHeight,r=getComputedStyle(e);return i-=parseFloat(r.paddingTop)+parseFloat(r.paddingBottom)+parseFloat(r.borderTopWidth)+parseFloat(r.borderBottomWidth),i}static getWidth(e){let i=e.offsetWidth,r=getComputedStyle(e);return i-=parseFloat(r.paddingLeft)+parseFloat(r.paddingRight)+parseFloat(r.borderLeftWidth)+parseFloat(r.borderRightWidth),i}static getViewport(){let e=window,i=document,r=i.documentElement,s=i.getElementsByTagName("body")[0];return{width:e.innerWidth||r.clientWidth||s.clientWidth,height:e.innerHeight||r.clientHeight||s.clientHeight}}static getOffset(e){var i=e.getBoundingClientRect();return{top:i.top+(window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop||0),left:i.left+(window.pageXOffset||document.documentElement.scrollLeft||document.body.scrollLeft||0)}}static replaceElementWith(e,i){let r=e.parentNode;if(!r)throw"Can't replace element";return r.replaceChild(i,e)}static getUserAgent(){if(navigator&&this.isClient())return navigator.userAgent}static isIE(){var e=window.navigator.userAgent;return e.indexOf("MSIE ")>0||(e.indexOf("Trident/")>0?(e.indexOf("rv:"),!0):e.indexOf("Edge/")>0)}static isIOS(){return/iPad|iPhone|iPod/.test(navigator.userAgent)&&!window.MSStream}static isAndroid(){return/(android)/i.test(navigator.userAgent)}static isTouchDevice(){return"ontouchstart"in window||navigator.maxTouchPoints>0}static appendChild(e,i){if(this.isElement(i))i.appendChild(e);else{if(!(i&&i.el&&i.el.nativeElement))throw"Cannot append "+i+" to "+e;i.el.nativeElement.appendChild(e)}}static removeChild(e,i){if(this.isElement(i))i.removeChild(e);else{if(!i.el||!i.el.nativeElement)throw"Cannot remove "+e+" from "+i;i.el.nativeElement.removeChild(e)}}static removeElement(e){"remove"in Element.prototype?e.remove():e.parentNode.removeChild(e)}static isElement(e){return"object"==typeof HTMLElement?e instanceof HTMLElement:e&&"object"==typeof e&&null!==e&&1===e.nodeType&&"string"==typeof e.nodeName}static calculateScrollbarWidth(e){if(e){let i=getComputedStyle(e);return e.offsetWidth-e.clientWidth-parseFloat(i.borderLeftWidth)-parseFloat(i.borderRightWidth)}{if(null!==this.calculatedScrollbarWidth)return this.calculatedScrollbarWidth;let i=document.createElement("div");i.className="p-scrollbar-measure",document.body.appendChild(i);let r=i.offsetWidth-i.clientWidth;return document.body.removeChild(i),this.calculatedScrollbarWidth=r,r}}static calculateScrollbarHeight(){if(null!==this.calculatedScrollbarHeight)return this.calculatedScrollbarHeight;let e=document.createElement("div");e.className="p-scrollbar-measure",document.body.appendChild(e);let i=e.offsetHeight-e.clientHeight;return document.body.removeChild(e),this.calculatedScrollbarWidth=i,i}static invokeElementMethod(e,i,r){e[i].apply(e,r)}static clearSelection(){if(window.getSelection)window.getSelection().empty?window.getSelection().empty():window.getSelection().removeAllRanges&&window.getSelection().rangeCount>0&&window.getSelection().getRangeAt(0).getClientRects().length>0&&window.getSelection().removeAllRanges();else if(document.selection&&document.selection.empty)try{document.selection.empty()}catch{}}static getBrowser(){if(!this.browser){let e=this.resolveUserAgent();this.browser={},e.browser&&(this.browser[e.browser]=!0,this.browser.version=e.version),this.browser.chrome?this.browser.webkit=!0:this.browser.webkit&&(this.browser.safari=!0)}return this.browser}static resolveUserAgent(){let e=navigator.userAgent.toLowerCase(),i=/(chrome)[ \/]([\w.]+)/.exec(e)||/(webkit)[ \/]([\w.]+)/.exec(e)||/(opera)(?:.*version|)[ \/]([\w.]+)/.exec(e)||/(msie) ([\w.]+)/.exec(e)||e.indexOf("compatible")<0&&/(mozilla)(?:.*? rv:([\w.]+)|)/.exec(e)||[];return{browser:i[1]||"",version:i[2]||"0"}}static isInteger(e){return Number.isInteger?Number.isInteger(e):"number"==typeof e&&isFinite(e)&&Math.floor(e)===e}static isHidden(e){return!e||null===e.offsetParent}static isVisible(e){return e&&null!=e.offsetParent}static isExist(e){return null!==e&&typeof e<"u"&&e.nodeName&&e.parentNode}static focus(e,i){e&&document.activeElement!==e&&e.focus(i)}static getFocusableElements(e){let i=n.find(e,'button:not([tabindex = "-1"]):not([disabled]):not([style*="display:none"]):not([hidden]),\n                [href]:not([tabindex = "-1"]):not([disabled]):not([style*="display:none"]):not([hidden]),\n                input:not([tabindex = "-1"]):not([disabled]):not([style*="display:none"]):not([hidden]), select:not([tabindex = "-1"]):not([disabled]):not([style*="display:none"]):not([hidden]),\n                textarea:not([tabindex = "-1"]):not([disabled]):not([style*="display:none"]):not([hidden]), [tabIndex]:not([tabIndex = "-1"]):not([disabled]):not([style*="display:none"]):not([hidden]),\n                [contenteditable]:not([tabIndex = "-1"]):not([disabled]):not([style*="display:none"]):not([hidden]):not(.p-disabled)'),r=[];for(let s of i)(s.offsetWidth||s.offsetHeight||s.getClientRects().length)&&r.push(s);return r}static getNextFocusableElement(e,i=!1){const r=n.getFocusableElements(e);let s=0;if(r&&r.length>0){const a=r.indexOf(r[0].ownerDocument.activeElement);i?s=-1==a||0===a?r.length-1:a-1:-1!=a&&a!==r.length-1&&(s=a+1)}return r[s]}static generateZIndex(){return this.zindex=this.zindex||999,++this.zindex}static getSelection(){return window.getSelection?window.getSelection().toString():document.getSelection?document.getSelection().toString():document.selection?document.selection.createRange().text:null}static getTargetElement(e,i){if(!e)return null;switch(e){case"document":return document;case"window":return window;case"@next":return i?.nextElementSibling;case"@prev":return i?.previousElementSibling;case"@parent":return i?.parentElement;case"@grandparent":return i?.parentElement.parentElement;default:const r=typeof e;if("string"===r)return document.querySelector(e);if("object"===r&&e.hasOwnProperty("nativeElement"))return this.isExist(e.nativeElement)?e.nativeElement:void 0;const a=(l=e)&&l.constructor&&l.call&&l.apply?e():e;return a&&9===a.nodeType||this.isExist(a)?a:null}var l}static isClient(){return!!(typeof window<"u"&&window.document&&window.document.createElement)}static getAttribute(e,i){if(e){const r=e.getAttribute(i);return isNaN(r)?"true"===r||"false"===r?"true"===r:r:+r}}}return m(n,"zindex",1e3),m(n,"calculatedScrollbarWidth",null),m(n,"calculatedScrollbarHeight",null),m(n,"browser",void 0),n})();class kd{constructor(t,e=(()=>{})){m(this,"element",void 0),m(this,"listener",void 0),m(this,"scrollableParents",void 0),this.element=t,this.listener=e}bindScrollListener(){this.scrollableParents=w.getScrollableParents(this.element);for(let t=0;t<this.scrollableParents.length;t++)this.scrollableParents[t].addEventListener("scroll",this.listener)}unbindScrollListener(){if(this.scrollableParents)for(let t=0;t<this.scrollableParents.length;t++)this.scrollableParents[t].removeEventListener("scroll",this.listener)}destroy(){this.unbindScrollListener(),this.element=null,this.listener=null,this.scrollableParents=null}}var Yn=function Fd(){let n=[];const r=s=>s&&parseInt(s.style.zIndex,10)||0;return{get:r,set:(s,a,l)=>{a&&(a.style.zIndex=String(((s,a)=>{let l=n.length>0?n[n.length-1]:{key:s,value:a},c=l.value+(l.key===s?0:a)+1;return n.push({key:s,value:c}),c})(s,l)))},clear:s=>{s&&((s=>{n=n.filter(a=>a.value!==s)})(r(s)),s.style.zIndex="")},getCurrent:()=>n.length>0?n[n.length-1].value:0}}(),Bd=ge(8645);let F=(()=>{class n{}return m(n,"STARTS_WITH","startsWith"),m(n,"CONTAINS","contains"),m(n,"NOT_CONTAINS","notContains"),m(n,"ENDS_WITH","endsWith"),m(n,"EQUALS","equals"),m(n,"NOT_EQUALS","notEquals"),m(n,"IN","in"),m(n,"LESS_THAN","lt"),m(n,"LESS_THAN_OR_EQUAL_TO","lte"),m(n,"GREATER_THAN","gt"),m(n,"GREATER_THAN_OR_EQUAL_TO","gte"),m(n,"BETWEEN","between"),m(n,"IS","is"),m(n,"IS_NOT","isNot"),m(n,"BEFORE","before"),m(n,"AFTER","after"),m(n,"DATE_IS","dateIs"),m(n,"DATE_IS_NOT","dateIsNot"),m(n,"DATE_BEFORE","dateBefore"),m(n,"DATE_AFTER","dateAfter"),n})(),Hd=(()=>{var n;class t{constructor(){m(this,"ripple",!1),m(this,"overlayOptions",{}),m(this,"filterMatchModeOptions",{text:[F.STARTS_WITH,F.CONTAINS,F.NOT_CONTAINS,F.ENDS_WITH,F.EQUALS,F.NOT_EQUALS],numeric:[F.EQUALS,F.NOT_EQUALS,F.LESS_THAN,F.LESS_THAN_OR_EQUAL_TO,F.GREATER_THAN,F.GREATER_THAN_OR_EQUAL_TO],date:[F.DATE_IS,F.DATE_IS_NOT,F.DATE_BEFORE,F.DATE_AFTER]}),m(this,"translation",{startsWith:"Starts with",contains:"Contains",notContains:"Not contains",endsWith:"Ends with",equals:"Equals",notEquals:"Not equals",noFilter:"No Filter",lt:"Less than",lte:"Less than or equal to",gt:"Greater than",gte:"Greater than or equal to",is:"Is",isNot:"Is not",before:"Before",after:"After",dateIs:"Date is",dateIsNot:"Date is not",dateBefore:"Date is before",dateAfter:"Date is after",clear:"Clear",apply:"Apply",matchAll:"Match All",matchAny:"Match Any",addRule:"Add Rule",removeRule:"Remove Rule",accept:"Yes",reject:"No",choose:"Choose",upload:"Upload",cancel:"Cancel",pending:"Pending",dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],dayNamesMin:["Su","Mo","Tu","We","Th","Fr","Sa"],monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],monthNamesShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],chooseYear:"Choose Year",chooseMonth:"Choose Month",chooseDate:"Choose Date",prevDecade:"Previous Decade",nextDecade:"Next Decade",prevYear:"Previous Year",nextYear:"Next Year",prevMonth:"Previous Month",nextMonth:"Next Month",prevHour:"Previous Hour",nextHour:"Next Hour",prevMinute:"Previous Minute",nextMinute:"Next Minute",prevSecond:"Previous Second",nextSecond:"Next Second",am:"am",pm:"pm",dateFormat:"mm/dd/yy",firstDayOfWeek:0,today:"Today",weekHeader:"Wk",weak:"Weak",medium:"Medium",strong:"Strong",passwordPrompt:"Enter a password",emptyMessage:"No results found",searchMessage:"{0} results are available",selectionMessage:"{0} items selected",emptySelectionMessage:"No selected item",emptySearchMessage:"No results found",emptyFilterMessage:"No results found",aria:{trueLabel:"True",falseLabel:"False",nullLabel:"Not Selected",star:"1 star",stars:"{star} stars",selectAll:"All items selected",unselectAll:"All items unselected",close:"Close",previous:"Previous",next:"Next",navigation:"Navigation",scrollTop:"Scroll Top",moveTop:"Move Top",moveUp:"Move Up",moveDown:"Move Down",moveBottom:"Move Bottom",moveToTarget:"Move to Target",moveToSource:"Move to Source",moveAllToTarget:"Move All to Target",moveAllToSource:"Move All to Source",pageLabel:"{page}",firstPageLabel:"First Page",lastPageLabel:"Last Page",nextPageLabel:"Next Page",prevPageLabel:"Previous Page",rowsPerPageLabel:"Rows per page",previousPageLabel:"Previous Page",jumpToPageDropdownLabel:"Jump to Page Dropdown",jumpToPageInputLabel:"Jump to Page Input",selectRow:"Row Selected",unselectRow:"Row Unselected",expandRow:"Row Expanded",collapseRow:"Row Collapsed",showFilterMenu:"Show Filter Menu",hideFilterMenu:"Hide Filter Menu",filterOperator:"Filter Operator",filterConstraint:"Filter Constraint",editRow:"Row Edit",saveEdit:"Save Edit",cancelEdit:"Cancel Edit",listView:"List View",gridView:"Grid View",slide:"Slide",slideNumber:"{slideNumber}",zoomImage:"Zoom Image",zoomIn:"Zoom In",zoomOut:"Zoom Out",rotateRight:"Rotate Right",rotateLeft:"Rotate Left"}}),m(this,"zIndex",{modal:1100,overlay:1e3,menu:1e3,tooltip:1100}),m(this,"translationSource",new Bd.x),m(this,"translationObserver",this.translationSource.asObservable())}getTranslation(i){return this.translation[i]}setTranslation(i){this.translation={...this.translation,...i},this.translationSource.next(this.translation)}}return n=t,m(t,"\u0275fac",function(i){return new(i||n)}),m(t,"\u0275prov",o.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"})),t})(),Gd=(()=>{var n;class t{get disabled(){return this._disabled}set disabled(i){this._disabled=i,this.deactivate()}constructor(i,r,s,a,l,c){m(this,"platformId",void 0),m(this,"el",void 0),m(this,"zone",void 0),m(this,"config",void 0),m(this,"renderer",void 0),m(this,"changeDetector",void 0),m(this,"tooltipPosition",void 0),m(this,"tooltipEvent","hover"),m(this,"appendTo",void 0),m(this,"positionStyle",void 0),m(this,"tooltipStyleClass",void 0),m(this,"tooltipZIndex",void 0),m(this,"escape",!0),m(this,"showDelay",void 0),m(this,"hideDelay",void 0),m(this,"life",void 0),m(this,"positionTop",void 0),m(this,"positionLeft",void 0),m(this,"autoHide",!0),m(this,"fitContent",!0),m(this,"hideOnEscape",!0),m(this,"text",void 0),m(this,"tooltipOptions",void 0),m(this,"_tooltipOptions",{tooltipLabel:null,tooltipPosition:"right",tooltipEvent:"hover",appendTo:"body",positionStyle:null,tooltipStyleClass:null,tooltipZIndex:"auto",escape:!0,disabled:null,showDelay:null,hideDelay:null,positionTop:null,positionLeft:null,life:null,autoHide:!0,hideOnEscape:!0}),m(this,"_disabled",void 0),m(this,"container",void 0),m(this,"styleClass",void 0),m(this,"tooltipText",void 0),m(this,"showTimeout",void 0),m(this,"hideTimeout",void 0),m(this,"active",void 0),m(this,"mouseEnterListener",void 0),m(this,"mouseLeaveListener",void 0),m(this,"containerMouseleaveListener",void 0),m(this,"clickListener",void 0),m(this,"focusListener",void 0),m(this,"blurListener",void 0),m(this,"scrollHandler",void 0),m(this,"resizeListener",void 0),this.platformId=i,this.el=r,this.zone=s,this.config=a,this.renderer=l,this.changeDetector=c}ngAfterViewInit(){(0,j.NF)(this.platformId)&&this.zone.runOutsideAngular(()=>{if("hover"===this.getOption("tooltipEvent"))this.mouseEnterListener=this.onMouseEnter.bind(this),this.mouseLeaveListener=this.onMouseLeave.bind(this),this.clickListener=this.onInputClick.bind(this),this.el.nativeElement.addEventListener("mouseenter",this.mouseEnterListener),this.el.nativeElement.addEventListener("click",this.clickListener),this.el.nativeElement.addEventListener("mouseleave",this.mouseLeaveListener);else if("focus"===this.getOption("tooltipEvent")){this.focusListener=this.onFocus.bind(this),this.blurListener=this.onBlur.bind(this);let i=this.getTarget(this.el.nativeElement);i.addEventListener("focus",this.focusListener),i.addEventListener("blur",this.blurListener)}})}ngOnChanges(i){i.tooltipPosition&&this.setOption({tooltipPosition:i.tooltipPosition.currentValue}),i.tooltipEvent&&this.setOption({tooltipEvent:i.tooltipEvent.currentValue}),i.appendTo&&this.setOption({appendTo:i.appendTo.currentValue}),i.positionStyle&&this.setOption({positionStyle:i.positionStyle.currentValue}),i.tooltipStyleClass&&this.setOption({tooltipStyleClass:i.tooltipStyleClass.currentValue}),i.tooltipZIndex&&this.setOption({tooltipZIndex:i.tooltipZIndex.currentValue}),i.escape&&this.setOption({escape:i.escape.currentValue}),i.showDelay&&this.setOption({showDelay:i.showDelay.currentValue}),i.hideDelay&&this.setOption({hideDelay:i.hideDelay.currentValue}),i.life&&this.setOption({life:i.life.currentValue}),i.positionTop&&this.setOption({positionTop:i.positionTop.currentValue}),i.positionLeft&&this.setOption({positionLeft:i.positionLeft.currentValue}),i.disabled&&this.setOption({disabled:i.disabled.currentValue}),i.text&&(this.setOption({tooltipLabel:i.text.currentValue}),this.active&&(i.text.currentValue?this.container&&this.container.offsetParent?(this.updateText(),this.align()):this.show():this.hide())),i.autoHide&&this.setOption({autoHide:i.autoHide.currentValue}),i.tooltipOptions&&(this._tooltipOptions={...this._tooltipOptions,...i.tooltipOptions.currentValue},this.deactivate(),this.active&&(this.getOption("tooltipLabel")?this.container&&this.container.offsetParent?(this.updateText(),this.align()):this.show():this.hide()))}isAutoHide(){return this.getOption("autoHide")}onMouseEnter(i){!this.container&&!this.showTimeout&&this.activate()}onMouseLeave(i){(this.isAutoHide()||!(w.hasClass(i.target,"p-tooltip")||w.hasClass(i.target,"p-tooltip-arrow")||w.hasClass(i.target,"p-tooltip-text")||w.hasClass(i.relatedTarget,"p-tooltip")||w.hasClass(i.relatedTarget,"p-tooltip-text")||w.hasClass(i.relatedTarget,"p-tooltip-arrow")))&&this.deactivate()}onFocus(i){this.activate()}onBlur(i){this.deactivate()}onInputClick(i){this.deactivate()}onPressEscape(){this.hideOnEscape&&this.deactivate()}activate(){if(this.active=!0,this.clearHideTimeout(),this.getOption("showDelay")?this.showTimeout=setTimeout(()=>{this.show()},this.getOption("showDelay")):this.show(),this.getOption("life")){let i=this.getOption("showDelay")?this.getOption("life")+this.getOption("showDelay"):this.getOption("life");this.hideTimeout=setTimeout(()=>{this.hide()},i)}}deactivate(){this.active=!1,this.clearShowTimeout(),this.getOption("hideDelay")?(this.clearHideTimeout(),this.hideTimeout=setTimeout(()=>{this.hide()},this.getOption("hideDelay"))):this.hide()}create(){this.container&&(this.clearHideTimeout(),this.remove()),this.container=document.createElement("div");let i=document.createElement("div");i.className="p-tooltip-arrow",this.container.appendChild(i),this.tooltipText=document.createElement("div"),this.tooltipText.className="p-tooltip-text",this.updateText(),this.getOption("positionStyle")&&(this.container.style.position=this.getOption("positionStyle")),this.container.appendChild(this.tooltipText),"body"===this.getOption("appendTo")?document.body.appendChild(this.container):"target"===this.getOption("appendTo")?w.appendChild(this.container,this.el.nativeElement):w.appendChild(this.container,this.getOption("appendTo")),this.container.style.display="inline-block",this.fitContent&&(this.container.style.width="fit-content"),this.isAutoHide()||this.bindContainerMouseleaveListener()}bindContainerMouseleaveListener(){this.containerMouseleaveListener||(this.containerMouseleaveListener=this.renderer.listen(this.container??this.container.nativeElement,"mouseleave",r=>{this.deactivate()}))}unbindContainerMouseleaveListener(){this.containerMouseleaveListener&&(this.bindContainerMouseleaveListener(),this.containerMouseleaveListener=null)}show(){!this.getOption("tooltipLabel")||this.getOption("disabled")||(this.create(),this.align(),w.fadeIn(this.container,250),"auto"===this.getOption("tooltipZIndex")?Yn.set("tooltip",this.container,this.config.zIndex.tooltip):this.container.style.zIndex=this.getOption("tooltipZIndex"),this.bindDocumentResizeListener(),this.bindScrollListener())}hide(){"auto"===this.getOption("tooltipZIndex")&&Yn.clear(this.container),this.remove()}updateText(){this.getOption("escape")?(this.tooltipText.innerHTML="",this.tooltipText.appendChild(document.createTextNode(this.getOption("tooltipLabel")))):this.tooltipText.innerHTML=this.getOption("tooltipLabel")}align(){switch(this.getOption("tooltipPosition")){case"top":this.alignTop(),this.isOutOfBounds()&&(this.alignBottom(),this.isOutOfBounds()&&(this.alignRight(),this.isOutOfBounds()&&this.alignLeft()));break;case"bottom":this.alignBottom(),this.isOutOfBounds()&&(this.alignTop(),this.isOutOfBounds()&&(this.alignRight(),this.isOutOfBounds()&&this.alignLeft()));break;case"left":this.alignLeft(),this.isOutOfBounds()&&(this.alignRight(),this.isOutOfBounds()&&(this.alignTop(),this.isOutOfBounds()&&this.alignBottom()));break;case"right":this.alignRight(),this.isOutOfBounds()&&(this.alignLeft(),this.isOutOfBounds()&&(this.alignTop(),this.isOutOfBounds()&&this.alignBottom()))}}getHostOffset(){if("body"===this.getOption("appendTo")||"target"===this.getOption("appendTo")){let i=this.el.nativeElement.getBoundingClientRect();return{left:i.left+w.getWindowScrollLeft(),top:i.top+w.getWindowScrollTop()}}return{left:0,top:0}}alignRight(){this.preAlign("right");let i=this.getHostOffset(),r=i.left+w.getOuterWidth(this.el.nativeElement),s=i.top+(w.getOuterHeight(this.el.nativeElement)-w.getOuterHeight(this.container))/2;this.container.style.left=r+this.getOption("positionLeft")+"px",this.container.style.top=s+this.getOption("positionTop")+"px"}alignLeft(){this.preAlign("left");let i=this.getHostOffset(),r=i.left-w.getOuterWidth(this.container),s=i.top+(w.getOuterHeight(this.el.nativeElement)-w.getOuterHeight(this.container))/2;this.container.style.left=r+this.getOption("positionLeft")+"px",this.container.style.top=s+this.getOption("positionTop")+"px"}alignTop(){this.preAlign("top");let i=this.getHostOffset(),r=i.left+(w.getOuterWidth(this.el.nativeElement)-w.getOuterWidth(this.container))/2,s=i.top-w.getOuterHeight(this.container);this.container.style.left=r+this.getOption("positionLeft")+"px",this.container.style.top=s+this.getOption("positionTop")+"px"}alignBottom(){this.preAlign("bottom");let i=this.getHostOffset(),r=i.left+(w.getOuterWidth(this.el.nativeElement)-w.getOuterWidth(this.container))/2,s=i.top+w.getOuterHeight(this.el.nativeElement);this.container.style.left=r+this.getOption("positionLeft")+"px",this.container.style.top=s+this.getOption("positionTop")+"px"}setOption(i){this._tooltipOptions={...this._tooltipOptions,...i}}getOption(i){return this._tooltipOptions[i]}getTarget(i){return w.hasClass(i,"p-inputwrapper")?w.findSingle(i,"input"):i}preAlign(i){this.container.style.left="-999px",this.container.style.top="-999px";let r="p-tooltip p-component p-tooltip-"+i;this.container.className=this.getOption("tooltipStyleClass")?r+" "+this.getOption("tooltipStyleClass"):r}isOutOfBounds(){let i=this.container.getBoundingClientRect(),r=i.top,s=i.left,a=w.getOuterWidth(this.container),l=w.getOuterHeight(this.container),c=w.getViewport();return s+a>c.width||s<0||r<0||r+l>c.height}onWindowResize(i){this.hide()}bindDocumentResizeListener(){this.zone.runOutsideAngular(()=>{this.resizeListener=this.onWindowResize.bind(this),window.addEventListener("resize",this.resizeListener)})}unbindDocumentResizeListener(){this.resizeListener&&(window.removeEventListener("resize",this.resizeListener),this.resizeListener=null)}bindScrollListener(){this.scrollHandler||(this.scrollHandler=new kd(this.el.nativeElement,()=>{this.container&&this.hide()})),this.scrollHandler.bindScrollListener()}unbindScrollListener(){this.scrollHandler&&this.scrollHandler.unbindScrollListener()}unbindEvents(){if("hover"===this.getOption("tooltipEvent"))this.el.nativeElement.removeEventListener("mouseenter",this.mouseEnterListener),this.el.nativeElement.removeEventListener("mouseleave",this.mouseLeaveListener),this.el.nativeElement.removeEventListener("click",this.clickListener);else if("focus"===this.getOption("tooltipEvent")){let i=this.getTarget(this.el.nativeElement);i.removeEventListener("focus",this.focusListener),i.removeEventListener("blur",this.blurListener)}this.unbindDocumentResizeListener()}remove(){this.container&&this.container.parentElement&&("body"===this.getOption("appendTo")?document.body.removeChild(this.container):"target"===this.getOption("appendTo")?this.el.nativeElement.removeChild(this.container):w.removeChild(this.container,this.getOption("appendTo"))),this.unbindDocumentResizeListener(),this.unbindScrollListener(),this.unbindContainerMouseleaveListener(),this.clearTimeouts(),this.container=null,this.scrollHandler=null}clearShowTimeout(){this.showTimeout&&(clearTimeout(this.showTimeout),this.showTimeout=null)}clearHideTimeout(){this.hideTimeout&&(clearTimeout(this.hideTimeout),this.hideTimeout=null)}clearTimeouts(){this.clearShowTimeout(),this.clearHideTimeout()}ngOnDestroy(){this.unbindEvents(),this.container&&Yn.clear(this.container),this.remove(),this.scrollHandler&&(this.scrollHandler.destroy(),this.scrollHandler=null)}}return n=t,m(t,"\u0275fac",function(i){return new(i||n)(o.Y36(o.Lbi),o.Y36(o.SBq),o.Y36(o.R0b),o.Y36(Hd),o.Y36(o.Qsj),o.Y36(o.sBO))}),m(t,"\u0275dir",o.lG2({type:n,selectors:[["","pTooltip",""]],hostAttrs:[1,"p-element"],hostBindings:function(i,r){1&i&&o.NdJ("keydown.escape",function(a){return r.onPressEscape(a)},!1,o.evT)},inputs:{tooltipPosition:"tooltipPosition",tooltipEvent:"tooltipEvent",appendTo:"appendTo",positionStyle:"positionStyle",tooltipStyleClass:"tooltipStyleClass",tooltipZIndex:"tooltipZIndex",escape:"escape",showDelay:"showDelay",hideDelay:"hideDelay",life:"life",positionTop:"positionTop",positionLeft:"positionLeft",autoHide:"autoHide",fitContent:"fitContent",hideOnEscape:"hideOnEscape",text:["pTooltip","text"],disabled:["tooltipDisabled","disabled"],tooltipOptions:"tooltipOptions"},features:[o.TTD]})),t})(),Wd=(()=>{var n;class t{}return n=t,m(t,"\u0275fac",function(i){return new(i||n)}),m(t,"\u0275mod",o.oAB({type:n})),m(t,"\u0275inj",o.cJS({imports:[j.ez]})),t})();function Zd(n,t){if(1&n){const e=o.EpF();o.TgZ(0,"div",54),o.NdJ("click",function(){const s=o.CHM(e).index,a=o.oxw();return o.KtG(a.selectBuildMode(s))}),o._UZ(1,"i"),o.qZA()}if(2&n){const e=t.$implicit,i=t.index,r=o.oxw();o.Gre("tool-l tool-l-",r.buildMode==i," d-flex justify-content-center align-items-center"),o.s9C("pTooltip",e),o.xp6(1),o.Gre("tool-text-l pi ",r.buildMaterialIcon[i],"")}}function qd(n,t){if(1&n){const e=o.EpF();o.ynx(0),o.TgZ(1,"div",54),o.NdJ("click",function(){o.CHM(e);const r=o.oxw().index,s=o.oxw();return o.KtG(s.selectActionTool(r+7))}),o._UZ(2,"i"),o.qZA(),o.BQk()}if(2&n){const e=o.oxw(),i=e.index,r=e.$implicit,s=o.oxw();o.xp6(1),o.Gre("tool-l tool-l-",s.buildMode==i+7,"\n                                d-flex justify-content-center align-items-center"),o.s9C("pTooltip",r),o.xp6(1),o.Gre("tool-text-l pi ",s.actionToolIcon[i],"")}}function Vd(n,t){if(1&n){const e=o.EpF();o.ynx(0),o.TgZ(1,"div",54),o.NdJ("click",function(){o.CHM(e);const r=o.oxw().index,s=o.oxw();return o.KtG(s.selectActionTool(r+7))}),o._UZ(2,"i"),o.qZA(),o.BQk()}if(2&n){const e=o.oxw(),i=e.$implicit,r=e.index,s=o.oxw();o.xp6(1),o.Gre("tool-l tool-l-disable-",0==s.buildHistory.length,"\n                                d-flex justify-content-center align-items-center"),o.s9C("pTooltip",i),o.xp6(1),o.Gre("tool-text-l pi ",s.actionToolIcon[r],"")}}function Kd(n,t){if(1&n&&(o.ynx(0),o.YNc(1,qd,3,7,"ng-container",55),o.YNc(2,Vd,3,7,"ng-container",55),o.BQk()),2&n){const e=t.index;o.xp6(1),o.Q6J("ngIf",0==e),o.xp6(1),o.Q6J("ngIf",e>0)}}function zd(n,t){if(1&n&&(o.TgZ(0,"div",56),o._uU(1),o.qZA()),2&n){const e=o.oxw();o.xp6(1),o.hij(" ",e.lockCounter," ")}}function jd(n,t){if(1&n){const e=o.EpF();o.TgZ(0,"div",59),o.NdJ("click",function(){const s=o.CHM(e).index,a=o.oxw().index,l=o.oxw();return o.KtG(l.toggleCell(a,s))}),o.qZA()}if(2&n){const e=t.index,i=o.oxw().index;o.hYB("id","game_",i,"_",e,"")}}function Yd(n,t){if(1&n&&(o.TgZ(0,"div")(1,"div",57),o.YNc(2,jd,1,2,"div",58),o.qZA()()),2&n){const e=o.oxw();o.xp6(2),o.Q6J("ngForOf",e.counter(e.cols/2))}}function Qd(n,t){if(1&n){const e=o.EpF();o.TgZ(0,"i",62),o.NdJ("click",function(){o.CHM(e);const r=o.oxw(2);return o.KtG(r.unblockSection(1))}),o.qZA()}}function $d(n,t){if(1&n&&(o.TgZ(0,"div",60),o.YNc(1,Qd,1,0,"i",61),o.qZA()),2&n){const e=o.oxw();o.xp6(1),o.Q6J("ngIf",!e.player1buildComplete)}}function Jd(n,t){if(1&n){const e=o.EpF();o.TgZ(0,"div",64),o.NdJ("click",function(){const s=o.CHM(e).index,a=o.oxw().index,l=o.oxw();return o.KtG(l.toggleCell(a,s+l.cols/2))}),o.qZA()}if(2&n){const e=t.index,i=o.oxw().index,r=o.oxw();o.hYB("id","game_",i,"_",e+r.cols/2,"")}}function Xd(n,t){if(1&n&&(o.TgZ(0,"div")(1,"div",57),o.YNc(2,Jd,1,2,"div",63),o.qZA()()),2&n){const e=o.oxw();o.xp6(2),o.Q6J("ngForOf",e.counter(e.cols/2))}}function eu(n,t){if(1&n){const e=o.EpF();o.TgZ(0,"i",62),o.NdJ("click",function(){o.CHM(e);const r=o.oxw(2);return o.KtG(r.unblockSection(2))}),o.qZA()}}function tu(n,t){if(1&n&&(o.TgZ(0,"div",60),o.YNc(1,eu,1,0,"i",61),o.qZA()),2&n){const e=o.oxw();o.xp6(1),o.Q6J("ngIf",!e.player2buildComplete)}}function nu(n,t){if(1&n){const e=o.EpF();o.TgZ(0,"div",65),o.NdJ("click",function(){const s=o.CHM(e).index,a=o.oxw();return o.KtG(a.selectBuildMode(s))}),o._UZ(1,"i"),o.qZA()}if(2&n){const e=t.$implicit,i=t.index,r=o.oxw();o.Gre("tool-r tool-r-",r.buildMode==i," d-flex justify-content-center align-items-center"),o.s9C("pTooltip",e),o.xp6(1),o.Gre("tool-text-r pi ",r.buildMaterialIcon[i],"")}}function iu(n,t){if(1&n){const e=o.EpF();o.ynx(0),o.TgZ(1,"div",65),o.NdJ("click",function(){o.CHM(e);const r=o.oxw().index,s=o.oxw();return o.KtG(s.selectActionTool(r+7))}),o._UZ(2,"i"),o.qZA(),o.BQk()}if(2&n){const e=o.oxw(),i=e.index,r=e.$implicit,s=o.oxw();o.xp6(1),o.Gre("tool-r tool-r-",s.buildMode==i+7,"\n                                d-flex justify-content-center align-items-center"),o.s9C("pTooltip",r),o.xp6(1),o.Gre("tool-text-r pi ",s.actionToolIcon[i],"")}}function ru(n,t){if(1&n){const e=o.EpF();o.ynx(0),o.TgZ(1,"div",65),o.NdJ("click",function(){o.CHM(e);const r=o.oxw().index,s=o.oxw();return o.KtG(s.selectActionTool(r+7))}),o._UZ(2,"i"),o.qZA(),o.BQk()}if(2&n){const e=o.oxw(),i=e.$implicit,r=e.index,s=o.oxw();o.xp6(1),o.Gre("tool-r tool-r-disable-",0==s.buildHistory.length,"\n                                d-flex justify-content-center align-items-center"),o.s9C("pTooltip",i),o.xp6(1),o.Gre("tool-text-r pi ",s.actionToolIcon[r],"")}}function su(n,t){if(1&n&&(o.ynx(0),o.YNc(1,iu,3,7,"ng-container",55),o.YNc(2,ru,3,7,"ng-container",55),o.BQk()),2&n){const e=t.index;o.xp6(1),o.Q6J("ngIf",0==e),o.xp6(1),o.Q6J("ngIf",e>0)}}function ou(n,t){if(1&n&&(o.TgZ(0,"div",66),o._uU(1),o.qZA()),2&n){const e=o.oxw();o.xp6(1),o.hij(" ",e.lockCounter," ")}}function au(n,t){1&n&&(o.TgZ(0,"div"),o._uU(1," Draw "),o.qZA())}function lu(n,t){if(1&n&&(o.TgZ(0,"div")(1,"div"),o._uU(2," Winner "),o.qZA(),o.TgZ(3,"div"),o._uU(4),o.qZA()()),2&n){const e=o.oxw(2);o.xp6(4),o.Oqu(e.player1Name)}}function cu(n,t){if(1&n&&(o.TgZ(0,"div")(1,"div"),o._uU(2,"Winner"),o.qZA(),o.TgZ(3,"div"),o._uU(4),o.qZA()()),2&n){const e=o.oxw(2);o.xp6(4),o.Oqu(e.player2Name)}}function du(n,t){if(1&n){const e=o.EpF();o.TgZ(0,"div",67)(1,"div",68)(2,"div",69)(3,"div",70),o.YNc(4,au,2,0,"div",55),o.YNc(5,lu,5,1,"div",55),o.YNc(6,cu,5,1,"div",55),o.qZA(),o.TgZ(7,"div",71)(8,"div",69)(9,"div",72),o._uU(10),o.qZA(),o.TgZ(11,"div",20)(12,"div"),o._uU(13,"Score"),o.qZA(),o._UZ(14,"div",73),o.TgZ(15,"div"),o._uU(16),o.qZA()(),o.TgZ(17,"div",20)(18,"div"),o._uU(19,"Born"),o.qZA(),o._UZ(20,"div",73),o.TgZ(21,"div"),o._uU(22),o.qZA()(),o.TgZ(23,"div",20)(24,"div"),o._uU(25,"Death"),o.qZA(),o._UZ(26,"div",73),o.TgZ(27,"div"),o._uU(28),o.qZA()()(),o._UZ(29,"div",74),o.TgZ(30,"div",69)(31,"div",72),o._uU(32),o.qZA(),o.TgZ(33,"div",20)(34,"div"),o._uU(35,"Score"),o.qZA(),o._UZ(36,"div",73),o.TgZ(37,"div"),o._uU(38),o.qZA()(),o.TgZ(39,"div",20)(40,"div"),o._uU(41,"Born"),o.qZA(),o._UZ(42,"div",73),o.TgZ(43,"div"),o._uU(44),o.qZA()(),o.TgZ(45,"div",20)(46,"div"),o._uU(47,"Death"),o.qZA(),o._UZ(48,"div",73),o.TgZ(49,"div"),o._uU(50),o.qZA()()()(),o.TgZ(51,"div",75)(52,"div",76),o.NdJ("click",function(){o.CHM(e);const r=o.oxw();return o.KtG(r.navToPage())}),o._uU(53,"Leaderboard"),o.qZA(),o.TgZ(54,"div",76),o.NdJ("click",function(){o.CHM(e);const r=o.oxw();return r.resetGame(),o.KtG(r.initPage())}),o._uU(55,"Play Again"),o.qZA(),o.TgZ(56,"div",76),o.NdJ("click",function(){o.CHM(e);const r=o.oxw();return o.KtG(r.menuAction(3))}),o._uU(57,"Main Menu"),o.qZA()()()()()}if(2&n){const e=o.oxw();o.xp6(4),o.Q6J("ngIf",e.count1Display==e.count2Display),o.xp6(1),o.Q6J("ngIf",e.count1Display>e.count2Display),o.xp6(1),o.Q6J("ngIf",e.count1Display<e.count2Display),o.xp6(4),o.Oqu(e.player1Name),o.xp6(6),o.Oqu(e.count1Display),o.xp6(6),o.Oqu(e.born1),o.xp6(6),o.Oqu(e.death1),o.xp6(4),o.Oqu(e.player2Name),o.xp6(6),o.Oqu(e.count2Display),o.xp6(6),o.Oqu(e.born2),o.xp6(6),o.Oqu(e.death2)}}let uu=(()=>{var n;class t{constructor(i,r){this.router=i,this.gameService=r,this.buildMode=0,this.buildMaterial=[[[0,-1],[0,0],[0,1]],[[-1,0],[-1,1],[0,-1],[0,1],[1,1]],[[-1,1],[0,-1],[0,1],[1,0],[1,1]],[[0,0],[0,1],[1,0],[1,1]],[[-1,0],[0,-1],[0,1],[1,0]],[[-1,-2],[-1,1],[0,2],[1,-2],[1,2],[2,-1],[2,0],[2,1],[2,2]],[[-6,-4],[-6,-3],[-6,-2],[-6,2],[-6,3],[-6,4],[-4,-6],[-3,-6],[-2,-6],[-4,-1],[-3,-1],[-2,-1],[-4,1],[-3,1],[-2,1],[-4,6],[-3,6],[-2,6],[-1,-4],[-1,-3],[-1,-2],[-1,2],[-1,3],[-1,4],[1,-4],[1,-3],[1,-2],[1,2],[1,3],[1,4],[2,-6],[3,-6],[4,-6],[2,-1],[3,-1],[4,-1],[2,1],[3,1],[4,1],[2,6],[3,6],[4,6],[6,-4],[6,-3],[6,-2],[6,2],[6,3],[6,4]],[[0,0]]],this.actionTool=["Edit","Undo","Reset"],this.actionToolIcon=["pi-pencil","pi-undo","pi-times"],this.buildMaterialName=["Blinker","Glider Up","Glider Down","Farm","House","Spaceships","Castle"],this.buildMaterialIcon=["pi-eye","pi-send rotate","pi-send rotate-90","pi-table","pi-home","pi-share-alt","pi-shield"],this.count1Display=0,this.count2Display=0,this.born1=0,this.born2=0,this.death1=0,this.death2=0,this.rows=40,this.cols=90,this.game1Active=!0,this.game2Active=!0,this.generationCount=0,this.generationLimitDefault=500,this.generationLimit=this.generationLimitDefault,this.generationLimitUpgrade=500,this.controlButton=0,this.menuButton=["pi-play","pi-replay","pi-volume-up","pi-question-circle","pi-sign-out","1x"],this.gameSpeed={"0.5x":1e3,"1x":500,"2x":250,"5x":100},this.buildHistory=[],this.player1Lock=!1,this.player2Lock=!1,this.lockCounterDefault=60,this.lockCounter=this.lockCounterDefault,this.player1Name="User",this.player2Name="Computer",this.showResult=!1,this.happySmileyArray=["happy.svg","happy_smile.svg","happy_love.svg"],this.sadSmileyArray=["sad.svg","sad_cry.svg","sad_angry.svg"],this.player1Smiley=this.happySmileyArray[0],this.player2Smiley=this.happySmileyArray[0],this.assetPath="../../../../assets/",this.player1Message="Select the block to unlock "+this.lockCounterDefault+" Sec",this.player2Message="Select the block to unlock "+this.lockCounterDefault+" Sec",this.player1buildComplete=!1,this.player2buildComplete=!1}ngOnInit(){this.initPage(),this.initializeFB()}initPage(){this.player1Name=this.gameService.players.player1.name,this.player2Name=this.gameService.players.player2.name,this.generationLimitDefault=100*this.gameService.gameConfig.duration,this.generationLimit=this.generationLimitDefault,this.generationLimitUpgrade=this.generationLimitDefault,this.gameGrid=this.createEmptyGrid(this.rows,this.cols),setTimeout(()=>{this.initGame()},1e3),setTimeout(()=>{this.playAudio("audio0")},3e3)}initializeFB(){let r=Lt({databaseURL:"https://game-of-life-ce-default-rtdb.europe-west1.firebasedatabase.app"});this.fbDatabase=jn(r)}initGame(){if(1==this.gameService.gameConfig.mode){var i=[];1==this.gameService.gameConfig.difficulty&&(i=Ns),2==this.gameService.gameConfig.difficulty&&(i=Rs),3==this.gameService.gameConfig.difficulty&&(i=Ls),this.gameGrid=JSON.parse(JSON.stringify(i)),this.updateGrid(this.gameGrid),this.countLivingCells(this.gameGrid),this.player1Message="Build your empire",this.player2Message="Build your empire"}else this.player1Lock=!0,this.player2Lock=!0}unblockSection(i){1==i&&(this.player1Message="Build your empire !",this.buildGame1(1),this.player1Lock=!1,this.player2Lock=!0),2==i&&(this.player2Message="Build your empire !",this.buildGame1(2),this.player1Lock=!0,this.player2Lock=!1)}buildGame1(i){clearInterval(this.lockIntervalId),this.lockIntervalId=setInterval(()=>{this.lockCounter<=0?(this.lockCounter=this.lockCounterDefault,clearInterval(this.lockIntervalId),1==i?this.player1buildComplete=!0:2==i&&(this.player2buildComplete=!0),this.buildComplete()):this.lockCounter--},1e3)}buildComplete(){clearInterval(this.lockIntervalId),this.player1Lock=!0,this.player2Lock=!0}createEmptyGrid(i,r){let s=new Array(i);for(let a=0;a<i;a++)s[a]=new Array(r).fill(0);return s}counter(i){return new Array(i)}pauseAudio(){}selectActionTool(i){this.playAudio("audio5"),7==i?(this.buildMode=i,this.editBuild(i)):8==i?this.undoLastBuild():9==i&&this.resetBuild()}editBuild(i){this.selectBuildMode(i)}undoLastBuild(){var i=this.buildHistory[this.buildHistory.length-1];this.toggleCell(i[1],i[2],i[0],!0),this.buildHistory.pop()}resetBuild(){}selectBuildMode(i){this.buildMode!=i&&(this.buildMode=i,this.playAudio("audio5"))}toggleCell(i,r,s=this.buildMode,a=!1){if(1!=this.controlButton){var c=1;r>this.cols/2&&(c=-1),this.buildMaterial[s].forEach(d=>{var h=i+d[0],u=r+d[1]*c;this.gameGrid[h][u]=0===this.gameGrid[h][u]?1:0;var f=document.getElementById("game_"+h+"_"+u),p=Math.floor(40*Math.random()+16).toString(16),g=Math.floor(80*Math.random()+16).toString(16),E=Math.floor(100*Math.random()+16).toString(16);f.style.backgroundColor=u<this.cols/2?0===this.gameGrid[h][u]?"#1D2738":"#E7"+g+p:0===this.gameGrid[h][u]?"#1D2738":"#"+E+"B9"+g}),this.countLivingCells(this.gameGrid),0==a&&(this.playAudio("audio1"),this.buildHistory.push([s,i,r]))}}countLivingCells(i){let r=0,s=0;for(let a=0;a<this.rows;a++)for(let l=0;l<this.cols;l++)1===i[a][l]&&(l<this.cols/2?r++:s++);this.count1Display-r>20&&this.count2Display-s>20&&this.playAudio("audio3"),this.generationCount%10==0&&this.smileyUpdates(r,s),this.count1Display=r,this.count2Display=s}smileyUpdates(i,r){if("pi-pause"==this.menuButton[0]){var s=i-r;0==s?(this.player1Smiley=this.happySmileyArray[0],this.player2Smiley=this.happySmileyArray[0]):s>0?s>80?(this.player1Smiley=this.happySmileyArray[2],this.player2Smiley=this.sadSmileyArray[2],this.tempMessageUpdate("I love this game!","I want to win!")):s>40?(this.player1Smiley=this.happySmileyArray[1],this.player2Smiley=this.sadSmileyArray[1],this.tempMessageUpdate("Nice!","Don't laugh, I am gonna win this game!")):(this.player1Smiley=this.happySmileyArray[0],this.player2Smiley=this.sadSmileyArray[0],this.tempMessageUpdate("Hehe...","Don't laugh!")):s<0&&(s<-80?(this.player1Smiley=this.sadSmileyArray[2],this.player2Smiley=this.happySmileyArray[2],this.tempMessageUpdate("I want to win!","I love this game!")):s<-40?(this.player1Smiley=this.sadSmileyArray[1],this.player2Smiley=this.happySmileyArray[1],this.tempMessageUpdate("Ohh no I am loosing!","Nice!")):(this.player1Smiley=this.sadSmileyArray[0],this.player2Smiley=this.happySmileyArray[0],this.tempMessageUpdate("Don't laugh, I am gonna win this game!","Hehe...")))}}tempMessageUpdate(i,r){i&&(this.player1Message=i),r&&(this.player2Message=r)}updateGrid(i){for(let d=0;d<this.rows;d++)for(let h=0;h<this.cols;h++){let u=document.getElementById("game_"+d+"_"+h);var r=Math.floor(40*Math.random()+16).toString(16),s=Math.floor(80*Math.random()+16).toString(16),a=Math.floor(100*Math.random()+16).toString(16);u.style.backgroundColor=h<this.cols/2?0===i[d][h]?"#1D2738":"#E7"+s+r:0===i[d][h]?"#1D2738":"#"+a+"B9"+s}}calculateNextGeneration(i){const r=this.createEmptyGrid(this.rows,this.cols);for(let s=0;s<this.rows;s++)for(let a=0;a<this.cols;a++){const l=i[s][a],c=this.countNeighbors(i,s,a);0===l&&3===c?(r[s][a]=1,a<this.cols/2?this.born2++:this.born1++):1===l&&(c<2||c>3)?(r[s][a]=0,a<this.cols/2?this.death2++:this.death1++):r[s][a]=l}return r}countNeighbors(i,r,s){let a=0;const l=[[-1,-1],[-1,0],[-1,1],[0,-1],[0,1],[1,-1],[1,0],[1,1]];for(let c=0;c<l.length;c++){const[d,h]=l[c];a+=i[(r+d+this.rows)%this.rows][(s+h+this.cols)%this.cols]}return a}runNextGeneration(){this.generationCount>=this.generationLimit?(this.pauseGame(),this.gameEnd()):(this.generationCount++,this.updateProgressBar(this.generationCount),this.gameGrid=this.calculateNextGeneration(this.gameGrid),this.updateGrid(this.gameGrid),this.countLivingCells(this.gameGrid))}gameEnd(){this.showResult=!0,this.updateScore(this.player1Name,this.count1Display,this.count2Display),this.updateScore(this.player2Name,this.count2Display,this.count1Display)}updateProgressBar(i){var s=i/(1*this.generationLimit)*15;document.getElementById("progress-bar-fill").style.width=s+"rem"}playGame(){this.generationCount>=this.generationLimit&&(this.generationLimit+=this.generationLimitUpgrade),clearInterval(this.intervalId),this.intervalId=setInterval(()=>{this.runNextGeneration()},this.gameSpeed[this.menuButton[5]]),this.playAudio("audio2"),this.buildHistory=[]}pauseGame(){clearInterval(this.intervalId)}resetGame(){this.pauseGame(),this.generationCount=0,this.generationLimit=this.generationLimitDefault,this.game1Active=!0,this.game2Active=!0,this.gameGrid=this.createEmptyGrid(this.rows,this.cols),this.updateGrid(this.gameGrid),this.buildHistory=[],this.born1=this.born2=this.death1=this.death2=0,this.showResult=!1,this.count1Display=this.count2Display=0,this.player1buildComplete=this.player2buildComplete=!1,this.menuButton[0]="pi-play"}playAudio(i){const r=document.getElementById(i);r.volume=.2,r.play()}menuAction(i){if(1==i)"pi-play"==this.menuButton[0]?(this.menuButton[0]="pi-pause",this.playGame()):(this.menuButton[0]="pi-play",this.pauseGame());else if(2==i)this.resetGame();else if(3==i)this.menuButton[2]="pi-volume-up"==this.menuButton[2]?"pi-volume-off":"pi-volume-up";else if(4==i)this.gameEnd();else if(5==i)this.router.navigateByUrl("home");else{if(6!=i)return;"0.5x"==this.menuButton[5]?this.menuButton[5]="1x":"1x"==this.menuButton[5]?this.menuButton[5]="2x":"2x"==this.menuButton[5]?this.menuButton[5]="5x":"5x"==this.menuButton[5]&&(this.menuButton[5]="0.5x"),"pi-pause"==this.menuButton[0]&&(this.pauseGame(),this.playGame())}}updateScore(i,r,s){const a=gt(jn());var c=0,d=0,h=0;r==s&&(d=1),r>s&&(c=1),r<s&&(h=1),ms(me(a,"users/"+i)).then(u=>{if(u.exists()){var f=u.val(),p=f.gameStat;p[0]+=1,p[1]+=c,p[2]+=d,p[3]+=h,this.writeFB(i,r>f.score?r:f.score,p)}else console.log("No data available"),this.writeFB(i,r,[1,c,d,h])}).catch(u=>{console.error(u)})}writeFB(i,r,s){Kn(gt(this.fbDatabase,"users/"+i),{name:i,score:r,gameStat:s})}navToPage(){this.router.navigateByUrl("leader-board")}}return(n=t).\u0275fac=function(i){return new(i||n)(o.Y36(Ye.F0),o.Y36(Jn))},n.\u0275cmp=o.Xpm({type:n,selectors:[["app-game-board"]],decls:90,vars:37,consts:[["id","main-container",1,"m-auto","main-container","p-4"],[1,"d-flex","justify-content-between","align-items-center","pb-4"],[1,"title","text-uppercase"],[1,"title1"],[1,"title2"],[1,"d-flex","flex-column","align-items-center"],[1,"controls"],[1,"d-flex","justify-content-center"],["pTooltip","play/ Pause","tooltipPosition","bottom",1,"control-button",3,"click"],["pTooltip","Restart","tooltipPosition","bottom",1,"control-button","tooltipP",3,"click"],["pTooltip","Speed","tooltipPosition","bottom",1,"control-button","tooltipP",2,"font-weight","600",3,"click"],[1,"pi"],["pTooltip","Sound","tooltipPosition","bottom",1,"control-button","tooltipP",3,"click"],["pTooltip","Help","tooltipPosition","bottom",1,"control-button","tooltipP",3,"click"],["pTooltip","Quit","tooltipPosition","bottom",1,"control-button","tooltipP",3,"click"],[1,"game-container"],[1,"stat-container","pb-1"],[1,"d-flex","justify-content-between","pb-2"],[1,"d-flex","player-details","align-items-center",2,"width","680px"],[1,"player-message","d-flex","align-items-center","p-2","px-3"],[1,"d-flex"],[1,"playe1-avatar"],["alt","",3,"src"],[1,"px-3","ms-3","player-text-l"],[1,"px-3"],[1,"text-danger","score"],[1,""],[1,"text-center","pb-3",2,"width","270px"],[1,"progress-container","d-flex"],["id","progress-bar-fill",1,"progress-bar-fill"],[1,"m-auto",2,"font-size","0.8rem","z-index","1"],[1,"d-flex","player-details","align-items-center","justify-content-end",2,"width","680px"],[1,"px-3","text-end"],[1,"player-message","d-flex","justify-content-end","align-items-center","p-2","px-3"],[1,"px-3","me-3","player-text-r","text-end"],[1,"playe2-avatar"],[1,"m-auto"],[1,"tool-container-l","p-3"],["id","mdoe","tooltipPosition","right",3,"class","pTooltip","click",4,"ngFor","ngForOf"],[4,"ngFor","ngForOf"],["class","tool-l d-flex justify-content-center align-items-center",4,"ngIf"],["id","game",1,"game","d-flex","p-4"],["class","game-lock d-flex justify-content-center align-items-center",4,"ngIf"],[1,"p-1"],[1,"tool-container-r","p-3"],["id","mdoe","tooltipPosition","left",3,"class","pTooltip","click",4,"ngFor","ngForOf"],["class","tool-r d-flex justify-content-center align-items-center",4,"ngIf"],["class","result-container d-flex justify-content-center align-items-center",4,"ngIf"],["id","audio1","src","assets/mixkit-extra-bonus-in-a-video-game-2045.wav"],["id","audio2","src","assets/mixkit-drums-of-war-call-2780.wav"],["id","audio3","src","assets/mixkit-arcade-mechanical-bling-210.wav"],["id","audio4","src","assets/mixkit-winning-a-coin-video-game-2069.wav"],["id","audio5","src","assets/mixkit-game-ball-tap-2073.wav"],["id","audio0","src","assets/war theme.ogg"],["id","mdoe","tooltipPosition","right",3,"pTooltip","click"],[4,"ngIf"],[1,"tool-l","d-flex","justify-content-center","align-items-center"],[1,"cell-container"],["class","cell cell-l",3,"id","click",4,"ngFor","ngForOf"],[1,"cell","cell-l",3,"id","click"],[1,"game-lock","d-flex","justify-content-center","align-items-center"],["class","pi pi-lock position-absolute",3,"click",4,"ngIf"],[1,"pi","pi-lock","position-absolute",3,"click"],["class","cell cell-r",3,"id","click",4,"ngFor","ngForOf"],[1,"cell","cell-r",3,"id","click"],["id","mdoe","tooltipPosition","left",3,"pTooltip","click"],[1,"tool-r","d-flex","justify-content-center","align-items-center"],[1,"result-container","d-flex","justify-content-center","align-items-center"],[1,"result-card","p-5"],[1,"d-flex","flex-column","justify-content-center","align-items-center"],[1,"title","d-flex","flex-column","text-center","text-danger"],[1,"d-flex","result-details"],[1,"p-3","text-danger"],[1,"p-3"],[1,"m-5","result-card-seperator"],[1,"d-flex","pb-4"],[1,"result-card-button","p-4",3,"click"]],template:function(i,r){1&i&&(o.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"span",3),o._uU(4,"Cellular"),o.qZA(),o.TgZ(5,"span",4),o._uU(6,"Empire"),o.qZA()(),o.TgZ(7,"div",5)(8,"div",6)(9,"div",7)(10,"div",8),o.NdJ("click",function(){return r.menuAction(1)}),o._UZ(11,"i"),o.qZA(),o.TgZ(12,"div",9),o.NdJ("click",function(){return r.menuAction(2)}),o._UZ(13,"i"),o.qZA(),o.TgZ(14,"div",10),o.NdJ("click",function(){return r.menuAction(6)}),o.TgZ(15,"i",11),o._uU(16),o.qZA()(),o.TgZ(17,"div",12),o.NdJ("click",function(){return r.menuAction(3)}),o._UZ(18,"i"),o.qZA(),o.TgZ(19,"div",13),o.NdJ("click",function(){return r.menuAction(4)}),o._UZ(20,"i"),o.qZA(),o.TgZ(21,"div",14),o.NdJ("click",function(){return r.menuAction(5)}),o._UZ(22,"i"),o.qZA()()()()(),o.TgZ(23,"div",15)(24,"div",16)(25,"div",17)(26,"div",18)(27,"div",19)(28,"div",20)(29,"div",21),o._UZ(30,"img",22),o.qZA()(),o.TgZ(31,"div",23),o._uU(32),o.qZA()(),o.TgZ(33,"div",24)(34,"div"),o._uU(35),o.qZA(),o.TgZ(36,"div",25),o._uU(37),o.qZA()()(),o.TgZ(38,"div",26)(39,"div",5)(40,"div",27),o._uU(41),o.qZA(),o.TgZ(42,"div")(43,"div",28),o._UZ(44,"div",29),o.TgZ(45,"div",30),o._uU(46),o.qZA()()()()(),o.TgZ(47,"div",31)(48,"div",32)(49,"div"),o._uU(50),o.qZA(),o.TgZ(51,"div",25),o._uU(52),o.qZA()(),o.TgZ(53,"div",33)(54,"div",34),o._uU(55),o.qZA(),o.TgZ(56,"div",20)(57,"div",35),o._UZ(58,"img",22),o.qZA()()()()()(),o.TgZ(59,"div",36)(60,"div",20)(61,"div",37),o.YNc(62,Zd,2,7,"div",38),o._UZ(63,"hr"),o.YNc(64,Kd,3,2,"ng-container",39),o._UZ(65,"hr"),o.YNc(66,zd,2,1,"div",40),o.qZA(),o.TgZ(67,"div",41)(68,"div")(69,"div"),o.YNc(70,Yd,3,1,"div",39),o.qZA(),o.YNc(71,$d,2,1,"div",42),o.qZA(),o._UZ(72,"div",43),o.TgZ(73,"div")(74,"div"),o.YNc(75,Xd,3,1,"div",39),o.qZA(),o.YNc(76,tu,2,1,"div",42),o.qZA()(),o.TgZ(77,"div",44),o.YNc(78,nu,2,7,"div",45),o._UZ(79,"hr"),o.YNc(80,su,3,2,"ng-container",39),o._UZ(81,"hr"),o.YNc(82,ou,2,1,"div",46),o.qZA()()()()(),o.YNc(83,du,58,11,"div",47),o._UZ(84,"audio",48)(85,"audio",49)(86,"audio",50)(87,"audio",51)(88,"audio",52)(89,"audio",53)),2&i&&(o.xp6(11),o.Gre("pi ",r.menuButton[0],""),o.xp6(2),o.Gre("pi ",r.menuButton[1],""),o.xp6(3),o.hij(" ",r.menuButton[5]," "),o.xp6(2),o.Gre("pi ",r.menuButton[2],""),o.xp6(2),o.Gre("pi ",r.menuButton[3],""),o.xp6(2),o.Gre("pi ",r.menuButton[4],""),o.xp6(8),o.Q6J("src",r.assetPath+r.player1Smiley,o.LSH),o.xp6(2),o.hij(" ",r.player1Message," "),o.xp6(3),o.Oqu(r.player1Name),o.xp6(2),o.hij("00",r.count1Display,""),o.xp6(4),o.hij(" Generataion:",r.generationLimit," "),o.xp6(5),o.Oqu(r.generationCount),o.xp6(4),o.Oqu(r.player2Name),o.xp6(2),o.hij("00",r.count2Display,""),o.xp6(3),o.hij(" ",r.player2Message," "),o.xp6(3),o.Q6J("src",r.assetPath+r.player2Smiley,o.LSH),o.xp6(4),o.Q6J("ngForOf",r.buildMaterialName),o.xp6(2),o.Q6J("ngForOf",r.actionTool),o.xp6(2),o.Q6J("ngIf",r.player2Lock&&1!=r.controlButton),o.xp6(4),o.Q6J("ngForOf",r.counter(r.rows)),o.xp6(1),o.Q6J("ngIf",r.player1Lock&&"pi-play"==r.menuButton[0]),o.xp6(4),o.Q6J("ngForOf",r.counter(r.rows)),o.xp6(1),o.Q6J("ngIf",r.player2Lock&&"pi-play"==r.menuButton[0]),o.xp6(2),o.Q6J("ngForOf",r.buildMaterialName),o.xp6(2),o.Q6J("ngForOf",r.actionTool),o.xp6(2),o.Q6J("ngIf",r.player1Lock&&1!=r.controlButton),o.xp6(1),o.Q6J("ngIf",r.showResult))},dependencies:[j.sg,j.O5,Gd],styles:[".cell-container[_ngcontent-%COMP%]{display:flex}.cell[_ngcontent-%COMP%]{width:16px;height:16px;border-radius:5px;border:1px solid #121b29;animation-duration:1s;cursor:pointer;background-color:#1d2738}.cell-l[_ngcontent-%COMP%]:hover{background-color:#e73e3988}.cell-r[_ngcontent-%COMP%]:hover{background-color:#4cb93188}.main-container[_ngcontent-%COMP%]{width:1708px}.title[_ngcontent-%COMP%]{font-size:1.5rem}.title1[_ngcontent-%COMP%]{color:#e1113b}.title2[_ngcontent-%COMP%]{color:#fff}.menu-button[_ngcontent-%COMP%]   .p-button[_ngcontent-%COMP%]{background:#E1113B!important}.game-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:center}.game-lock[_ngcontent-%COMP%]{height:100%;width:100%;background:rgba(0,0,0,.3333333333);position:relative;z-index:1;top:-100%;border-radius:5px;color:#fff}.game-lock[_ngcontent-%COMP%]   .pi[_ngcontent-%COMP%]{font-size:3rem}.pi-lock[_ngcontent-%COMP%]:hover{scale:1.1}.control-button[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;margin:0 0 0 1.5rem;width:55px;height:55px;border-radius:50%;color:#f0f8ff;box-shadow:-3px -3px 4px #171e2c,3px 3px 5px 2px #000000d6,inset 0 0 #000,inset 0 0 #171e2c;transition:box-shadow .3s ease-in}.control-button[_ngcontent-%COMP%]:hover{box-shadow:0 0 #171e2c,0 0 #000000d6,inset 5px 5px 2px #000,inset -1px -1px 4px 1px #171e2c}.stat-container[_ngcontent-%COMP%]{color:#f5f5f5}.score[_ngcontent-%COMP%]{font-size:1.5rem}.playe1-avatar[_ngcontent-%COMP%]{height:40px;width:40px;background:#e73e39;border-radius:5px;margin:5px}.playe2-avatar[_ngcontent-%COMP%]{height:40px;width:40px;background:#4CB931;border-radius:5px;margin:5px}.player-message[_ngcontent-%COMP%]{width:500px;box-shadow:inset 3px 3px 4px #2223,inset -4px -3px 4px -5px #6666;border-radius:10px;background-color:#121b29;font-size:.8rem;color:#6c83a5}.player-text-l[_ngcontent-%COMP%]{border-left:1px solid}.player-text-r[_ngcontent-%COMP%]{border-right:1px solid}.player-card-l[_ngcontent-%COMP%]{border-right:1px solid white}.player-card-r[_ngcontent-%COMP%]{border-left:1px solid white}.progress-container[_ngcontent-%COMP%]{width:15rem;height:1.2rem;background-color:#1d2738;border-radius:.3rem;overflow:hidden}.progress-bar-fill[_ngcontent-%COMP%]{height:1.2rem;width:.5rem;background-color:#e1113b;border-radius:.3rem;position:absolute;z-index:0}.progress-bar-1x[_ngcontent-%COMP%]{width:4rem;z-index:1;text-align:end}.progress-bar-2x[_ngcontent-%COMP%]{width:8rem;z-index:1;text-align:end}.progress-label[_ngcontent-%COMP%]{height:1rem;width:1rem;padding:3px;border:1px solid white;border-radius:.3rem}.game[_ngcontent-%COMP%]{background-color:#121b29}.tool-container-l[_ngcontent-%COMP%]{display:flex;flex-direction:column;background-color:#1d2738;border-radius:10px 0 0 10px}.tool-container-r[_ngcontent-%COMP%]{display:flex;flex-direction:column;background-color:#1d2738;border-radius:0 10px 10px 0}.tool-l[_ngcontent-%COMP%], .tool-r[_ngcontent-%COMP%]{height:50px;width:50px;color:#f0f8ff;border-radius:10px}.tool-l-disable-true[_ngcontent-%COMP%], .tool-r-disable-true[_ngcontent-%COMP%]{color:#384a65!important}.tool-l-true[_ngcontent-%COMP%]{color:#e73e39;box-shadow:inset 3px 3px 6px #0000004f,inset -4px -3px 4px -5px #6666}.tool-r-true[_ngcontent-%COMP%]{color:#4cb931;box-shadow:inset 3px 3px 6px #0000004f,inset -4px -3px 4px -5px #6666}.tool-l[_ngcontent-%COMP%]:hover{color:#e73e39}.tool-r[_ngcontent-%COMP%]:hover{color:#4cb931}.hover-pointer[_ngcontent-%COMP%]{position:absolute;width:45px;height:45px;border-radius:5px;border:1px solid rgba(130,130,130,.4509803922);cursor:pointer;z-index:0}.result-container[_ngcontent-%COMP%]{width:100%;height:100%;position:absolute;z-index:10;top:0;background-color:#000a}.result-card[_ngcontent-%COMP%]{width:60%;height:60%;background-color:#121b29;border-radius:10px;color:#fff}.title[_ngcontent-%COMP%]{font-size:3rem}.result-details[_ngcontent-%COMP%]{color:#384a65}.result-card-button[_ngcontent-%COMP%]{cursor:pointer;transition:all .3s}.result-card-button[_ngcontent-%COMP%]:hover{scale:1.1}.result-card-seperator[_ngcontent-%COMP%]{border:2px solid #384A65;height:8rem}.rotate-45[_ngcontent-%COMP%]{transform:rotate(45deg)}.rotate-90[_ngcontent-%COMP%]{transform:rotate(90deg)}.rotate-135[_ngcontent-%COMP%]{transform:rotate(135deg)}.rotate-180[_ngcontent-%COMP%]{transform:rotate(180deg)}.rotate-225[_ngcontent-%COMP%]{transform:rotate(225deg)}.rotate-270[_ngcontent-%COMP%]{transform:rotate(270deg)}.rotate-315[_ngcontent-%COMP%]{transform:rotate(315deg)}"]}),t})();function fu(n,t){if(1&n&&(o.TgZ(0,"tr",11)(1,"td"),o._uU(2),o.qZA(),o.TgZ(3,"td"),o._uU(4),o.qZA(),o.TgZ(5,"td"),o._uU(6),o.qZA(),o.TgZ(7,"td"),o._uU(8),o.qZA(),o.TgZ(9,"td"),o._uU(10),o.qZA(),o.TgZ(11,"td"),o._uU(12),o.qZA(),o.TgZ(13,"td"),o._uU(14),o.qZA()()),2&n){const e=t.$implicit,i=t.index;o.xp6(2),o.Oqu(i+1),o.xp6(2),o.Oqu(e[0]),o.xp6(2),o.Oqu(e[1]),o.xp6(2),o.Oqu(e[2][0]),o.xp6(2),o.Oqu(e[2][1]),o.xp6(2),o.Oqu(e[2][2]),o.xp6(2),o.Oqu(e[2][3])}}const pu=[{path:"",component:Xn},{path:"home",component:Xn},{path:"landing",component:(()=>{var n;class t{}return(n=t).\u0275fac=function(i){return new(i||n)},n.\u0275cmp=o.Xpm({type:n,selectors:[["app-landing"]],decls:2,vars:0,template:function(i,r){1&i&&(o.TgZ(0,"p"),o._uU(1,"landing works!"),o.qZA())}}),t})()},{path:"game",component:uu},{path:"leader-board",component:(()=>{var n;class t{constructor(i){this.router=i,this.playersList={},this.scores=[]}ngOnInit(){this.initializeFB(),this.getScores()}initializeFB(){Lt({databaseURL:"https://game-of-life-ce-default-rtdb.europe-west1.firebasedatabase.app"})}getScores(){ms(me(gt(jn()),"users")).then(r=>{r.exists()?(this.playersList=r.val(),this.sortScores()):console.log("No data available")}).catch(r=>{console.error(r)})}sortScores(){var i=[];for(let r in this.playersList)i.push([this.playersList[r].name,this.playersList[r].score,this.playersList[r].gameStat]);i.sort(function(r,s){return s[1]-r[1]}),this.scores=i}navToPage(){this.router.navigateByUrl("home")}}return(n=t).\u0275fac=function(i){return new(i||n)(o.Y36(Ye.F0))},n.\u0275cmp=o.Xpm({type:n,selectors:[["app-leader-board"]],decls:31,vars:1,consts:[[1,"main-container"],[1,"title","text-uppercase","text-center","pt-5"],[1,"title1"],[1,"title2"],[1,"title","text-uppercase","text-center","pt-3","pb-4"],[1,"title3"],[1,"text-center","pt-3","pb-4"],[1,"back-button","text-light",3,"click"],[1,"list-container","d-flex","justify-content-center","px-5","pb-5","pt-2"],[1,"text-center"],["class","m-2 text-center",4,"ngFor","ngForOf"],[1,"m-2","text-center"]],template:function(i,r){1&i&&(o.TgZ(0,"div",0)(1,"div",1)(2,"span",2),o._uU(3,"Cellular"),o.qZA(),o.TgZ(4,"span",3),o._uU(5,"Empire"),o.qZA()(),o.TgZ(6,"div",4)(7,"span",5),o._uU(8,"Leader Board"),o.qZA()(),o.TgZ(9,"div",6)(10,"span",7),o.NdJ("click",function(){return r.navToPage()}),o._uU(11,"Back to Main Menu"),o.qZA()(),o.TgZ(12,"div",8)(13,"table")(14,"thead",9)(15,"th"),o._uU(16,"Rank"),o.qZA(),o.TgZ(17,"th"),o._uU(18,"Name"),o.qZA(),o.TgZ(19,"th"),o._uU(20,"High Score"),o.qZA(),o.TgZ(21,"th"),o._uU(22,"Games Played"),o.qZA(),o.TgZ(23,"th"),o._uU(24,"Win"),o.qZA(),o.TgZ(25,"th"),o._uU(26,"Draw"),o.qZA(),o.TgZ(27,"th"),o._uU(28,"Lose"),o.qZA()(),o.TgZ(29,"tbody"),o.YNc(30,fu,15,7,"tr",10),o.qZA()()()()),2&i&&(o.xp6(30),o.Q6J("ngForOf",r.scores))},dependencies:[j.sg],styles:[".main-containr[_ngcontent-%COMP%]{color:#fff!important}.title[_ngcontent-%COMP%]{font-size:2rem}.title3[_ngcontent-%COMP%]{color:#384a65}.list-container[_ngcontent-%COMP%]{width:100%}.list-item[_ngcontent-%COMP%]{height:3rem;width:80rem}th[_ngcontent-%COMP%], td[_ngcontent-%COMP%]{padding:1.5rem 4rem;color:#fff!important}tr[_ngcontent-%COMP%]{background:#1D2738;border:8px solid #081120;border-radius:10px!important}.back-button[_ngcontent-%COMP%]{cursor:pointer;scale:1.1;margin:20px;padding:10px 20px;transition:all .3s ease-in-out;border:1px solid white;border-radius:10px}.back-button[_ngcontent-%COMP%]:hover{scale:1.2}"]}),t})()}];let _u=(()=>{var n;class t{}return(n=t).\u0275fac=function(i){return new(i||n)},n.\u0275mod=o.oAB({type:n}),n.\u0275inj=o.cJS({imports:[Ye.Bz.forChild(pu),Ye.Bz]}),t})(),gu=(()=>{var n;class t{}return n=t,m(t,"\u0275fac",function(i){return new(i||n)}),m(t,"\u0275mod",o.oAB({type:n})),m(t,"\u0275inj",o.cJS({imports:[j.ez]})),t})(),yu=(()=>{var n;class t{}return(n=t).\u0275fac=function(i){return new(i||n)},n.\u0275mod=o.oAB({type:n}),n.\u0275inj=o.cJS({imports:[j.ez,_u,Is,Wd,gu]}),t})()}}]);